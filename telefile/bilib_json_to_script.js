/**
 * Created by qw4wer on 2016/1/29.
 */
{
    "version"
:
    3, "sources"
:
    ["/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/gulp-browserify/node_modules/browserify/node_modules/browser-pack/_prelude.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/app-config/app-config.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/app-config/avalon-filters.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/components/live-feedback/live-feedback.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/components/live-top-navigator/intro-scripts.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/components/live-top-navigator/javascripts/top-navigator.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/components/live-top-navigator/javascripts/top-user-panel.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/components/live-widget/live-popup/live-popup.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/components/live-widget/live-toast/live-toast.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-avalon-lazy-init/lazy-init.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-explorer-detective/explorer-detective.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-friendly-format/friendly-format.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-get-abs-position/get-abs-position.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-jquery-cookie/jquery-cookie.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-live-quick-login/live-quick-login.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-number-tofixed/number-tofixed.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-random-emoji/random-emoji.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-setnum-avalon/avalon-set-num.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-setnum/set-num.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-timestamp-shorter/timestamp-shorter.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/functions/func-type-adjust/type-adjust.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/live-service/live-service-ctrl.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/live-service/live-service-get-bp.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/common/live-service/live-service-update-currency.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-functions/functions/live-on-rtmp.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-functions/intro-scripts.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-room-edit-panel/javascripts/admin-manage.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-room-edit-panel/javascripts/black-manage.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-room-edit-panel/javascripts/live-info-manage.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-room-edit-panel/javascripts/live-manage.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-room-edit-panel/javascripts/room-admin.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-room-edit-panel/javascripts/room-info-edit.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/admin-room-edit-panel/room-edit-panel.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/bk-changer/bk-changer.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/chat-ctrl-panel/chat-ctrl-panel.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/chat-ctrl-panel/profile-ctrl/intro-javascripts.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/chat-ctrl-panel/profile-ctrl/javascripts/fans-medal.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/chat-ctrl-panel/profile-ctrl/javascripts/profile-ctrl.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/chat-ctrl-panel/profile-ctrl/javascripts/title.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/chat-msg-list/chat-list-ctnr.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/rank-list/javascripts/rank-list.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/components/super-gift/super-gift.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/chat-area/intro-javascripts.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/gift-section/intro-javascripts.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/gift-section/javascripts/gift-package-ctrl.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/gift-section/javascripts/gift-section-ctrl.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/header-section/header-section.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/live-room-sidebar-left/intro.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/live-room-sidebar-left/javascripts/sidebar-ctrl.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/my-attention/intro.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/my-attention/javascripts/my-attention.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/quiz-system/intro-scripts.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/quiz-system/javascripts/quiz-avalon-ctrl.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/quiz-system/javascripts/quiz-ctrl-methods.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/quiz-system/javascripts/quiz-ctrl-quiz-setup.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/quiz-system/javascripts/quiz-ctrl-status-ctrl.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/quiz-system/javascripts/quiz-ctrl-user-events.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/quiz-system/javascripts/quiz-protocol.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/recommend-videos/recommend-videos.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/seed-exchange/charge.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/seed-exchange/exchange.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/seed-exchange/seed-exchange.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/sign-up/intro.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/sign-up/javascripts/sign-up.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/treasure-box/treasure-box.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/wish/intro.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/components/wish/javascripts/wish.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/fake_56922f5f.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/live-room-flash-func.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/live-room-funcs.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/live-room-init.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/live-room-protocol.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/room-init-funcs/func-room-data-deferred.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/room-init-funcs/func-set-data-activity.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/room-init-funcs/func-set-data.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/room-init-funcs/func-set-global-variables.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/live-room/room-javascripts/room-init-funcs/func-user-online-heart.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/jquery.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/adaptor/jquery.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/lib/class.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/lib/dom.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/lib/event-manager.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/lib/guid.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/lib/helper.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/main.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/default-setting.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/destroy.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/handler/click-rail.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/handler/drag-scrollbar.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/handler/keyboard.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/handler/mouse-wheel.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/handler/native-scroll.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/handler/selection.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/handler/touch.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/initialize.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/instances.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/update-geometry.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/update-scroll.js", "/Users/Felix/Bilibili/Repo/live-app-web/frontend/node_modules/perfect-scrollbar/src/js/plugin/update.js"], "names"
:
    [], "mappings"
:
    "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxiBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1TA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACliBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChgBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9ZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9qBA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA", "file"
:
    "generated.js", "sourceRoot"
:
    "", "sourcesContent"
:
    ["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})", "/*\n *  Live App Configuration By LancerComet at 11:23, 2015/11/25.\n *  # Carry Your World #\n *  ---\n *  程序信息设置.\n *\n */\n\nvar explorerDetective = require(\"../functions/func-explorer-detective/explorer-detective\");\n\nmodule.exports = {};\n\nmodule.exports.appInfo = {\n    name: \"Bilibili Live\",\n    version: \"V3.3.8-Worker\",\n    codeName: \"450\",\n    author: [\"Felix\", \"LancerComet\"]\n};\n\nmodule.exports.appConfig = {\n    xhrTimeout: 1000 * 30\n};\n\nmodule.exports.consoleText = {\n    info: module.exports.appInfo.name + \" Info: \",\n    success: module.exports.appInfo.name + \" Success: \",\n    caution: module.exports.appInfo.name + \" Caution: \",\n    error: module.exports.appInfo.name + \" Error: \"\n};\n\n\n// Avalon Config. | Avalon 配置函数.\nmodule.exports.avalonConfig = function () {\n    avalon.config({\n        interpolate:[\"[[\",\"]]\"],\n        debug: false,\n        loader: false\n    });\n};\n\n\n// Global Config. | 全局配置.\nmodule.exports.globalConfig = function (window) {\n    // 设置 console 函数.\n    // console.log 将在构建阶段被清除, 所以使用 consoleText 进行输出.\n    window.consoleText = window.console;\n\n    // 修复 IE8 下的 trim 原型方法.\n    if (explorerDetective() === \"IE 8\") {\n        String.prototype.trim = function() {\n            return this.replace(/(^\\s*)|(\\s*$)/g,'');\n        }\n    }\n};", "/*\n *  Avalon Filters By LancerComet at 14:09, 2015/12/29.\n *  # Carry Your World #\n *  ---\n *  Avalon 自定义过滤器.\n */\n\nvar friendlyFormat = require('../functions/func-friendly-format/friendly-format');\n\nmodule.exports = function () {\n\n    // Friendly Format By LancerComet at 16:29, 2015.12.28.\n    // # Carry Your World #\n    (function friendlyFormatFilter () {\n        avalon.filters.tenThousand = function (source, args1, args2) {\n            return friendlyFormat.tenThousand(source);\n        };\n\n        avalon.filters.hunderdThousand = function (source, args1, args2) {\n            return friendlyFormat.hunderdThousand(source);\n        };\n\n        avalon.filters.length = function (source) {\n            return source.length;\n        }\n    })();\n\n};\n", "/*\n *  Created by LancerComet at 16:04, 2015/12/07.\n *  Original By Onion.\n */\nvar liveQuickLogin = require(\"../../functions/func-live-quick-login/live-quick-login\");\nvar liveToast = require('../live-widget/live-toast/live-toast');\n\nmodule.exports = function feedbackModule () {\n    var $submitBtn = $(\".feedback-submit-btn\");\n    // Action: 文档加载完毕后设置提交按钮点击监听事件\n    $(function () {\n        //关闭问题反馈页面\n        $('.feedback-close-btn').on('click',function(){\n            $('.feedback').fadeOut();\n        });\n        //点击补充问题文本域当前文本隐藏\n        $(\"#remark\").on(\"click\", function(){\n            $(this).val(\"\").css('color','#fefefe');\n        });\n        //反馈问题提交\n        $submitBtn.on(\"click\", feedbackSubmit);\n    });\n\n    /* Definition go below. */\n\n    function feedbackSubmit () {\n        var configuration =  {\n            type: $('#type input:radio:checked').val(),\n            num: $('#num input:radio:checked').val(),\n            city:  $('#city').val(),\n            operator:$('#operator').val(),\n            ip:  $('#ip').val(),\n            remark: $('#remark').val()\n        };\n        if(configuration.type  == \"\" || configuration.num == \"\" || configuration.city == \"\" || configuration.operator == \"\") {\n            liveToast($submitBtn[0], \"请完成必填项~~\");\n        } else {\n            $.ajax({\n                url: \"/feedback/submit\",\n                type: \"POST\",\n                data: configuration,\n                success: successCallback,\n                dataType: \"JSON\",\n                error: errorCallback\n            });\n        }\n\n        function successCallback (result) {\n            if (result.code != 0) {\n                liveToast($submitBtn[0], result.msg);\n                return;\n            }\n            liveToast($submitBtn[0], \"感谢您的反馈，我们会努力哒(∩_∩)\", \"success\");\n            $(function() {\n                $(\"#city,#operator,#ip,#remark\").attr(\"value\",\"\");\n                $(\".feedback\").fadeOut();\n            });\n        }\n\n        function errorCallback (result) {\n            liveToast($submitBtn[0], \"提交没有成功，要不然再重试一下？真的很对不起 > <\");\n        }\n\n    }\n\n    // window Function Attachment.\n    window.feedBackShow = function () {\n        liveQuickLogin();\n        $(\".feedback\").fadeIn();\n    };\n};", "/*\n *  Bilibili Live Top Navigator Intro File By LancerComet at 14:40, 2015.11.23.\n *  # Carry Your World #\n *  ---\n *\n *  描述：\n *  ---\n *  本文件为直播页面顶栏的 JS 入口文件.\n *  本文件不编写任何逻辑, 仅做引用.\n *\n *  使用：\n *  ---\n *  require(\"module-a\")();\n *  require(\"module-b\")();\n *  ...\n *\n */\n\nmodule.exports = topNavSetup;\n\nfunction topNavSetup () {\n    require(\"./javascripts/top-user-panel\")();  // 顶栏 JavaScript 逻辑文件.\n    require(\"./javascripts/top-navigator\")();  // 左侧导航 JavaScript 逻辑文件.\n}", "/*\n *  Bilibili Live Top Navigator Script By LancerComet at 22:03, 2015.11.30.\n *  # Carry Your World #\n *  ---\n *\n *  描述：\n *  ---\n *  顶栏左侧区域导航逻辑文件.\n *\n *  Log:\n *  ---\n *  V0.1.0 - 22:03, 2015.11.30.\n *   - 初版.\n *\n */\nvar explorerDetective = require(\"../../../functions/func-explorer-detective/explorer-detective\");\n\nmodule.exports = function () {\n\n    var $navLink = $(\".nav-link-item.area-navigator\");\n    var $navPanel = $navLink.find(\".live-top-nav-panel\");\n\n    var mouseOutTimeout = null;\n    var allowCtrl = true;\n\n    $navLink.mouseenter(mouseEnter).mouseleave(mouseLeave);\n\n    function mouseEnter () {\n        allowCtrl = false;\n        clearTimeout(mouseOutTimeout);\n        $navPanel.show().addClass(\"panel-in\");\n        var explorer = explorerDetective();\n\n        // 无 CSS3 的浏览器禁止动画.\n        if (explorer === \"IE 7\" || explorer === \"IE 8\" || explorer === \"IE 9\") {\n            $(\".live-top-nav-panel .nav-item\").addClass(\"move-in\");\n            allowCtrl = true;\n        } else {\n            (function itemAnimation () {\n                var $navItems = $(\".live-top-nav-panel .nav-item\");\n                var timeout = 100;\n                $navItems.each(function (index) {\n                    var $this = $(this);\n                    setTimeout(function () {\n                        $this.removeClass(\"move-in\").addClass(\"move-in\");\n                        allowCtrl = index === $navItems.length;\n                        //index === $navItems.length ? allowCtrl = true : void(0);\n                    }, timeout);\n                    timeout += 60;\n                });\n            })();\n        }\n    }\n\n    function mouseLeave () {\n        allowCtrl = false;\n        mouseOutTimeout = setTimeout(function () {\n            $navPanel.stop().fadeOut(300, function () {\n                $(\".live-top-nav-panel .nav-item\").removeClass(\"move-in\");\n                $navPanel.removeClass(\"panel-in\");\n                allowCtrl = true;\n            });\n        }, 250);\n    }\n\n\n\n\n\n    //var liveTopNavLeftCtrl = avalon.define({\n    //    $id: \"liveTopNavLeftCtrl\",\n    //    allowCtrl: true,  // 用户鼠标操作控制标识.\n    //    timeoutTiming: 200,\n    //    navPanelCtrl: {\n    //        enter: navPanelMouseEnter,  // 鼠标进入事件.\n    //        leave: navPanelMouseLeave  // 鼠标移出事件.\n    //    },\n    //    navPanelShow: false,  // 分区导航面板显示控制标识, 默认隐藏分区导航面板.\n    //    navPanelOut: false,  // 分区导航面板动画控制标识.\n    //    navPanelOutTimeout: null,  // 面板隐藏计时器.\n    //    navPanelFinishTimeout: null  // 面板完成隐藏回调计时器.\n    //});\n    //\n    //function navPanelMouseEnter () {\n    //    if (!liveTopNavLeftCtrl.allowCtrl) {\n    //        return;\n    //    }\n    //    clearTimeout(liveTopNavLeftCtrl.navPanelOutTimeout);\n    //    clearTimeout(liveTopNavLeftCtrl.navPanelFinishTimeout);\n    //    liveTopNavLeftCtrl.allowCtrl = false;\n    //    liveTopNavLeftCtrl.navPanelOut = false;\n    //    liveTopNavLeftCtrl.navPanelShow = true;\n    //    (function itemAnimation () {\n    //        var $navItems = $(\".live-top-nav-panel .nav-item\");\n    //        var timeout = 0;\n    //        $navItems.each(function () {\n    //            var $this = $(this);\n    //            $this.removeClass(\"move-in\");\n    //            setTimeout(function () {\n    //                $this.addClass(\"move-in\");\n    //            }, timeout);\n    //            timeout += 100;\n    //        });\n    //    })();\n    //    liveTopNavLeftCtrl.navPanelOutTimeout = setTimeout(function () {\n    //        liveTopNavLeftCtrl.allowCtrl = true;\n    //    }, liveTopNavLeftCtrl.timeoutTiming);\n    //}\n    //\n    //function navPanelMouseLeave () {\n    //    clearTimeout(liveTopNavLeftCtrl.navPanelOutTimeout);\n    //    clearTimeout(liveTopNavLeftCtrl.navPanelFinishTimeout);\n    //    liveTopNavLeftCtrl.navPanelOutTimeout = setTimeout(function () {\n    //        liveTopNavLeftCtrl.allowCtrl = false;\n    //        liveTopNavLeftCtrl.navPanelOut = true;  // 执行动画.\n    //        liveTopNavLeftCtrl.navPanelFinishTimeout = setTimeout(function () {\n    //            liveTopNavLeftCtrl.navPanelOut = false;\n    //            liveTopNavLeftCtrl.navPanelShow = false;\n    //            liveTopNavLeftCtrl.allowCtrl = true;\n    //        }, liveTopNavLeftCtrl.timeoutTiming);\n    //    }, 200);\n    //}\n\n\n};", "/*\n *  Bilibili Live Top User Panel Script By LancerComet at 14:42, 2015.11.23.\n *  # Carry Your World #\n *  ---\n *\n *  描述：\n *  ---\n *  本文件为直播页面顶栏右侧用户面板的 JS 逻辑文件.\n *\n *  Log:\n *  ---\n *  V0.1.2 - 22:02, 2015.11.30.\n *   + 使用 Avalon 重写.\n *   + 完善动画逻辑.\n *   + 增加数据请求事件.\n *\n *  V0.1.1 - 10:20, 2015.11.26.\n *   - 移植至新版首页的 browserify 模块中.\n *\n *  V0.1.0 - 17:52, 2015.09.18.\n *   - 初版.\n *\n */\n\nvar appConfig = require(\"../../../app-config/app-config\");\nvar quickLogin = require(\"../../../functions/func-live-quick-login/live-quick-login\");\nrequire(\"../../../functions/func-jquery-cookie/jquery-cookie\")();  // jQuery Cookie 插件, 直接执行.\n\nmodule.exports = liveTopNav;\n\n\n/*\n *  Definition: 用户信息面板事件.\n *  用户在鼠标移动到头像上之后进行数据请求, 并只请求一次.\n *  ---\n *\n *  Log:\n *  ---\n *  V0.3.1 - 10:18, 2015.12.01.\n *   + 使用 jQuery 替代 Avalon 的 ms-mouseenter 和 ms-mouseleave.\n *\n *  V0.3.0 - 21:51, 2015.11.29.\n *   - 使用 Avalon 重写.\n *\n *  V0.1.1 - 10:20, 2015.11.26.\n *   - 移植至新版首页的 browserify 模块中.\n *\n *  V0.1.0 - 17:52, 2015.09.18.\n *   - 初版.\n *\n */\n\nfunction liveTopNav () {\n    \"use strict\";\n\n    // Definition: 本模块设置.\n    var moduleSettings = {\n        animationTiming: 499,  // 用户面板 CSS3 动画时间 - 1 ms.\n        xhrTimeout: 1000 * 30,  // XHR 请求超时设定.\n        msgCheckInterval: 1000 * 60 * 5  // 消息读取间隔, 因为没了私信所以及时性就大大降低了, 暂时设置为 5 分钟.\n    };\n\n    // Definition: 顶栏右侧用户面板设置.\n    var userPanelSettings = {\n        allowCtrl: true,\n        visibility: false,  // 面板默认隐藏.\n        dataRequestURL: \"/User/getUserInfo\",  // 用户信息查询地址.\n        mouseEnter: panelMouseEnter,\n        mouseLeave: panelMouseLeave,\n        mouseLeaveTimeout: null,  // 面板移出计时器.\n        panelOut: false,  // 面板移出动画 ms-class 控制标识.\n        unreadMsg: false,  // 未读消息控制标识.\n        unreadMsgCount: 0,  // 未读消息计数.\n        showProgress: true,  // 进度条显示控制标识, 默认显示.\n        msgClick: msgClick,  // 消息按钮点击事件, 在点击之后对 window 进行 onFocus 监视.\n        vipIconClick: vipIconClick  // 老爷图标点击事件, 在点击之后对 window 进行 onFocus 监视.\n    };\n\n    // 方法定义部分.\n    // 方法定义至此处以增强代码可读性.\n    function panelMouseEnter () {\n        if (!userPanelSettings.allowCtrl) { return; }\n        liveTopNavCtrl.$fire(\"topNavUserPanelDataRequest\", {\n            callback: function () {\n                liveTopNavCtrl.$fire(\"topNavUserPanelIn\", true);\n            }\n        });\n    }\n\n    function panelMouseLeave () {\n        liveTopNavCtrl.$fire(\"topNavUserPanelOut\", true);\n    }\n\n    function msgClick () {\n        $(window).on(\"focus\", function () {\n            liveTopNavCtrl.$fire(\"topNavMessageRefresh\");\n            $(window).off(\"focus\");\n        });\n    }\n\n    function vipIconClick () {\n        $(window).on(\"focus\", function () {\n            liveTopNavCtrl.$fire(\"topNavUserPanelDataRequest\");\n            $(window).off(\"focus\");\n        });\n    }\n\n    // Definition: 顶栏控制器定义.\n    var liveTopNavCtrl = avalon.define({\n        $id: \"liveTopNavCtrl\",\n        userPanel: userPanelSettings,  // 用户面板设置对象.\n        panelData: {  // 用户面板数据对象.\n            username: \"神秘用户 (=・ω・=)\",\n            avatar: \"\",\n            isVip: 0,\n            vipIconLink: \"/i\",\n            userLevel: {\n                current: \"UL.--\",\n                next: \"UL.--\",\n                progress: \"0%\",\n                progressData: 0\n            },\n            ranking: \"--\",\n            restExperience: \"--\",\n            seeds: {\n                gold: \"--\",\n                silver: \"--\"\n            }\n        },\n        clearAvatar: function () {  // 头像 Cookie 清理方法, 在用户退出时清理 Cookie.\n            $.removeCookie(\"user_face\", { path: \"/\", domain: \".bilibili.com\" });\n        },\n        topNavOpacity: {\n            enable: function () {\n                liveTopNavCtrl.$fire(\"topNavOpacity\", true);\n            },\n            disable: function () {\n                liveTopNavCtrl.$fire(\"topNavOpacity\", false);\n            },\n            status: true  // 禁用顶部透明度控制标识.\n        },\n        levelPanel: {\n            onhover: false,\n            allowCtrl: true,\n            mouseLeaveTimeout: null,\n            restoreTimeout: null,\n            mouseEnter: function () {\n                if (!liveTopNavCtrl.levelPanel.allowCtrl) { return; }\n                liveTopNavCtrl.levelPanel.allowCtrl = false;\n                clearTimeout(liveTopNavCtrl.levelPanel.mouseLeaveTimeout);\n                clearTimeout(liveTopNavCtrl.levelPanel.restoreTimeout);\n                liveTopNavCtrl.levelPanel.onhover = true;\n                liveTopNavCtrl.levelPanel.restoreTimeout = setTimeout(function () {\n                    liveTopNavCtrl.levelPanel.allowCtrl = true;\n                }, 500);\n            },\n            mouseLeave: function () {\n                if (!liveTopNavCtrl.levelPanel.allowCtrl) { return; }\n                clearTimeout(liveTopNavCtrl.levelPanel.mouseLeaveTimeout);\n                clearTimeout(liveTopNavCtrl.levelPanel.restoreTimeout);\n                liveTopNavCtrl.levelPanel.mouseLeaveTimeout = setTimeout(function () {\n                    liveTopNavCtrl.levelPanel.allowCtrl = false;\n                    liveTopNavCtrl.levelPanel.onhover = false;\n                    liveTopNavCtrl.levelPanel.restoreTimeout = setTimeout(function () {\n                        liveTopNavCtrl.levelPanel.allowCtrl = true;\n                    }, 500);\n                }, 300);\n            }\n        },\n        liveLogin: function () {\n            quickLogin();\n        },\n        iframeObj: {\n            $blackLayer: $('<div class=\"black-layer\" style=\"z-index: 99\"></div>'),\n            $newlive: $('<div class=\"new-live-layer\" style=\"z-index: 100\"><iframe name=\"contentFrame\" id=\"g_iframe\" width=\"100%\" height=\"100%\" scrolling=\"no\" frameborder=\"0\" allowtransparency=\"true\" style=\"background-color:transparent;position: absolute;top:0;border:solid 1px #aaaaaa;border-radius: 10px\" src=\"/room/apply\"></iframe></div>'),\n            iframeExist: false\n        },\n        enterMyRoom: function () {\n            quickLogin();\n            $.ajax({\n                url: \"/liveact/myroom\",\n                type: \"POST\",\n                dataType: \"JSON\",\n                success: function (result) {\n                    if (result.code == 0) {\n                        if (result.data) {\n                            location.href = \"/\" + result.data;\n                            return;\n                        }\n                        if (!liveTopNavCtrl.iframeObj.iframeExist) {\n                            $(\"body\").append(liveTopNavCtrl.iframeObj.$blackLayer);\n                            $(\"body\").append(liveTopNavCtrl.iframeObj.$newlive);\n                            liveTopNavCtrl.iframeObj.iframeExist = true;\n                        } else {\n                            return false;\n                        }\n                    }\n                },\n                error: function (result) {\n                    console.log(appConfig.consoleText.error + \"与服务器通信产生错误.\")\n                }\n            })\n        },\n        loadFinished: false,\n        logined: false  // 用户登陆状态控制标识.\n    });\n\n    // 判断用户是否登陆, 登陆显示面板, 未登陆显示未登录节点.\n    $.cookie(\"DedeUserID\") ? liveTopNavCtrl.logined = true : void(0);\n\n    avalon.ready(function () {\n        liveTopNavCtrl.loadFinished = true;\n    });\n\n    // Definition: 未开通直播间 iframe.\n    // 需要挂载全局变量 offLayer.\n    // iframe 内置的关闭方法.\n    window.offLayer = function () {\n        liveTopNavCtrl.iframeObj.$blackLayer.remove();\n        liveTopNavCtrl.iframeObj.$newlive.remove();\n        liveTopNavCtrl.iframeObj.iframeExist = false;\n    };\n    $(document).on('click', '.new-live-layer .off-button', window.offLayer);\n\n    // Definition: 用户面板显示服务.\n    // 请手动传入 true 表示验证, 否则不予执行.\n    liveTopNavCtrl.$watch(\"topNavUserPanelIn\", function (value) {\n        if (arguments.length < 1 || value !== true) {\n            avalon.error(appConfig.consoleText.error + '在触发 \"topNavUserPanel\" 时请手动传入 true 表示验证, 否则不予执行.');\n        }\n        userPanelSettings.allowCtrl = false;\n        liveTopNavCtrl.levelPanel.allowCtrl = true;\n        liveTopNavCtrl.levelPanel.onhover = false;\n        clearTimeout(userPanelSettings.mouseLeaveTimeout);\n\n        // Action: 子节点进入动画.\n        (function itemIntroAnimation () {\n            var timeout = 100;\n            var $sectionBlocks = $(\"#top-nav-user-panel\").find(\".section-block\");\n            $sectionBlocks.each(function (index) {\n                var $this = $(this);\n                setTimeout(function () {\n                    $this.addClass(\"active\");\n                }, timeout);\n                timeout += 80;\n            });\n        })();\n\n        liveTopNavCtrl.userPanel.visibility = true;  // 显示面板.\n        liveTopNavCtrl.topNavOpacity.disable();  // 禁用透明度.\n    });\n\n    // Definition: 用户面板隐藏服务.\n    // 请手动传入 true 表示验证, 否则不予执行.\n    liveTopNavCtrl.$watch(\"topNavUserPanelOut\", function (value) {\n        if (arguments.length < 1 || value !== true) {\n            avalon.error(appConfig.consoleText.error + '在触发 \"topNavUserPanelOut\" 时请手动传入 true 表示验证, 否则不予执行.');\n        }\n        if (userPanelSettings.allowCtrl) { return; }\n        liveTopNavCtrl.levelPanel.allowCtrl = true;\n        liveTopNavCtrl.levelPanel.onhover = false;\n        var $topNavUserPanel = $(\"#top-nav-user-panel\");\n        $topNavUserPanel.addClass(\"panel-out\");  // 移除动画使用 jQuery 代替 Avalon 的坑爹 ms-class, ms-class 在配合 ms-visible 与 ms-mouseleave 时效果不佳.\n        $topNavUserPanel.find(\".section-block\").removeClass(\"active\");\n        setTimeout(function () {\n            liveTopNavCtrl.userPanel.visibility = false;  // 隐藏面板.\n            $(\"#top-nav-user-panel\").removeClass(\"panel-out\");\n            userPanelSettings.allowCtrl = true;\n            liveTopNavCtrl.topNavOpacity.enable();  // 启用透明度.\n        }, 300);\n    });\n\n    // Definition: 数据请求服务.\n    // 面板默认仅请求一次数据, 当用户请求过一次之后不再进行请求.\n    // 当传入的值 \"configuration.mode\" 为 \"force\" 时, 无视以上规则, 暴力刷新数据.\n    // 如果传入 \"configuration.callback\", 则数据完成时执行该回调.\n    var requestAvailable = true;  // 据请求控制标识, 当 false 时, 用户鼠标移至头像处也不再请求数据（默认）, 直到下次刷新页面.\n    liveTopNavCtrl.$watch(\"topNavUserPanelDataRequest\", function (configuration) {\n        /*\n         *  @ configuration: {\n         *    mode: null || \"force\",\n         *    callback: Function\n         *  }\n         */\n\n        // Definition: Cookie 信息.\n        var uidInCookie = $.cookie(\"DedeUserID\");  // DedeUserID.\n\n        // 未登陆 ? GTFO!\n        if (!uidInCookie) {\n            return;\n        }\n\n        // Action: 设置强制刷新标识.\n        configuration ? configuration.mode === \"force\" ? requestAvailable = true : void(0) : void(0);\n\n        // Action: 默认设置下第一次之后不再请求.\n        if (!requestAvailable) {\n            configuration ? configuration.callback ? configuration.callback() : void(0) : void(0);\n            return;\n        }\n\n        // 获取数据.\n        (function dataRequest () {\n            $.ajax({\n                url: userPanelSettings.dataRequestURL,\n                type: \"GET\",\n                dataType: \"JSON\",\n                timeout: moduleSettings.xhrTimeout,  // 30s 超时时间.\n                data: {\n                    timestamp: Date.now()\n                },\n                success: function (result) {\n                    /*\n                     *  @ result: {\n                     *      code: String,\n                     *      msg: String,\n                     *      data: {\n                     *          uname: String,\n                     *          face: URL[String],\n                     *          gold: Number,\n                     *          silver: Number,\n                     *          user_intimacy: Number,\n                     *          user_level: Number,\n                     *          user_level_rank: Number,\n                     *          user_next_intimacy: Number,\n                     *          user_next_level: Number,\n                     *          vip: [1: true, 0: false]\n                     *      }\n                     *  }\n                     *\n                     */\n                    if (result.code != \"REPONSE_OK\") {\n                        console.log(appConfig.consoleText.error + \"顶栏用户信息面板数据获取失败:\");\n                        console.log(appConfig.consoleText.error + result.msg);\n                        console.log(appConfig.consoleText.error + \"因此顶栏数据获取失败.\");\n                    } else {\n                        dataBinding(result.data);  // 数据填充.\n                        liveTopNavCtrl.userPanel.showProgress = false;  // 移除进度条.\n                        configuration.callback ? configuration.callback() : void(0);  // 执行回调.\n                        requestAvailable = false;  // 请求完成, 默认不再请求数据.\n                        return true;  // 执行结束.\n                    }\n                },\n                error: function (result) {\n                    console.log(appConfig.consoleText.error + \"顶栏用户信息面板数据获取失败: 无有效通信建立.\");\n                    liveTopNavCtrl.userPanel.showProgress = false;  // 移除进度条.\n                    configuration.callback ? configuration.callback() : void(0);  // 执行回调.\n                }\n            });\n        })();\n\n        // Definition: 用户面板数据绑定函数.\n        function dataBinding (userData) {\n            if (!userData || Object.prototype.toString.call(userData) !== \"[object Object]\") {\n                avalon.error(appConfig.consoleText.error + '在调用顶栏的 \"dataBinding\" 时必须提供有效的数据对象.');\n            }\n            userData.user_intimacy  ? userData.user_intimacy = parseInt(userData.user_intimacy, 10) : console.log(appConfig.consoleText.caution + userPanelSettings.dataRequestURL + ' 的 \"user_intimacy\" 属性丢失.');\n            userData.user_next_intimacy ? userData.user_next_intimacy = parseInt(userData.user_next_intimacy, 10) : console.log(appConfig.consoleText.caution + userPanelSettings.dataRequestURL + '\"user_next_intimacy\" 属性丢失.');\n\n            if (isNaN(userData.user_intimacy) || isNaN(userData.user_next_intimacy)) {\n                console.log(appConfig.consoleText.error + '顶部面板回传用户经验信息为非数字类型, 需要为数字类型.');\n            } else {\n                liveTopNavCtrl.panelData.restExperience = userData.user_next_intimacy - userData.user_intimacy; // 用户升级还需经验.\n                liveTopNavCtrl.panelData.userLevel.progressData = userData.user_intimacy / userData.user_next_intimacy * 100;  // 用户等级进度百分比真实数据.\n                liveTopNavCtrl.panelData.userLevel.progress = userData.user_intimacy / userData.user_next_intimacy * 100 + \"%\";  // 用户等级进度百分比字符串.\n            }\n\n            liveTopNavCtrl.panelData.username = userData.uname;  // 用户名.\n            liveTopNavCtrl.panelData.avatar = \"url(\" + userData.face + \")\";  // 头像.\n            liveTopNavCtrl.panelData.seeds.gold = userData.gold;  // 银瓜子.\n            liveTopNavCtrl.panelData.seeds.silver = userData.silver;  // 金瓜子.\n            liveTopNavCtrl.panelData.userLevel.current = \"UL.\" + userData.user_level;  // 当前用户等级.\n            liveTopNavCtrl.panelData.userLevel.next = \"UL.\" + userData.user_next_level;  // 用户下一个等级.\n            liveTopNavCtrl.panelData.ranking = userData.user_level_rank;  // 用户排名.\n            liveTopNavCtrl.panelData.isVip = parseInt(userData.vip, 10);  // 用户是否为 VIP.\n            parseInt(userData.vip, 10) > 0 ? liveTopNavCtrl.panelData.vipIconLink = \"/i\" : liveTopNavCtrl.panelData.vipIconLink = \"/i#to-vip\";\n        }\n\n    });\n\n    // Definition: 头像图片请求服务.\n    // Cookie 会保存头像数据, 若有该 Cookie, 则使用本地地址, 不再进行请求.\n    (function avatarFuncRegister () {\n        $(avatarHandler);  // 在 DomReady 后执行.\n        liveTopNavCtrl.$watch(\"topNavUserPanelAvatar\", function (value) {\n            avatarHandler();\n        });  // 同时注册到 Avalon 中.\n\n        /* Definition Goes Below. */\n\n        function avatarHandler () {\n\n            // Definition: Cookie 信息.\n            var uidInCookie = $.cookie(\"DedeUserID\");  // DedeUserID.\n\n            // 未登陆 ? GTFO!\n            if (!uidInCookie) {\n                return;\n            }\n\n            var avatarInCookie = $.cookie(\"user_face\");  // 在操作前获取最新的 Cookie 中头像地址.\n\n            if (!avatarInCookie) {\n                $.ajax({\n                    url: userPanelSettings.dataRequestURL,\n                    timeout: moduleSettings.xhrTimeout,  // 30s 超时时间.\n                    data: {\n                        timestamp: Date.now()\n                    },\n                    dataType: \"JSON\",\n                    success: function (result) {\n                        if (result.code != \"REPONSE_OK\") {\n                            console.log(appConfig.consoleText.error + \"顶栏用户头像数据获取失败:\");\n                            console.log(appConfig.consoleText.error + result.msg);\n                            console.log(appConfig.consoleText.error + \"因此用户头像地址获取失败.\");\n                            return;\n                        }\n                        liveTopNavCtrl.panelData.avatar = \"url(\" + result.data.face + \")\";\n                    },\n                    error: function (result) {\n                        console.log(appConfig.consoleText.error + \"顶栏用户信息面板数据获取失败: 无有效通信建立.\");\n                    }\n                });\n            } else {\n                liveTopNavCtrl.panelData.avatar = \"url(\" + avatarInCookie + \")\";  // 使用本地地址.\n            }\n        }\n\n    })();\n\n    // Definition: 消息模块服务.\n    // 将发送 JSON with Padding 信息到 message.bilibili.com 请求数据, 每五分钟请求一次.\n    (function messageFuncRegister () {\n\n        // Definition: 消息模块方法定义.\n        var messageHandler = {\n\n            // Definition: 轮训计时器对象.\n            checkInterval: null,\n\n            // Definition: 请求方法.\n            xhr: function (mode) {\n                mode = mode || \"normal\";\n\n                // GTFO when not logged in.\n                if (!$.cookie(\"DedeUserID\")) {\n                    return;\n                }\n\n                // 向 message.bilibili.com 请求消息.\n                $.ajax({\n                    url: \"http://message.bilibili.com/api/notify/query.notify.count.do\",\n                    type: \"GET\",\n                    data: {\n                        type: \"jsonp\",\n                        captcha: window.captcha_key,\n                        callback: \"callback\",\n                        ts: Date.now()\n                    },\n                    dataType: \"JSONP\",\n                    jsonp: \"callback\",\n                    timeout: moduleSettings.xhrTimeout,  // 超时设定.\n                    success: function (result) {\n                        // Error Handler.\n                        if (result.code != 0) {\n                            console.log(appConfig.consoleText.error + \"消息信息获取失败，等待 30 秒后重试... (/= _ =)/~┴┴\");\n                            return;\n                        }\n\n                        var replyMe = parseInt(result.data.reply_me, 10),\n                            chatMe = parseInt(result.data.chat_me, 10),\n                            praiseMe = parseInt(result.data.praise_me, 10),\n                            notifyMe = parseInt(result.data.notify_me, 10),\n                            atMe = parseInt(result.data.at_me, 10);\n\n                        // Action: 判断是否有新消息.\n                        if(replyMe > 0 || praiseMe > 0 || notifyMe > 0 || atMe > 0 || chatMe > 0){\n                            var msgCount = replyMe + praiseMe + notifyMe + atMe + chatMe;\n                            messageHandler.weHaveUnreadMsg(msgCount);\n                        }else{\n                            messageHandler.clearUnread();\n                        }\n\n                    },\n                    error: function (result) {\n                        console.log(appConfig.consoleText.error + \"消息信息获取失败，等待 30 秒后重试... (/= _ =)/~┴┴\")\n                    }\n                });\n\n            },\n\n            // Definition: 轮训初始化方法.\n            check: function () {\n                messageHandler.checkInterval = setInterval(messageHandler.xhr, moduleSettings.msgCheckInterval)\n            },\n\n            // Definition: 新消息来啦！\n            weHaveUnreadMsg: function (msgCount) {\n                msgCount = parseInt(msgCount, 10);\n                msgCount > 99 ? msgCount = \"99+\" : void(0);\n                liveTopNavCtrl.userPanel.unreadMsg = true;\n                liveTopNavCtrl.userPanel.unreadMsgCount = msgCount;\n            },\n\n            // Definition: 我已经读了所有未读消息！\n            clearUnread: function () {\n                liveTopNavCtrl.userPanel.unreadMsg = false;\n                liveTopNavCtrl.userPanel.unreadMsgCount = 0;\n            }\n        };\n\n        // Definition: 消息系统初始化方法.\n        function messageInit () {\n            messageHandler.xhr();\n            messageHandler.check();\n            //liveTopNavCtrl.userPanel.msgXHR = messageHandler.xhr;\n        }\n\n        $(window).on(\"load\", messageInit);  // Window.onload 之后执行.\n\n        // 同时注入到 Avalon 中. 内部方法, 不会暴露.\n        liveTopNavCtrl.$watch(\"topNavMessageRefresh\", function (mode) {\n            if (mode === \"dev\") {\n                messageHandler.xhr(\"dev\");\n                console.log(\"哟~~小伙子手动触发了消息查询内部方法啊，有没有性♂趣来 B 站当前端啊？\");\n                console.log(\"扔个简历到 zhaopin@bilibili.com 吧！\");\n            } else {\n                messageHandler.xhr();\n            }\n        });\n\n    })();\n\n\n    // Definition: 顶部条透明度切换服务.\n    // true: 启用透明度, false: 禁用透明度.\n    liveTopNavCtrl.$watch(\"topNavOpacity\", function (value) {\n        if (value !== true && value !== false) {\n            avalon.error(appConfig.consoleText.error + '在 $fire 服务 \"topNavOpacity\" 时必须传入 true（启用透明度） 或 false（禁用透明度）.')\n        }\n        value ? liveTopNavCtrl.topNavOpacity.status = true : liveTopNavCtrl.topNavOpacity.status = false;\n    });\n\n    // Definition: 瓜子数量更新事件.\n    liveTopNavCtrl.$watch(\"fillCurrency\", function (value) {\n        if (value.gold !== null && value.gold !== undefined) { liveTopNavCtrl.panelData.seeds.gold = value.gold; }\n        if (value.silver !== null && value.silver !== undefined) { liveTopNavCtrl.panelData.seeds.silver = value.silver; }\n    });\n\n\n\n}", "/*\n *  Live Popup By LancerComet at 18:45, 2015/12/15.\n *  # Carry Your World #\n *  ---\n *  直播站通用弹窗组件.\n *  弹窗组件拥有两种模式, 一种是单按钮, 一种是双按钮.\n *\n *  使用方法:\n *  ---\n *  var livePopup = require(\"live-popup\");\n *\n *  var newLivePopup = livePopup(param) || new livePopup(param);  // 创建弹窗, 并返回这个弹窗的原生节点对象.\n *                                                                // Param 的参数结构见下方.\n *  newLivePopup.open();  // 开启弹窗.\n *  newLivePopup.close();  // 关闭弹窗.\n *  newLivePopup.confirm();  // 点击弹窗确认按钮.\n *  newLivePopup.remove();  // 销毁弹窗.\n *\n *  示例:\n *  ---\n *  var newPopup = LivePopup({\n *      title: \"购买成功\",\n *      content: \"按确定或回车关闭窗口~\",\n *      type: \"alert\",\n *      initFunc: function () {\n *          console.log(\"面板创建成功.\");\n *      },\n *      onConfirm: function () {\n *          var self = this;\n *          $.ajax({\n *              url: \"...\",\n *              type: \"...\",\n *              data: \"...\",\n *              success: function () {\n *                  // ...\n *                  self.done();  // onConfirm 执行完毕.\n *              }\n *          })\n *      }\n *  });\n *\n *  var newPopup2 = new LivePopup({\n *      title: \"出错了~\",\n *      html: '<p>要不要重试一次?</p>',\n *      button: {\n *          confirm: \"再试一次！\",\n *          cancel: \"不试惹~\"\n *      },\n *      type: \"action\",\n *      initFunc: function () {\n *          // ...\n *      },\n *      onConfirm: function () {\n *          $.ajax(...);\n *      }\n *  });\n *\n *\n */\n\nvar appConfig = require('../../../app-config/app-config');\nvar randomEmoji = require(\"../../../functions/func-random-emoji/random-emoji\");\n//var explorerDetective = require(\"../../../functions/func-explorer-detective\");\n\n// Definition: 弹窗创建构造函数.\nvar LivePopup = function (param) {\n    /*\n     *  @ param: {\n     *      title: String,  // 面板标题.\n     *      content: \"String\" || null,  // 面板内容.\n     *      html: String || null,  // 面板自定义节点. 当此属性传入时, 弹窗为自定义结构, 则 content 属性无效.\n     *      type: \"action\"（默认） || \"alert\" || \"info\",  // 弹窗类型, Action 为两个按钮, Alert 和 Info 仅有一个按钮, Alert 为红色警示样式.\n     *      button: {\n     *          confirm: String,  // 确认按钮文字. 当不传入的时候默认为 \"确认\".\n     *          cancel: String  // 取消按钮文字. 当不传入的时候默认为 \"取消\".\n     *      } || false,  // 当 button 为 false 时不创建 button.\n     *      width: String || null,  // 窗口宽度.\n     *      silent: true,  // 当设定为 true 时创建弹窗不显示.\n     *      initFunc: Function || null  // 创建弹窗完成时执行的方法.\n     *      onConfirm: Function || null  // 当点击确认时执行的方法, 可不传入.\n     *                                   // 外部在定义此方法时, 执行完毕后可指定执行 newPopup.done(), 这是一个伪 Promise, 然后会关闭面板.\n     *      onCancel: Function || null  // 点击取消时执行的回调.\n     *                                  // 请注意不要在此函数中调用原型方法 close, 否则会造成死循环!\n     *    }\n     */\n\n    // 强制返回一个 LivePopup 的 \"实例\".\n    if (!(this instanceof LivePopup)) {\n        return new LivePopup(param);\n    }\n\n    var self = this;\n\n    if (!param) {\n        throw new Error(appConfig.consoleText.error + '在使用 Live Popup 时必须指定参数.');\n    }\n\n    // Definition: 创建文档碎片.\n    var fragment = document.createDocumentFragment();\n\n    // Definition: 创建弹窗容器节点.\n    var newPopup = document.createElement(\"div\");\n    newPopup.className = \"live-popup-panel\";  // Add Class.\n\n    // Definition: 创建 Body Merge.\n    var bodyMerge = document.createElement(\"div\");\n    bodyMerge.className = \"body-merge\";\n    newPopup.appendChild(bodyMerge);\n\n    // Definition: 创建 Panel Content Container.\n    var panelContent = document.createElement(\"div\");\n    panelContent.className = \"panel-content\";\n    newPopup.appendChild(panelContent);\n\n    // Definition: 处理标题节点.\n    // 需要一步 Param Handler.\n    (function popupTitleHandler () {\n        param.title = param.title.toString() ? param.title.toString() : randomEmoji.helpless() ;  // 设置弹窗默认标题.\n\n        // 设置标题节点.\n        var titleCtnr = document.createElement(\"div\");\n        titleCtnr.className = \"popup-title-container\";\n        titleCtnr.innerHTML = '<h2 class=\"popup-title\">' + param.title + '</h2>';\n\n        panelContent.appendChild(titleCtnr);\n    })();\n\n    // Definition: 处理内容节点.\n    (function popupContentHandler () {\n        var contentCtnr = document.createElement(\"div\");\n        contentCtnr.className = \"popup-content-container\";\n\n        // 如果是自定义节点.\n        if (param.html) {\n            contentCtnr.innerHTML = param.html;\n        } else {\n            param.content = param.content || \"某个程序员没有给这个弹窗写内容~ \" + randomEmoji.helpless();\n            contentCtnr.innerHTML = '<p>' + param.content + '</p>';\n        }\n\n        panelContent.appendChild(contentCtnr);\n    })();\n\n    // Definition: 按钮节点处理.\n    (function popupButtonsHandler () {\n        if (param.button !== false) {\n            // Type Handler.\n            param.type = (param.type || \"action\").toLowerCase();\n            if (param.type !== \"alert\" && param.type !== \"action\" && param.type !== \"info\") {\n                throw new Error(appConfig.consoleText.error + \"Live Popup 的类型仅为 Action 与 Alert 与 Info.\");\n            }\n\n            var btnsCtnr = document.createElement(\"div\");\n            btnsCtnr.className = \"popup-button-container\";\n\n            param.button = param.button ? param.button : { confirm: \"确认\", cancel: \"取消\" };\n\n            // 创建确认按钮. 当点击确认按钮时, 会执行 param.onConfirm.\n            var confirmBtn = document.createElement(\"button\");\n            confirmBtn.className = \"popup-button confirm\";\n            confirmBtn.innerHTML = param.button.confirm || \"确认\";\n            confirmBtn.setAttribute(\"aria-label\", \"点击确认\");\n\n            // 挂载 onConfirm 方法: 如果传入合法的 onConfirm, 则挂载.\n            if (param.onConfirm && $.isFunction(param.onConfirm)) {\n                self.onConfirm = param.onConfirm;\n            } else {\n                // 否则 onConfirm 方法仅仅是关闭面板.\n                self.onConfirm = self.close;\n            }\n\n            // 挂载 onCancel 方法: 如果传入合法的 onCancel, 则挂载.\n            if (param.onCancel && $.isFunction(param.onCancel)) {\n                self.onCancel = param.onCancel;\n            }\n\n            $(confirmBtn).on(\"click\", function () {\n                self.confirm();\n            });\n            btnsCtnr.appendChild(confirmBtn);\n            self.confirmBtn = confirmBtn;\n\n            // 如果是 Action 类型面板, 再加入一个 Cancel 按钮.\n            if (param.type === \"action\") {\n                var cancelBtn = document.createElement(\"button\");\n                cancelBtn.innerHTML = param.button.cancel || \"取消\";\n                cancelBtn.className = \"popup-button cancel close-btn\";\n                cancelBtn.setAttribute(\"aria-label\", \"点击取消\");\n                $(cancelBtn).on(\"click\", function () {\n                    self.close();\n                });\n                btnsCtnr.appendChild(cancelBtn);\n                self.cancelBtn = cancelBtn;\n            }\n\n            // 如果是 Alert 则添加 \".alert\".\n            if (param.type === \"alert\") {\n                newPopup.className = \"live-popup-panel alert\";\n            }\n\n            panelContent.appendChild(btnsCtnr);\n\n        }\n\n        // Action: 创建右上角关闭按钮.\n        var closeBtn = document.createElement(\"div\");\n        closeBtn.className = \"close-btn right-top\";\n        closeBtn.setAttribute(\"role\", \"button\");\n        closeBtn.setAttribute(\"aria-label\", \"点击关闭面板.\");\n        closeBtn.setAttribute(\"title\", \"关闭面板 \" + randomEmoji.helpless());\n        $(closeBtn).on(\"click\", function () {\n            self.close();\n        });  // Let jQuery Handle the Event Binding.\n        panelContent.appendChild(closeBtn);\n    })();\n\n    // Action: 窗口宽度处理.\n    param.width && $(panelContent).css({\"width\": param.width});\n\n    fragment.appendChild(newPopup);\n    document.body.appendChild(fragment);\n\n    //$(\".body-container\").addClass(\"blur\");\n\n    // 执行一次 Open 方法以绑定 KeyEvent.\n    this.open();\n\n    //\n    param.silent && $(newPopup).hide();\n\n    // 将面板导出为枚举属性 popup.\n    this.popup = newPopup;\n\n    // Action: 执行传入的 initFunc. initFunc 是面板初始化完成时执行的回调.\n    (function execInitFunc () {\n        if (param.initFunc && !$.isFunction(param.initFunc)) {\n            throw new Error(appConfig.consoleText.error + \"在使用 Live Popup 时, 传入的 initFunc 必须为 Function.\");\n        }\n        param.initFunc && param.initFunc();\n    })();\n};\n\n// Definition: 弹窗显示方法.\nLivePopup.prototype.open = function () {\n    var self = this;\n\n    // Action: 绑定按键事件.\n    $(window).on(\"keyup\", function keyEvent (event) {\n        self.keyupEvent = keyEvent;\n        event.keyCode === 27 && self.allowEnterKey && self.close();\n        event.keyCode === 13 && self.allowEnterKey && self.confirm();\n    });\n\n    // Action: 显示面板.\n    $(this.popup).show().removeClass(\"hide\").attr(\"aria-hidden\", false);\n    setTimeout(function () {\n        self.allowEnterKey = true;\n    }, 300);\n};\n\n// Definition: 弹窗关闭方法.\nLivePopup.prototype.close = function (callback) {\n    var self = this;\n\n    // Exec onCancel when exist.\n    if ($.isFunction(this.onCancel)) {\n        console.log(\"Popup onCancel exec.\");\n        setTimeout(self.onCancel, 0);\n    }\n\n    // 隐藏面板.\n    popupHide(self, callback);\n\n    // Action: 绑定按键事件.\n    $(window).off(\"keyup\", this.keyupEvent);\n    this.allowEnterKey = false;\n    $(\".body-container\").removeClass(\"blur\");\n};\n\n// Definition: 弹窗确认方法.\nLivePopup.prototype.confirm = function () {\n    if (this.onConfirm && $.isFunction(this.onConfirm)) {\n        this.onConfirm();\n    }\n};\n\n// Definition: 弹窗销毁方法.\n// 弹窗对象需要手动在其位置调用 \"弹窗变量 = null\" 来手动释放内存.\nLivePopup.prototype.remove = function () {\n    var popup = this.popup;\n    popupHide(this, function () {\n        $(popup).remove();\n        popup = null;\n    });\n};\n\n// Definition: 弹窗 onConfirm 函数执行完毕的伪 Promise.\n// 在外部定义 param.onConfirm 方法后, 当执行完毕后, 请手动调用 newPopup.done().\nLivePopup.prototype.done = function () {\n    this.close();\n};\n\n// Definition: Popup 关闭通用函数.\n// 将在 close 与 remove 中调用.\nfunction popupHide (self, callback) {\n    var popup = self.popup;\n    $(popup).addClass(\"hide\").attr(\"aria-hidden\", true);\n    setTimeout(function () {\n        $(popup).hide();\n        callback && callback();\n    }, 380);\n}\n\n\nmodule.exports = LivePopup;", "/*\n *  Live Toast JavaScripts By LancerComet at 17:35, 2015.12.16.\n *  # Carry Your World #\n *  ---\n *  直播站 Toast 组件 JavaScript 文件.\n */\n\nvar appConfig = require('../../../app-config/app-config');\nvar typeAdjust = require(\"../../../functions/func-type-adjust/type-adjust\");\nvar randomEmoji = require(\"../../../functions/func-random-emoji/random-emoji\");\n\nvar LiveToast = function (element, content, type, fixed) {\n\n    /*\n     *  @ element: Object || jQuery Object, 定位节点原生对象或 jQuery 对象.\n     *  @ content: String, 提示内容.\n     *  @ type: String, success || caution || error || info.\n     *  @ fixed: Boolean, 提示位置的独享是否为 fixed 定位.\n     */\n\n    // 如果默认情况下传入 fixed, 进行参数交换.\n    if (typeof type === \"boolean\") {\n        fixed = type;\n        type = null;\n    }\n\n    // Action: 创建 Toast 节点.\n    var fragment = document.createDocumentFragment();\n    var newToast = document.createElement(\"div\");\n\n    // Action: 设置 Toast 类型.\n    type = type || \"info\";\n    if (type !== \"success\" && type !== \"caution\" && type !== \"error\" && type !== \"info\") {\n        throw new Error(appConfig.consoleText.error + \"在使用 Live Toast 时必须指定正确的类型: success || caution || error || info\");\n    }\n    newToast.innerHTML = \"<i class='toast-icon \" + type + \"'></i><span class='toast-text'>\" + content + \"</span>\" || \"<i class='toast-icon info'></i><span class='toast-text'>某个程序员没有写入内容~ </span>\" + randomEmoji();\n    newToast.className = \"live-toast \" + type;\n\n    // Action: 判断传入的 element 的类型, 然后统一转为 jQuery 对象.\n    var targetElement = null;\n    switch (typeAdjust(element)) {\n        case \"HTML Element\":\n            targetElement = element;\n            break;\n        case \"jQuery Object\":\n            targetElement = element[0];\n            break;\n        default:\n            throw new Error(appConfig.consoleText.error + \"在使用 Live Toast 时请传入正确的原生 Dom 对象或节点的 jQuery 对象.\");\n    }\n\n    // 设置 Toast 位置.\n    var size = {\n        width: $(targetElement).width(),\n        height: $(targetElement).height()\n    };\n\n    var targetElementLeft = getLeft(targetElement);\n    var targetElementTop = getTop(targetElement);\n\n    // 如果 Toast 超过屏幕宽度.\n    if (targetElementLeft > $(window).width() - 300) {\n        $(newToast).css({\"left\": targetElementLeft - size.width});\n    } else {\n        $(newToast).css({\"left\": targetElementLeft + size.width});\n    }\n\n    // 如果是 fixed 定位.\n    var scrollTop = 0;\n    if (fixed) { scrollTop = document.body.scrollTop; }\n    $(newToast).css({\"top\": targetElementTop + size.height + scrollTop});\n\n    // Toast 销毁计时器.\n    setTimeout(function () {\n        $(newToast).addClass(\"out\");\n        setTimeout(function () {\n            $(newToast).remove();\n            // Manual GC.\n            fragment = newToast = targetElement = size = targetElementLeft = targetElementTop = scrollTop  = null;\n        }, 400);\n    }, 2000);\n\n    // Appending.\n    // 如果没有 liveToast 容器, 进行添加.\n    //if (!$(\"#live-toast-ctnr\")[0]) {\n    //    var liveToastCtnr = document.createElement(\"div\");\n    //    liveToastCtnr.id = \"live-toast-ctnr\";\n    //    liveToastCtnr.className = \"w-100 p-absolute p-zero\";\n    //    $(liveToastCtnr).css({\"height\": $(\"body\").height()});\n    //    document.body.appendChild(liveToastCtnr);\n    //}\n\n    fragment.appendChild(newToast);\n    document.body.appendChild(fragment);\n\n};\n\n// Definition: 获取元素在页面中的 X 轴绝对定位.\nfunction getLeft (element) {\n    var offset = element.offsetLeft;\n    element.offsetParent !== null ? offset += getLeft(element.offsetParent) : void(0);\n    return offset;\n}\n\n// Definition: 获取元素的在页面中的 Y 轴绝对定位.\nfunction getTop (element) {\n    var offset = element.offsetTop;\n    element.offsetParent !== null ? offset += getTop(element.offsetParent) : void(0);\n    return offset;\n}\n\nmodule.exports = LiveToast;", "/*\n *  Live Room Avalon Controllers Lazy Init By LancerComet at 11:47, 2015/12/21.\n *  # Carry Your World #\n *  ---\n *  房间页控制器 Lazy-Init 模块.\n */\n\nvar lazyInitTime = 1;\n//var lazyInitArray = [];\nmodule.exports = function (node, vmodel, callback) {\n\n    setTimeout(function () {\n        if (node === null && vmodel === null) {\n            avalon.scan();\n        } else {\n            avalon.scan(node, vmodel);\n        }\n        callback && callback();\n    }, lazyInitTime);\n\n    lazyInitTime += 100;\n\n    //for (var i = 0, length = lazyInitArray.length; i < length; i++) {\n    //    lazyInitArray[i]();\n    //    lazyInitArray[i](i, 1);\n    //}\n\n};\n", "/*\n *   Explorer Detective By LancerComet at 11:30, 2015/11/25.\n *   # Carry Your World #\n *   ---\n *\n *   信息:\n *   ---\n *   浏览器检测模块.\n *\n *   用法:\n *   ---\n *   var browserIs = require(\"func-explorer-detective\")();  // browserIs 的值即为当前浏览器.\n *\n *   License：\n *   ---\n *   © 2015 LancerComet @ MIT License.\n *\n */\n\nmodule.exports = explorerDetective;\n\nfunction explorerDetective () {\n    var userAgent = window.navigator.userAgent;\n    var browser = {\n        myBrowser : \"unknown\",\n        database: [\n            { type: \"IE Legacy\", regExp: \"MSIE [1-6].*\"},  // IE 1-6\n            { type: \"IE 7\", regExp: \"MSIE [7].*\"},  // IE 7\n            { type: \"IE 8\", regExp: \"MSIE [8].*\"},  // IE 8, 不支持 CSS3 与 HTML5.\n            { type: \"IE 9\", regExp: \"MSIE [9].*\"},  // IE 9, 支持部分 CSS3 与 HTML5.\n            { type: \"IE Modern\", regExp: \"Trident/[6-9].*\" },  // gt IE 10, 支持 CSS3 与 HTML5.\n            //{ type: \"IE No CSS3\", regExp: \"MSIE [1-9].*\" },  // lt IE 10, 不支持 CSS3.\n            { type: \"Firefox\", regExp: \"Firefox/[0-9].*\" },\n            { type: \"Safari\", regExp: \"AppleWebKit/[0-9].*.Safari/[0-9]\" },\n            { type: \"Chrome\", regExp: \"AppleWebKit/[0-9].*.Chrome/[0-9].*.Safari/[0-9]\" },\n            { type: \"Opera Presto\", regExp: \"Opera.[0-9].*.Presto/[0-9]\" },\n            { type: \"Opera Modern\", regExp: \"OPR/[0-9][0-9]\" },\n            { type: \"Edge\", regExp: \"Edge/[0-9].*\" },\n            { type: \"Maxthon 4\", regExp: \"Maxthon/[4]\" }\n        ]\n    };\n\n    (function matchExplorer () {\n        for (var i = 0, length = browser.database.length; i < length; i++) {\n            var newRegExp = new RegExp(browser.database[i].regExp);\n            if(userAgent.match(newRegExp)){\n                browser.myBrowser = browser.database[i].type;\n            }\n        }\n    })();\n\n    return browser.myBrowser;\n}\n", "/*\n *  Friendly Format By LancerComet at 16:00, 2015.11.20.\n *  # Carry Your Wolrd #\n *  ---\n *\n *  Description:\n *  ---\n *  数字单位格式化函数.\n *  包含两个函数, 一个从 10000 开始格式化, 一个从 100000 开始格式化.\n *\n */\n\nmodule.exports = {\n    tenThousand: tenThousandFriendlyFormat,\n    hunderdThousand: oneHundredThousandFormat\n};\n\n// Definition: 一万数据格式化.\nfunction tenThousandFriendlyFormat (num) {\n    if (parseInt(num, 10) < 10000) {\n        return num;\n    }\n    return friendlyFormat(num);\n}\n\n// Definition: 十万数据格式化.\nfunction oneHundredThousandFormat (num) {\n    if (parseInt(num, 10) < 100000) {\n        return num;\n    }\n    return friendlyFormat(num);\n}\n\n// Definition: 数据格式化方法.\nfunction friendlyFormat (num) {\n\n    // 如果传入 0  或非法数据则直接返回.\n    if (!num) { return num; }\n\n    // 如果不是有效数字, 直接返回.\n    if (isNaN(parseInt(num, 10))) {\n        console.log(\"Bilibili Live Caution: 传入的数值非有效数字, 无法进行格式化.\");\n        return num;\n    }\n\n    // 格式化为字符串.\n    num = num.toString();\n\n    // 如果传入的是 \"XX万\" 的形式.\n    if (num.indexOf(\"\\u4e07\") > -1) {\n        var pureNum = parseFloat(num.substr(0, num.indexOf(\"\\u4e07\")));\n        if (pureNum < 10) return num;\n        var returnNum = pureNum.toFixed(1);\n        return returnNum + \"\\u4e07\";\n    }\n\n    if ( !(0 <= num.indexOf(\"\\u4e07\") || 0 <= num.indexOf(\",\") ) ) {\n        return (num = parseInt(num)) ? 10000<= num && (num = (num / 10000).toFixed(1) + \"\\u4e07\") : num = \"--\", num\n    }\n\n    /*\n     *  \"110000\" => \"10.1万\"\n     *  110000 => \"10.1万\"\n     *  \"10.1万\" => \"10.1万\"\n     *  \"10万\" => \"10.0万\"\n     */\n}", "/*\n *  Get Absolute Position of Targeted Dom By LancerComet at 17:13, 2015/12/24.\n *  # Carry Your World #\n *  ---\n *  获得指定节点的绝对定位坐标值.\n *\n */\n\nvar typeAdjust = require('../func-type-adjust/type-adjust');\n\nmodule.exports = function (element) {\n    element = typeAdjust(element) === \"jQuery Object\" ? element[0] : element;\n    return {\n        left: getLeft(element),\n        top: getTop(element)\n    }\n};\n\n// Definition: 获取元素在页面中的 X 轴绝对定位.\nfunction getLeft (element) {\n    var offset = element.offsetLeft;\n    element.offsetParent !== null ? offset += getLeft(element.offsetParent) : void(0);\n    return offset;\n}\n\n// Definition: 获取元素的在页面中的 Y 轴绝对定位.\nfunction getTop (element) {\n    var offset = element.offsetTop;\n    element.offsetParent !== null ? offset += getTop(element.offsetParent) : void(0);\n    return offset;\n}", "/*!\n *  Cookie window.jQuery Plugin Packaged By LancerComet at 10:25, 2015.11.26.\n *  jQuery Cookie 获取插件.\n *\n *  用法:\n *  ---\n *  require(\"func-jquery-cookie\")();\n *\n *  注意:\n *  ---\n *  此模块在页面中仅需要运行一次.\n *\n *  ---------\n *\n *  window.jQuery Cookie Plugin v1.4.1\n *  https://github.com/carhartl/window.jQuery-cookie\n *\n *  Copyright 2013 Klaus Hartl\n *  Released under the MIT license\n *\n */\n\nvar appConfig = require('../../app-config/app-config');\nmodule.exports = getCookie;\n\nfunction getCookie () {\n\n    if (window.jQuery.cookie && window.jQuery.removeCookie) {\n        console.log(appConfig.consoleText.info + \"jQuery cookie was already loaded, and now return.\");\n        return;\n    }\n\n    var pluses = /\\+/g;\n\n    function encode(s) {\n        return config.raw ? s : encodeURIComponent(s);\n    }\n\n    function decode(s) {\n        return config.raw ? s : decodeURIComponent(s);\n    }\n\n    function stringifyCookieValue(value) {\n        return encode(config.json ? JSON.stringify(value) : String(value));\n    }\n\n    function parseCookieValue(s) {\n        if (s.indexOf('\"') === 0) {\n            // This is a quoted cookie as according to RFC2068, unescape...\n            s = s.slice(1, -1).replace(/\\\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\');\n        }\n\n        try {\n            // Replace server-side written pluses with spaces.\n            // If we can't decode the cookie, ignore it, it's unusable.\n            // If we can't parse the cookie, ignore it, it's unusable.\n            s = decodeURIComponent(s.replace(pluses, ' '));\n            return config.json ? JSON.parse(s) : s;\n        } catch(e) {}\n    }\n\n    function read(s, converter) {\n        var value = config.raw ? s : parseCookieValue(s);\n        return window.jQuery.isFunction(converter) ? converter(value) : value;\n    }\n\n    var config = window.jQuery.cookie = function (key, value, options) {\n\n        // Write\n\n        if (value !== undefined && !window.jQuery.isFunction(value)) {\n            options = window.jQuery.extend({}, config.defaults, options);\n\n            if (typeof options.expires === 'number') {\n                var days = options.expires, t = options.expires = new Date();\n                t.setTime(+t + days * 864e+5);\n            }\n\n            return (document.cookie = [\n                encode(key), '=', stringifyCookieValue(value),\n                options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\n                options.path    ? '; path=' + options.path : '',\n                options.domain  ? '; domain=' + options.domain : '',\n                options.secure  ? '; secure' : ''\n            ].join(''));\n        }\n\n        // Read\n\n        var result = key ? \"\" : {};\n\n        // To prevent the for loop in the first place assign an empty array\n        // in case there are no cookies at all. Also prevents odd result when\n        // calling window.jQuery.cookie().\n        var cookies = document.cookie ? document.cookie.split('; ') : [];\n\n        for (var i = 0, l = cookies.length; i < l; i++) {\n            var parts = cookies[i].split('=');\n            var name = decode(parts.shift());\n            var cookie = parts.join('=');\n\n            if (key && key === name) {\n                // If second argument (value) is a function it's a converter...\n                result = read(cookie, value);\n                break;\n            }\n\n            // Prevent storing a cookie that we couldn't decode.\n            if (!key && (cookie = read(cookie)) !== undefined) {\n                result[name] = cookie;\n            }\n        }\n\n        return result;\n    };\n\n    config.defaults = {};\n\n    window.jQuery.removeCookie = function (key, options) {\n        if (window.jQuery.cookie(key) === undefined) {\n            return false;\n        }\n\n        // Must not alter options, thus extending a fresh object...\n        window.jQuery.cookie(key, '', window.jQuery.extend({}, options, { expires: -1 }));\n        return !window.jQuery.cookie(key);\n    };\n\n}", "/*\n *  Live Quick Login Packaged By LancerComet at 17:19, 2015/11/20.\n *  # Carry Your World #\n *  ---\n *  快速登录模块.\n *  当执行之后会检测是否登录, 若没登录则弹出快速登录且使用 throw new Error 阻塞 JS 执行.\n *  请在需要的模块中引入本模块.\n *\n */\n\nmodule.exports = liveQuickLogin;\n\nfunction liveQuickLogin () {\n    \"use strict\";\n\n    if (!$.cookie(\"DedeUserID\")){\n        try {\n            if (window.biliQuickLogin) {\n                window.biliQuickLogin(function () {\n                    window.location.reload();\n                });\n                throw \"Bilibili Live: 您没登陆，想干撒子？~~ -_-\";\n            } else {\n                throw \"Bilibili Live: 快速登录脚本尚未载入.\";\n            }\n        } catch (tryErr) {\n            throw new Error(tryErr);\n        }\n    }\n\n}", "/*\n *  Number to Fixed Function By LancerComet at 14:15, 2015/12/18.\n *  # Carry Your World #\n *  ---\n *  保留小数方法.\n *  本模块将在 Number 下建立原型方法.\n */\n\nmodule.exports = function () {\n\n    Number.prototype.toFixed1 = function (){\n        return parseFloat(this.toString().replace(/(\\.\\d{1})\\d+$/, \"$1\"));\n    }\n\n};\n", "/*\n *  Random Emoji By LancerComet at 10:39, 2015/12/16.\n *  # Carry Your World #\n *  ---\n *  随机返回一个颜文字.\n */\n\nvar emojiPool = {\n    happy: [\"(｀･ω･´)\", \"≖‿≖✧\", \"●ω●\", \"(/ ▽ \\\\)\", \"(=・ω・=)\", \"(●'◡'●)ﾉ♥\", \"<(▰˘◡˘▰)>\", \"(⁄ ⁄•⁄ω⁄•⁄ ⁄)\", \"(ง,,• ᴗ •,,)ง ✧\"],\n    shock: [ \",,Ծ‸Ծ,,\", \"(｀･д･´)\", \"Σ( ° △ °|||)︴\", \"┌( ಠ_ಠ)┘\", \"(ﾟДﾟ≡ﾟдﾟ)!?\"],\n    sad: [\"∑(っ °Д °;)っ\", \"＞︿＜\", \"＞△＜\", \"●︿●\", \"(´；ω；`)\"],\n    helpless: [\"◐▽◑\", \"ʅ（´◔౪◔）ʃ\", \"_(:3 」∠)_\", \"_(┐「ε:)_\", \"(/・ω・＼)\", \"(°∀°)ﾉ\"]\n};\n\n\nmodule.exports = {\n    happy: function () {\n        return emojiPool.happy[Math.floor(Math.random() * emojiPool.happy.length)];\n    },\n    sad: function () {\n        return emojiPool.sad[Math.floor(Math.random() * emojiPool.sad.length)];\n    },\n    shock: function () {\n        return emojiPool.shock[Math.floor(Math.random() * emojiPool.shock.length)];\n    },\n    helpless: function () {\n        return emojiPool.helpless[Math.floor(Math.random() * emojiPool.helpless.length)];\n    }\n};\n", "/*\n *  Avalon Set Number with Animation By LancerComet at 17:13, 2015.12.23.\n *  # Carry Your Wolrd #\n *  ---\n *\n *  Description:\n *  ---\n *  动画效果设置数字模块.\n *  仅限 Avalon 框架使用.\n *\n *  Usage:\n *  ---\n *  avalonSetNum(新的数字, 旧的数字, Avalon 视图对象属性[字符串])\n *\n *  例:\n *  avalonSetNum(10000, testCtrl.num, \"testCtrl.num\");\n *\n */\n\nmodule.exports = avalonSetNum;\n\nfunction avalonSetNum (newNumber, oldNumber, avalonProp) {\n    \"use strict\";\n\n    var numTimer = null;\n\n    // Error Handler.\n    if (Object.prototype.toString.call(newNumber) !== \"[object String]\" && Object.prototype.toString.call(newNumber) !== \"[object Number]\") {\n        throw new Error('Function \"avalonSetNum\" Error: 在使用 avalonSetNum() 时请使用数字作为参数.');\n    }\n\n    var currentNum = parseInt(oldNumber, 10);  // Definition: 当前的数字.\n    var newNum = parseInt(newNumber, 10);  // Definition: 新的数字.\n\n    // 当 currentNum 或 newNum 非数字时静默退出.\n    if (isNaN(currentNum) || isNaN(newNum)) {\n        console.log('Function \"avalonSetNum\" Error: 当前节点中的内容或传入数字无法格式化为有效数字, 方法退出.');\n        return;\n    }\n\n    // 当 currentNum 或 newNum 过大时静默退出.\n    if (!isFinite(currentNum) || !isFinite(newNum)) {\n        console.log('Function \"avalonSetNum\" Error: 当前节点中的内容或传入数字过于庞大, 方法退出.');\n        return;\n    }\n\n    var deltaNum = newNum - currentNum;  // Definition: 新数字与旧数字的差值.\n\n    // Action: 如果 deltaNum 太小，直接返回新的数字，跳过动画效果.\n    if (Math.abs(deltaNum) <= 10) {\n        eval(\"avalon.vmodels.\" + avalonProp + \" = \" + newNumber);\n        return;\n    }\n\n    var execTime = Math.abs(Math.floor(deltaNum / 10000));  // Definition: 期望的动画执行的最大次数.\n    if (execTime > 100) { execTime = 100; }  // execTime 最大为 100.\n\n    var deltaPerTime = deltaNum / execTime,  // 每次执行增加动画的增加数额.\n        addCount = 0;  // 增加动画执行次数计数.\n\n    // 设置新的计时器: element.timer.\n    numTimer = setInterval(function () {\n        if (addCount++ >= execTime) {\n            numTimer && _clearNumTimer();  // 清除计时器.\n            eval(\"avalon.vmodels.\" + avalonProp + \" = \" + newNum);  // 设置最终值.\n            return;\n        }\n        eval(\"avalon.vmodels.\" + avalonProp + \" = \" + parseInt(currentNum + deltaPerTime * addCount, 10));\n    }, 10);\n\n    /* Internal Function goes below. */\n\n    // Definition: 清除动画计时器.\n    function _clearNumTimer () {\n        clearInterval(numTimer);\n        numTimer = null;\n    }\n\n}", "/*\n *  Set Number with Animation Rewrite By LancerComet at 14:14, 2015.11.11.\n *  # Carry Your Wolrd #\n *  ---\n *\n *  Description:\n *  ---\n *  动画效果设置数字模块.\n *\n *  Info:\n *  ---\n *  模块将在对应节点下加入属性 \"data-real-number\" 来存储真实的数据, 可以从本属性即时取值.\n *\n *  Usage:\n *  ---\n *  setNum(新的数字, 原生节点 || jQuery 节点)\n *  注意：节点中必须为纯数字且存在数字, 否则直接报错退出.\n *\n */\n\nmodule.exports = setNum;\n\nfunction setNum (newNumber, element) {\n    \"use strict\";\n\n    // Error Handler.\n    if (Object.prototype.toString.call(newNumber) !== \"[object String]\" && Object.prototype.toString.call(newNumber) !== \"[object Number]\") {\n        throw new Error('Function \"setNum\" Error: 在使用 setNum() 时请使用数字作为参数.');\n    }\n\n    var currentNum = parseInt(_getHTML(element), 10);  // Definition: 当前的数字.\n    var newNum = parseInt(newNumber, 10);  // Definition: 新的数字.\n\n    // 当 currentNum 或 newNum 非数字时静默退出.\n    if (isNaN(currentNum) || isNaN(newNum)) {\n        (function () {\n            var consoleText = 'Function \"setNum\" Error: 当前节点中的内容或传入数字无法格式化为有效数字, 方法退出.';\n            console.error ? console.error(consoleText) : console.log(consoleText);\n            consoleText = null;\n        })();\n        return;\n    }\n\n    // 当 currentNum 或 newNum 过大时静默退出.\n    if (!isFinite(currentNum) || !isFinite(newNum)) {\n        (function () {\n            var consoleText = 'Function \"setNum\" Error: 当前节点中的内容或传入数字过于庞大, 方法退出.';\n            console.error ? console.error(consoleText) : console.log(consoleText);\n            consoleText = null;\n        })();\n        return;\n    }\n\n    (function setRealNumber () {\n        if (Object.prototype.toString.call(element).indexOf(\"Element\") > -1) {\n            // 当为原生对象时.\n            element.setAttribute(\"data-real-number\", newNum);\n        } else if (Object.prototype.toString.call(element) === \"[object Object]\") {\n            // 当为 jQuery 对象时.\n            // 但是在 IE 8 下原生对象会被判断到此处.\n            if (window.navigator.userAgent.indexOf(\"MSIE 8.0\") > -1 && window.navigator.userAgent.indexOf(\"Trident/4.0\") > -1) {\n                element.setAttribute(\"data-real-number\", newNum);\n            } else {\n                element.attr(\"data-real-number\", newNum);\n            }\n        } else {\n            // 非法 dom.\n            throw new Error('Function \"setRealNumber\" in \"setNum\" Error: 请指定一个正确的节点.');\n        }\n    })();\n\n    var _deltaNum = (newNum - currentNum);  // Definition: 新数字与旧数字的差值.\n\n    // Action: 如果 deltaNum 太小，直接设置新的数字，跳过动画效果.\n    if (Math.abs(_deltaNum) <= 10) {\n        _setHTML(element, newNum);\n        return;\n    }\n\n    var _execTimes = Math.abs(Math.floor(_deltaNum / 5));  // Definition: 期望的动画执行的最大次数.（绝对值）\n    if (_execTimes > 100) { _execTimes = 100; }  // _execTimes 最大为 100.\n\n    var _deltaPerTime = _deltaNum / _execTimes,  // 每次执行增加动画的增加数额.\n        _addCount = 0;  // 增加动画执行次数计数.\n\n    // 当已经存在动画计时器时, 清理旧的计时器.\n    // 计时器挂载到 element.timer 属性下.\n    element.numTimer && _clearNumTimer();\n\n    // 设置新的计时器: element.timer.\n    element.numTimer = setInterval(function () {\n        if (_addCount++ >= _execTimes) {\n            _setHTML(element, newNum);  // 当达到执行次数时, 直接设置最终值.\n            element.numTimer ? _clearNumTimer() : void(0);  // 清除计时器.\n            return newNum;  // 返回数字以便其他用途. (如果有)\n        }\n        _setHTML(element, parseInt(currentNum + _deltaPerTime * _addCount, 10));\n    }, 10);\n\n    /* Internal Function goes below. */\n\n    // Definition: 设置 innerHTML 方法, 兼容 jQuery 对象与原生对象.\n    function _setHTML(dom, content) {\n        if (Object.prototype.toString.call(dom).indexOf(\"Element\") > -1) {\n            // 当为原生对象时.\n            dom.innerHTML = content;\n        } else if (Object.prototype.toString.call(dom) === \"[object Object]\") {\n            // 当为 jQuery 对象时.\n            // 但是在 IE 8 下原生对象会被判断到此处.\n            if (window.navigator.userAgent.indexOf(\"MSIE 8.0\") > -1 && window.navigator.userAgent.indexOf(\"Trident/4.0\") > -1) {\n                dom.innerHTML = content;\n            } else {\n                dom.html(content);\n            }\n        } else {\n            // 非法 dom.\n            throw new Error('Function \"_setHTML\" in \"setNum\" Error: 请指定一个正确的节点.');\n        }\n    }\n\n    // Definition: 获取 innterHTML 方法.\n    function _getHTML (dom) {\n        if (Object.prototype.toString.call(dom).indexOf(\"Element\") > -1) {\n            // 当为原生对象时.\n            return dom.innerHTML;\n        } else if (Object.prototype.toString.call(dom) === \"[object Object]\") {\n            // 当为 jQuery 对象时.\n            // 但是在 IE 8 下原生对象会被判断到此处.\n            if (window.navigator.userAgent.indexOf(\"MSIE 8.0\") > -1 && window.navigator.userAgent.indexOf(\"Trident/4.0\") > -1) {\n                return dom.innerHTML;\n            } else {\n                return dom.html();\n            }\n        } else {\n            // 非法 dom.\n            throw new Error('Function \"_getHTML\" in \"setNum\" Error: 请指定一个正确的节点.');\n        }\n    }\n\n    // Definition: 清除动画计时器.\n    function _clearNumTimer () {\n        clearInterval(element.numTimer);\n        element.numTimer = null;\n    }\n\n}", "/*\n *  Timestamp Shorter By LancerComet at 12:17, 2016/1/7.\n *  # Carry Your World #\n *  ---\n *  Bilibili 特有的时间戳去掉后三位的方法.\n */\n\nmodule.exports = timestampShorter;\n\nfunction timestampShorter (timestamp) {\n    var newTimeStamp = null;\n    newTimeStamp = timestamp.toString();\n    newTimeStamp = newTimeStamp.slice(0, newTimeStamp.length - 3);\n    newTimeStamp = parseInt(newTimeStamp, 10);\n    return newTimeStamp;\n};\n", "/*\n *  Variable Type Adjustment By LancerComet at 13:22, 2015/11/30.\n *  # Carry Your World #\n *  ---\n *  变量类型判断模块.\n *\n */\n\nmodule.exports = function (variable) {\n\n    var type = Object.prototype.toString.call(variable);\n    var htmlReg = /HTML.*.Element/;\n\n    if (type ===\"[object Object]\" && variable.jquery) {\n        return \"jQuery Object\";\n    } else if (type === \"[object Object]\") {\n        return \"Object\";\n    } else if (type === \"[object Number]\") {\n        return \"Number\";\n    } else if (type === \"[object String]\") {\n        return \"String\";\n    } else if (type === \"[object Array]\") {\n        return \"Array\";\n    } else if (type === \"[object Boolean]\") {\n        return \"Boolean\";\n    } else if (type === \"[object Function]\") {\n        return \"Function\";\n    } else if (type === \"[object Null]\") {\n        return \"null\";\n    } else if (type === \"[object Undefined]\") {\n        return \"undefined\";\n    } else if (type.match(htmlReg)) {\n        return \"HTML Element\";\n    } else if (type === \"[object HTMLCollection]\") {\n        return \"HTML Elements Collection\";\n    } else {\n        return null;\n    }\n\n};\n", "/*\n *  Live Public Service By LancerComet at 16:03, 2015/12/18.\n *  # Carry Your World #\n *  ---\n *  公共服务控制器模块.\n */\n\nmodule.exports = liveService;\n\nfunction liveService () {\n\n    // Definition: 公共服务控制器.\n    var liveService = avalon.define({\n        $id: \"liveService\"\n    });\n\n\n    // Definition: 公共服务控制器事件引用定义.\n    // 每个公共事件将定义在单独的模块中并在此引用.\n    require(\"./live-service-update-currency\")(liveService);\n    require(\"./live-service-get-bp\")(liveService);\n\n}", "/*\n *  Get BP By LancerComet at 17:52, 2016/1/7.\n *  # Carry Your World #\n *  ---\n *  获取 BP 事件.\n *\n *  注意:\n *  ---\n *  这是一个同步请求, 如果请求不到则会引起短暂停滞.\n *  传入的参数 variable 为需要赋值的变量, 因为 $watch 无法进行数据返回.\n */\n\nmodule.exports = function (liveService, undefined) {\n    \"use strict\";\n\n\n};", "/*\n *  Live Currency Updating Event By LancerComet at 16:06, 2015/12/18.\n *  # Carry Your World #\n *  ---\n *  瓜子更新服务模块.\n */\nvar appConfig = require('../app-config/app-config');\nvar randomEmoji = require(\"../functions/func-random-emoji/random-emoji\");\n\nmodule.exports = function (liveService, undefined) {\n    \"use strict\";\n\n    // Definition: 瓜子更新服务定义.\n    liveService.$watch(\"updateCurrency\", function (value) {\n\n        // 当传入 value 时, 直接只用 value 的值进行广播.\n        if (value) {\n\n            if (value.gold !== null && value.gold !== undefined && !isNaN(value.gold)) { value.gold = parseInt(value.gold, 10); }\n            if (value.silver !== null && value.silver !== undefined && !isNaN(value.silver)) { value.silver = parseInt(value.silver, 10); }\n            if ((value.gold !== null && value.gold !== undefined && isNaN(value.gold)) || (value.silver !== null && value.silver !== undefined && isNaN(value.silver))) {\n                throw new Error(appConfig.consoleText.error + \"updateCurrency 的值必须为有效数字.\");\n            }\n            liveService.$fire(\"all!fillCurrency\", value);\n            return;\n        }\n\n\n        // 当没有传值时, 发送 XHR 获取最新瓜子数量.\n        $.ajax({\n            url: \"/user/getuserinfo\",\n            type: \"GET\",\n            data: {\n                ts: Date.now()\n            },\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code != \"REPONSE_OK\") {\n                    console.log(appConfig.consoleText.error + \"获取用户信息失败: \" + result.msg.toString());\n                    console.log(\"因此瓜子信息更新失败, 真令人尴尬 \" + randomEmoji.sad());\n                    return;\n                }\n\n                result.data.silver = parseInt(result.data.silver, 10);\n                result.data.gold = parseInt(result.data.gold, 10);\n\n                if (isNaN(result.data.silver) || isNaN(result.data.gold)) {\n                    console.log(appConfig.consoleText.caution + \"服务器返回瓜子数据非有效数字类型!\");\n                    return;\n                }\n\n                liveService.$fire(\"all!fillCurrency\", {\n                    silver: result.data.silver,\n                    gold: result.data.gold,\n                    biliCoin: result.data.billCoin\n                });\n            },\n            error: function (result) {\n                throw new Error(appConfig.consoleText.error + \"瓜子信息更新失败: 请求发送失败.\")\n            }\n        });\n\n    });\n\n\n};\n\n\n", "/*\n *  Live On Stream on Hint Panel By LancerComet at 10:54, 2016/1/13.\n *  # Carry Your World #\n *  ---\n *  开启直播直播码弹出提示.\n */\n\nvar livePopup = require('../../../../common/components/live-widget/live-popup/live-popup');\nvar randomEmoji = require('../../../../common/functions/func-random-emoji/random-emoji');\n\nmodule.exports = function (adminFuncsCtrl) {\n    \"use strict\";\n\n    // Definition: 弹窗 HTML 结构.\n    var popupHTML = \"\";\n\n    // Definition: 开启直播显示推流码面板.\n    adminFuncsCtrl.$watch(\"showStreamCode\", function () {\n        if (parseInt(ISANCHOR, 10) !== 1) { return; }\n        adminFuncsCtrl.$fire(\"all!showLiveManageDialog\");\n    });\n\n};", "/*\n *  Live Admin Functions By LancerComet at 10:55, 2016.01.13.\n *  # Carry Your World #\n *  ---\n *  房管相关功能模块.\n *  此模块非房间管理面板模块, 为各个分离的房管功能模块.\n */\n\nmodule.exports = function () {\n\n    var adminFuncsCtrl = avalon.define({\n        $id: \"adminFuncsCtrl\"\n    });\n\n    require(\"./functions/live-on-rtmp\")(adminFuncsCtrl);  // 开启直播 RTMP 码弹窗模块.\n\n};", "/**\n * Created by fanfan on 2016/1/11.\n */\n\nvar view = avalon.define({\n    $id: \"adminManage\",\n    urls: {\n        list: \"/liveact/ajaxGetAdminList\",\n        manage: \"/liveact/admin\"\n    },\n    roomid: window.ROOMID,\n    iptName: \"\",                // 管理员名称\n    iptFlag: false,\n    listData: [],               // 管理员列表\n    tipMsg: \"\",\n    doms: {},\n    csses: {\n        iptName: \".ipt-name\"\n    },\n    init: function() {\n        this.$el = $(\"[data-content='adminManage']\");\n        this.getList();\n    },\n    setDoms: function() {\n        var $el = this.$el,\n            csses = this.csses;\n\n        this.doms = {\n            $iptName: $(csses.iptName, $el)\n        };\n    },\n    clickAddAdmin: function(e) {\n        if (view.clickAddAdmin.ing) {\n            return;\n        }\n        view.clickAddAdmin.ing = true;\n\n        if (!view.iptName) {\n            view.tipMsg = \"请填写房管名称！\";\n            view.iptFlag = false;\n            view.clickAddAdmin.ing = false;\n        } else {\n            view.iptFlag = true;\n            view.tipMsg = \"\";\n\n            view.add(function() {\n                view.clickAddAdmin.ing = false;\n            });\n        }\n    },\n    clickDel: function(e) {\n        if (view.clickDel.ing) {\n            return;\n        }\n        view.clickDel.ing = true;\n\n        var $e = $(e.target),\n            index = $e.parents(\"tr\").index();\n\n        view.del(index, function() {\n            view.clickDel.ing = false;\n        });\n    },\n    getList: function(cb) {\n        var self = this,\n            url = this.urls.list,\n            param = {\n                roomid: view.roomid\n            };\n\n        $.ajax({\n            type: \"post\",\n            url: url,\n            data: param,\n            dataType: \"json\",\n            success: function(data) {\n                view.listData = data.data;\n\n                cb && cb();\n            }\n        })\n    },\n    manage: function(uname, type, successCb, failCb) {\n        var self = this,\n            url = this.urls.manage,\n            param = {\n                uname: uname,\n                roomid: self.roomid,\n                type: type\n            };\n\n        $.ajax({\n            type: \"post\",\n            url: url,\n            data: param,\n            dataType: \"json\",\n            success: function(data) {\n\n                if (data.code === 0) {\n                    successCb && successCb(data.data);\n                } else {\n                    failCb && failCb(data);\n                }\n            },\n            error: function(data) {\n                failCb && failCb(data);\n            }\n        });\n    },\n    add: function(cb) {\n        var uname = view.iptName;\n\n        this.manage(uname, \"add\", function(data) {\n            view.listData.unshift(data);\n            view.iptName = \"\";\n            view.tipMst = \"\";\n            liveToast(view.$el.find(\".btn-add\")[0], \"任命成功！\", \"success\", true);\n            cb && cb();\n        }, function(data) {\n            view.tipMsg = data.msg || \"\";\n            cb && cb();\n        })\n    },\n    del: function(index, cb) {\n        var uname = view.listData[index].userinfo.uname;\n\n        this.manage(uname, \"del\", function() {\n            liveToast(view.$el.find(\".item\").eq(index)[0], \"撤销成功\", \"success\", true);\n            view.listData.splice(index, 1);\n            cb && cb();\n        }, function(data) {\n            view.tipMsg = data.msg;\n            db && cb();\n        });\n    }\n});\n\nview.init();\n\nmodule.exports = view;", "/**\n * Created by fanfan on 2016/1/11.\n */\n\nrequire('perfect-scrollbar/jquery')($);\nvar view = avalon.define({\n    $id: \"blackManage\",\n    $el: [],\n    urls: {\n        list: \"/liveact/ajaxGetBlockList\",\n        add: \"/liveact/room_block_user\",\n        del: \"/liveact/del_room_block_user\"\n    },\n    roomid: window.ROOMID,\n    iptName: \"\",                // 黑名单名称\n    iptTime: \"\",                // 封禁时间\n    listData: [],               // 黑名单列表\n    tipName: \"\",\n    tipTime: \"\",\n    nowPage: 0,\n    iptNameFlag: true,\n    iptTimeFlag: true,\n    getListIng: false,\n    doms: {},\n    init: function(opt) {\n        this.$el = opt.$el;\n        //this.getList();\n        avalon.scan( this.$el[0], view);\n        this.bindScrollPage();\n\n    },\n    setDoms: function() {\n        var $el = this.$el,\n            csses = this.csses;\n\n        this.doms = {\n            $iptName: $(csses.iptName, $el)\n        };\n    },\n    refresh: function() {\n        this.nowPage = 0;\n        this.listData = [];\n        this.bindScrollPage();\n        this.getList();\n\n    },\n    clickAdd: function() {\n        if (view.clickAdd.ing) {\n            return;\n        }\n\n        view.clickAdd.ing = true;\n\n        var uname = view.iptName,\n            time = view.iptTime,\n            flag =  true;\n\n        if (!uname) {\n            view.tipName = \"请填写用户名！\";\n            flag = false;\n            view.iptNameFlag = false;\n        } else {\n            view.tipName = \"\";\n            view.iptNameFlag = true;\n        }\n\n        if (!time) {\n            view.tipTime = \"请填写封禁时间！\";\n            flag = false;\n            view.iptTimeFlag = false;\n        } else {\n            if (/[^0-9]/.test(time) || time > 72 || time < 1) {\n                view.tipTime = \"请直接输入数字(1-72)\"\n                flag = false;\n                view.iptTimeFlag = false;\n            } else {\n                view.tipTime = \"\"\n                view.iptTimeFlag = true;\n            }\n        }\n\n        if (flag) {\n            view.add(function() {\n                view.clickAdd.ing = false;\n            });\n        } else {\n            view.clickAdd.ing = false;\n        }\n\n\n    },\n    clickDel: function(e) {\n        if (view.clickDel.ing) {\n            return;\n        }\n        view.clickDel.ing = true;\n\n        var index = $(e.target).parents(\"tr\").index();\n\n        view.del(index, function() {\n            view.clickDel.ing = false;\n        });\n    },\n    getList: function(successCb, failCb) {\n        if (this.getListIng) {\n            return;\n        }\n\n        this.getListIng = true;\n\n        var self = this,\n            url = this.urls.list,\n            param = {\n                roomid: view.roomid,\n                page: view.nowPage + 1\n            };\n\n        $.ajax({\n            type: \"post\",\n            url: url,\n            data: param,\n            dataType: \"json\",\n            success: function(data) {\n                self.getListIng = false;\n                if (data.code === 0) {\n                    if (data.data.length > 0) {\n                        view.nowPage  = view.nowPage + 1;\n                        view.listData = view.listData.concat(data.data);\n                    }\n                    successCb && successCb(data.data);\n                } else {\n                    failCb && failCb();\n                }\n\n\n            },\n            error: function() {\n                self.getListIng = false;\n                failCb && failCb();\n            }\n        })\n    },\n    add: function(cb) {\n        var url = view.urls.add,\n            param = {\n                roomid: view.roomid,\n                uname: view.iptName,\n                type: 1,\n                hour: view.iptTime\n            };\n\n        $.ajax({\n            type: \"post\",\n            url: url,\n            data: param,\n            dataType: \"json\",\n            success: function(data) {\n                if (data.code === 0) {\n                    view.listData.unshift(data.data);\n                    view.tipName = \"\";\n                    view.iptName = \"\";\n                    view.iptTime = \"\";\n\n                    liveToast(view.$el.find(\".btn-add\")[0], \"添加成功\", \"success\", true);\n                } else {\n                    view.tipName = data.msg;\n                }\n\n                cb && cb();\n            },\n            error: function() {\n                cb && cb();\n            }\n        });\n    },\n    clickHide: function() {\n        view.$el.parents(\"[panel-type='roomManage']\").removeClass(\"open\")\n    },\n    del: function(index, cb) {\n        var id = this.listData[index].id,\n            url = view.urls.del,\n            param = {\n                roomid: view.roomid,\n                id: id\n            };\n\n        $.ajax({\n            type: \"post\",\n            url: url,\n            data: param,\n            dataType: \"json\",\n            success: function(data) {\n                if (data.code === 0) {\n                    liveToast(view.$el.find(\".item\").eq(index)[0], \"撤销成功\", \"success\", true);\n                    view.listData.splice(index, 1);\n                } else {\n                    view.tipName = data.msg;\n                }\n                cb && cb();\n            },\n            error: function() {\n                cb && cb();\n            }\n        });\n    },\n    bindScrollPage: function() {\n        this.unbindScrollPage();\n\n        var tid = 0,\n            $list = view.$el.find(\".manage-list\");\n\n\n            $list.bind(\"scroll\", function() {\n                if (tid) {\n                    clearTimeout(tid)\n                }\n\n                tid = setTimeout(function() {\n                    if ($list[0].scrollHeight - $list[0].scrollTop - $list[0].clientHeight  <= 0 ) {\n\n                        if (view.getListIng) {\n                            return;\n                        }\n\n                        view.getList(function(data) {\n                            if (data.length === 0) {\n                                view.unbindScrollPage();\n                            }\n                        });\n                    }\n\n                }, 50);\n            });\n\n    },\n    unbindScrollPage: function() {\n        view.$el.find(\".manage-list\").unbind(\"scroll\");\n    }\n});\n\n\n\n$(function() {\n    $(\".black-manage .manage-list\").perfectScrollbar()\n});\n\n\nmodule.exports = function(opt) {\n    $(function() {\n        view.init(opt);\n    });\n    return view;\n}", "(function (global){\n/**\n * Created by fanfan on 2016/1/11.\n */\n\nvar liveManageView = require(\"./live-manage.js\");\nvar blackManageView = require(\"./black-manage.js\")({$el: $(\"[data-content='blackManage']\", $(\"#live-info-manage\"))});\nvar adminManageView = require(\"./admin-manage.js\");\n\nvar manageView = avalon.define({\n    $id: \"liveInfoManage\",\n    curTarget: \"liveManage\",\n    isAdmin: false,\n    isOpen: false,\n    $el: \"#live-info-manage\",\n    $dialog: \".live-info-manage-dialog\",\n    coverNum: 0,\n    coverListData: [],\n    allowUploadCoverTime: 0,\n    init: function() {\n        var self = this;\n        this.$el = $(this.$el);\n        this.$dialog = this.$el.find(this.$dialog);\n        this.bindEvt();\n        avalon.scan(this.$el[0], manageView);\n        this.setWatch();\n\n    },\n\n    /**\n     * 设置监听事件\n     * */\n    setWatch: function() {\n        var self = this;\n\n        this.$watch(\"showLiveManageDialog\", function(opt) {\n            opt = opt || {};\n            if (opt.blackName) {\n                blackManageView.iptName = opt.blackName;\n            }\n            self.curTarget = opt.curTarget || \"liveManage\";\n            self.show();\n        });\n    },\n    clickTab: function(e) {\n        var $tab = $(e.target),\n            target = $tab.data(\"target\");\n\n        if (target !== manageView.curTarget) {\n            manageView.curTarget = target;\n\n            if (target === \"blackManage\") {\n                blackManageView.refresh();\n            }\n        }\n    },\n    show: function() {\n        var self = this;\n        // 打开窗口初始化数据\n        self.getCoverList(function (result) {\n            if (result.code == 0) {\n                self.$el.addClass(\"open\");\n                self.setPosition();\n            }\n        });\n    },\n    hide: function(e) {\n        this.$el.removeClass(\"open\")\n    },\n    clickHide: function() {\n        manageView.hide();\n    },\n    setPosition: function() {\n        var allWidth = document.documentElement.clientWidth,\n            allHeight = document.documentElement.clientHeight,\n            dialogWidth = this.$dialog.width(),\n            dialogHeight = this.$dialog.height(),\n            top,\n            left,\n            cssData;\n\n\n        top = allHeight / 2 -  dialogHeight / 2;\n        left = allWidth / 2 - dialogWidth / 2;\n\n        if (top < 0) {\n            top = top * 2\n\n        }\n\n        cssData = {\n            position: \"fixed\",\n            zIndex: 99,\n            left: left,\n            top: top\n        }\n\n        this.$dialog.css(cssData)\n    },\n    bindEvt: function() {\n        var resizeTid = 0,\n            self = this;\n\n        $(window).resize(function() {\n            if (resizeTid) {\n                clearTimeout(resizeTid);\n            }\n\n            resizeTid = setTimeout(function() {\n                if (self.$el.hasClass(\"open\")) {\n                    self.setPosition();\n                }\n            }, 50);\n        });\n    },\n\n    /**\n     * 直播封面相关\n     */\n\n    // 获取房间直播封面信息\n    getCoverList: function (callback) {\n        this.$el = $(this.$el);\n        $.ajax({\n            type: \"GET\",\n            data: {\n                roomid: global.ROOMID\n            },\n            url: \"/live/getMasterInfo\",\n            dataType: \"JSON\",\n            cache: false,\n            success: function (result) {\n                if (result.code == 0) {\n                    manageView.coverNum = result.data.coverNum;\n                    manageView.allowUploadCoverTime = result.data.allowUploadCoverTime;\n                    manageView.coverListData = result.data.coverList;  // 刷新直播封面列表数据\n                    avalon.scan(manageView.$el.find(\".cover-list\")[0], manageView);  // Scan 视图节点\n                }\n                callback && callback(result);\n            }\n        });\n    },\n\n    // 设置直播封面\n    setCover: function (event ,picId, callback) {\n        $.ajax({\n            type: \"POST\",\n            data: {\n                roomid: global.ROOMID,\n                type: \"cover\",\n                pic_id: picId\n            },\n            url: \"/liveact/changePic\",\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code == 0) {\n                    liveToast($(event.target), \"封面切换成功\", \"success\", true);\n                    manageView.getCoverList();\n                } else {\n                    liveToast($(event.target), result.msg, \"info\", true);\n                }\n            }\n        });\n    },\n\n    // 删除直播封面\n    delCover: function (event, picId, callback) {\n        livePopup({\n            title: \"确定吗~\",\n            html: '<p>确定要删除图片吗？</p>',\n            type: \"action\",\n            width: \"350\",\n            button: {\n                confirm: \"确定\",\n                cancel: \"取消\"\n            },\n            onConfirm: function () {\n                var self = this;\n                $.ajax({\n                    type: \"POST\",\n                    data: {\n                        roomid: global.ROOMID,\n                        type: \"cover\",\n                        pic_id: picId\n                    },\n                    url: \"/liveact/deletePic\",\n                    dataType: \"JSON\",\n                    success: function (result) {\n                        if (result.code == 0) {\n                            manageView.getCoverList();\n                            self.done();\n                        } else {\n                            liveToast($(event.target), result.msg, \"info\", true);\n                        }\n                    }\n                });\n            }\n        });\n\n    },\n\n    // 选择上传直播封面\n    uploadClick: function (event, coverNum) {\n        if (manageView.allowUploadCoverTime != 0) {\n            liveToast($(event.target), \"╮(￣⊿￣)╭，下次可上传时间为：\" + manageView.allowUploadCoverTime, \"info\", true);\n            return;\n        } else if (coverNum <= 0) {\n            liveToast($(event.target), \"当前您的等级不够，请加油升级哦\", \"info\", true);\n        } else {\n            $(\"#cover-img-input\").click();\n        }\n    },\n\n    // 上传直播封面\n    uploadCoverImg: function () {\n        var $bgImgInput = $(\"#cover-img-input\");\n        if($bgImgInput[0].files[0].size > 409600) {\n            liveToast($(\"#cover-upload-icon\"), \"文件大小不能超过50K\", \"info\", true);\n            return;\n        }\n        $(\"#coverFormFile\").submit();\n    },\n\n    /**\n     * 获取房间基本信息\n     */\n\n    getMasterInfo: function (callback) {\n        $.ajax({\n            type: \"GET\",\n            data: {\n                roomid: global.ROOMID\n            },\n            url: \"/live/getMasterInfo\",\n            dataType: \"JSON\",\n            cache: false,\n            success: function (result) {\n                if (result.code == 0) {\n                    manageView.coverNum = result.data.coverNum;\n                    manageView.allowUploadCoverTime = result.data.allowUploadCoverTime;\n                    manageView.coverListData = result.data.coverList;  // 刷新直播封面列表数据\n                    avalon.scan(manageView.$el.find(\".cover-list\")[0], manageView);  // Scan 视图节点\n                }\n                callback && callback(result);\n            }\n        });\n    }\n\n});\n\n$(function() {\n    manageView.init();\n\n    // Upload Success\n    window.roomCoverUploadSuccess = function(data) {\n        var data = JSON.parse(data);\n        if (data.code == 0) { // Success\n            manageView.getCoverList();\n        } else { // Error\n            liveToast($(\"#cover-upload-icon\"), data.msg, \"info\", true);\n        }\n    };\n\n});\n\n\n\nmodule.exports = function() {\n    return manageView\n}\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})", "/**\n * Created by fanfan on 2016/1/11.\n */\n\nvar randomEmoji = require('../../../../common/functions/func-random-emoji/random-emoji');\nvar view = avalon.define({\n    $id: \"liveManage\",\n    urls: {\n        liveInfo: \"/liveact/getrtmp\"\n    },\n    $el: [],\n    rtmpUrl: \"\",\n    liveCode: \"\",\n    init: function() {\n        view.$el = $(\"[data-content='liveManage']\");\n        this.$watch(\"showLiveManageDialog\", function() {\n            if (!view.rtmpUrl) {\n                view.getData(function(data) {\n                    view.successCallback(data);\n                });\n            }\n        });\n\n        this.bindEvt();\n    },\n    successCallback: function(data) {\n        view.rtmpUrl = data.data.addr;\n        view.liveCode = data.data.code;\n    },\n\n\n    getData: function(cb) {\n        var url = this.urls.liveInfo;\n\n        $.ajax({\n            type: \"post\",\n            url: url,\n            data: { roomid: window.ROOMID },\n            dataType: \"json\",\n            success: function(data) {\n                cb && cb(data)\n            }\n        });\n    },\n    bindEvt: function() {\n        if (typeof ZeroClipboard === \"undefined\") {\n            $.getScript(\"http://static.hdslb.com/live-static/libs/zero-clipboard/ZeroClipboard.min.js\", function() {\n                $(\".btn-copy\", view.$el).each(function() {\n                    var btnDom = $(this)[0],\n                        zero = new ZeroClipboard(btnDom);\n\n                    zero.on(\"ready\", function (readyEvent) {\n                        zero.on(\"aftercopy\", function (event) { liveToast(btnDom, \"复制成功！\" + randomEmoji.happy(), \"success\", false); });\n                    });\n\n\n                });\n            });\n        }\n\n    }\n});\n\n\n$(function() {\n    view.init();\n});\n\nmodule.exports = view;", "/**\n * Created by fanfan on 2016/1/13.\n */\n\n\n\nvar view = avalon.define({\n    $id: \"roomAdmin\",\n    isAdmin: true,\n    $el: [],\n    init: function () {\n        var self = this;\n\n        this.$el = $(\"#room-adminer\");\n        this.$dialog = this.$el.find(\".live-info-manage-dialog\");\n\n        this.bindEvt();\n\n        avalon.scan(this.$el[0]);\n        this.$watch(\"showBlackDialog\", function(opt) {\n            opt = opt || {};\n            if (opt.blackName) {\n                blackManageView.iptName = opt.blackName\n            }\n            self.show();\n        })\n    },\n    show: function () {\n        this.$el.addClass(\"open\");\n        this.setPosition();\n    },\n    clickHide: function() {\n        view.$el.removeClass(\"open\")\n    },\n    hide: function(e) {\n        this.$el.removeClass(\"open\")\n    },\n    setPosition: function() {\n        var allWidth = document.documentElement.clientWidth,\n            allHeight = document.documentElement.clientHeight,\n            dialogWidth = this.$dialog.width(),\n            dialogHeight = this.$dialog.height(),\n            top,\n            left,\n            cssData;\n\n\n        top = allHeight / 2 -  dialogHeight / 2;\n        left = allWidth / 2 - dialogWidth / 2;\n\n        if (top < 0) {\n            top = top * 2\n\n        }\n\n        cssData = {\n            position: \"fixed\",\n            zIndex: 1100,\n            left: left,\n            top: top\n        }\n\n        this.$dialog.css(cssData)\n    },\n    bindEvt: function() {\n        var resizeTid = 0,\n            self = this;\n\n        $(window).resize(function() {\n            if (resizeTid) {\n                clearTimeout(resizeTid);\n            }\n\n            resizeTid = setTimeout(function() {\n                if (self.$el.hasClass(\"open\")) {\n                    self.setPosition();\n                }\n            }, 50);\n        });\n    }\n\n});\n\n\nview.init();\n\nvar blackManageView = require(\"./black-manage.js\")({\n    $el: $(\"[data-content='blackManage']\", $(\"#room-adminer\"))\n});\n\nmodule.exports = function() {\n    return view;\n}", "/**\n * Created by fanfan on 2016/1/11.\n */\n\n\nvar view = avalon.define({\n    $id: \"roomInfoEdit\",\n    $el:\"#room-info-edit\",\n    $dialog: \".room-info-edit-dialog\",\n    $mask: [],\n    defData: {},                // 默认数据\n    nowData: {},\n    curBgTarget: \"default\",     // 背景 Tab: default custom\n    bgListData: [],             // 房间背景图数据\n    bgNum: 0,                   // 还可以上传的背景数\n    allowUploadBgTime: 0,       // 下一次允许上传背景图片的时间\n    allowUpdateAreaTime: 0,     // 下一次允许更改分区的时间\n    maxNameCount: 20,\n    nameCount: 0,\n    tipMsg:\"\",                  // 提示信息\n    nowArea: \"\",                // 当前分区名称\n    nowAreaID: \"\",              // 当前分区id\n    maxTag: 6,                  // 最大标签数量\n    tag: [],                    // 当前标签\n    recTag: [],                 // 当前分区推荐的标签\n    addTagName: \"\",             // 新增标签名称\n    area: \"\",\n    des: \"\",\n    roomName: \"\",               // 房间名称\n    defTagAddTip: \"\",\n    partListShow: false,        // 选区是否打开\n    init: function() {\n        var self = this;\n\n        this.$el = $(this.$el);\n        this.$dialog = this.$el.find(this.$dialog);\n\n        this.defData = this.getDefData();\n\n        this.roomName = this.defData.roomName;\n        this.des = this.defData.des;\n        this.nowArea = this.defData.nowArea;\n        this.nowAreaID = this.defData.nowAreaID;\n        this.tag = this.defData.tag;\n        this.recTag = this.defData.recTag;\n        this.nameCount = this.getNameCount(this.roomName);\n\n        avalon.scan(view.$el[0], view);\n\n        this.bindEvt();\n        this.setWatch();\n\n    },\n    setWatch: function() {\n        var self = this;\n\n        this.$watch(\"showRoomEditDialog\", function(e) {\n            self.show();\n        });\n    },\n    getDefData: function() {\n        var defData,\n            tags = $(\".tag-box\").attr(\"tags\"),\n            recTag = $(\"[recommendTags]\").attr(\"recommendTags\");\n\n\n        defData = {\n            roomName: $(\".ipt-room-name\").val(),\n            des: $(\"#dis-redactor-contenet\").val(),\n            nowArea: $(\".part-name\").text(),\n            nowAreaID: $(\".part-name\").data(\"value\"),\n            tag: tags ? tags.split(\",\") :  [],\n            recTag: recTag ? recTag.split(\",\") :  []\n        };\n\n        return defData;\n    },\n    setText: function() {\n        $('#dis-redactor-contenet').redactor({\n            lang: 'zh_cn',\n            minHeight: 125,\n            autoresize: false,\n            buttons: ['html', 'formatting', 'bold', 'italic', 'deleted',\n                'unorderedlist', 'orderedlist', 'outdent', 'indent',\n                'file', 'table', 'link', 'fontcolor', 'backcolor', 'alignment', 'horizontalrule'\n            ]\n        });\n    },\n    keyupRoomName: function(e) {\n        var  $text = $(e.target),\n            len = view.getNameCount($text.val()),\n            newText = \"\";\n\n\n        if (len > view.maxNameCount) {\n            len = 20;\n            view.roomName = newText = view.subStringC(view.roomName, view.maxNameCount * 2);\n            $text.val(newText);\n            e.preventDefault();\n        }\n\n        view.nameCount = len;\n    },\n    getNameCount: function(text) {\n        var len =  Math.ceil(text.replace(/[^\\x00-\\xff]/g, '__').length / 2);\n\n        return len;\n    },\n    subStringC: function(text, subLen) {\n        var subIrr = 0,\n            subIndex,\n            i = 0;\n\n        for (i; i < text.length; i++) {\n            if (/[^\\x00-\\xff]/.test(text[i])) {\n                subIrr = subIrr + 2\n            } else {\n                subIrr = subIrr + 1\n            }\n\n            if (subIrr > subLen) {\n                subIndex = i - 1;\n                break;\n            } else if (subIrr === subLen) {\n                subIndex = i;\n            }\n        }\n\n        return text.substring(0, subIndex + 1);\n    },\n    show: function() {\n        var self = this;\n        // 打开窗口初始化数据\n        self.getMasterInfo(function (result) {\n            if (result.code == 0) {\n                self.$el.addClass(\"open\");\n                self.setPosition();\n            }\n        });\n    },\n    checkTag: function(tagName) {\n        if (view.tag.length >= view.maxTag) {\n            view.tipMsg = \"您当前等级最多能填写 \" + view.maxTag + \" 个标签\"\n            return false;\n        }\n\n        if ($.inArray(tagName, view.tag) > -1) {\n            view.tipMsg = \"不能填写重复标签哦\"\n            return false;\n        }\n\n        if (!tagName) {\n            view.tipMsg = \"请输入标签\"\n            return false;\n        }\n\n        return true;\n    },\n    keyupInput: function(e) {\n        var tag;\n\n        if (e.keyCode === 13) {\n            tag = $.trim(view.addTagName);\n\n            if (view.checkTag(tag)) {\n                view.tag.push(view.addTagName);\n                view.addTagName= \"\";\n            }\n\n        }\n    },\n\n\n    /**\n     * 点击添加推荐标签\n     * */\n    clickRecTag: function(e) {\n        var $tag = $(e.target),\n            tagName = $.trim($tag.text()),\n            index = $tag.index();\n\n        if (view.checkTag(tagName)) {\n            view.tag.push(tagName);\n            view.recTag.splice(index, 1)\n        }\n    },\n    clickDelTag: function(e) {\n        var $tag = $(e.target),\n            index = $tag.index();\n\n        view.tag.splice(index, 1);\n        view.tipMsg = \"\"\n\n    },\n    clickHide: function() {\n        view.hide();\n    },\n    clickCancel: function() {\n        view.hide();\n    },\n    hide: function() {\n        var self = this;\n\n        this.$el.removeClass(\"open\");\n    },\n    setPosition: function() {\n        var allWidth = document.documentElement.clientWidth,\n            allHeight = document.documentElement.clientHeight,\n            dialogWidth = this.$dialog.width(),\n            dialogHeight = this.$dialog.height(),\n            top,\n            left,\n            cssData;\n\n\n        top = allHeight / 2 -  dialogHeight / 2;\n        left = allWidth / 2 - dialogWidth / 2;\n\n        if (top < 0) {\n            top = top * 2\n\n        }\n\n        cssData = {\n            position: \"fixed\",\n            zIndex: 99,\n            left: left,\n            top: top\n        }\n\n        this.$dialog.css(cssData)\n    },\n    bindEvt: function() {\n        var resizeTid = 0,\n            self = this;\n\n        $(window).resize(function() {\n            if (resizeTid) {\n                clearTimeout(resizeTid);\n            }\n\n            resizeTid = setTimeout(function() {\n                if (self.$el.hasClass(\"open\")) {\n                    self.setPosition();\n                }\n            }, 50);\n        });\n    },\n    clickPartHandle: function(e) {\n        if (view.allowUpdateAreaTime != 0) {\n            liveToast($(e.target), \"此功能被禁，\" + view.allowUpdateAreaTime + \" 解封\", \"info\", true);\n        } else {\n            view.partListShow = !view.partListShow;\n        }\n    },\n\n    /**\n     * 根据分区获取相关tag\n     * */\n    getRecTag: function(areaID) {\n        var url = \"/liveact/ajaxGetAreaTags\";\n\n        $.ajax({\n            type: \"get\",\n            data: {\n                area: areaID\n            },\n            url: url,\n            dataType: \"json\",\n            success: function(data) {\n                view.recTag = data.data;\n            }\n        });\n    },\n    clickPartItem: function(e) {\n        var $e = $(e.target),\n            id = $e.data(\"value\"),\n            text = $e.text();\n\n        view.nowArea = text;\n        view.nowAreaID = id;\n\n        view.getRecTag(id);\n\n        view.partListShow = false;\n    },\n    setData: function(param) {\n        $.ajax({\n            type: \"post\",\n            url: \"/liveact/edit_room\",\n            data: param,\n            dataType: \"json\",\n            success: function(data) {\n\n                if (data.code === 0) {\n                    liveToast(view.$el.find(\".btn-ok\")[0], \"信息修改成功\", \"success\", true);\n\n                    location.reload();\n                } else {\n                    view.tipMsg = data.msg;\n                }\n            }\n\n        });\n    },\n\n    /**\n     * 房间背景相关\n     */\n\n    // 获取房间背景信息\n    getBgList: function (callback) {\n        this.$el = $(this.$el);\n        $.ajax({\n            type: \"GET\",\n            data: {\n                roomid: window.ROOMID\n            },\n            url: \"/live/getMasterInfo\",\n            dataType: \"JSON\",\n            cache: false,\n            success: function (result) {\n                if (result.code == 0) {\n                    view.bgNum = result.data.bgNum;\n                    view.allowUploadBgTime = result.data.allowUploadBgTime;\n                    view.bgListData = result.data.bgList;  // 刷新背景图片列表数据\n                    avalon.scan(view.$el.find(\".cover-list\")[0], view);  // Scan 视图节点\n                }\n                callback && callback(result);\n            }\n        });\n    },\n\n    // 设置背景\n    setBg: function (event ,picId, callback) {\n        $.ajax({\n            type: \"POST\",\n            data: {\n                roomid: window.ROOMID,\n                type: \"bg\",\n                pic_id: picId\n            },\n            url: \"/liveact/changePic\",\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code == 0) {\n                    liveToast($(event.target), \"背景切换成功\", \"success\", true);\n                    view.getBgList();\n                } else {\n                    liveToast($(event.target), result.msg, \"info\", true);\n                }\n            }\n        });\n    },\n\n    // 设置默认背景\n    setDefBg: function (event ,bkId, callback) {\n        $.ajax({\n            type: \"POST\",\n            data: {\n                roomid: window.ROOMID,\n                bg_id: bkId\n            },\n            url: \"/liveact/change_bg\",\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code == 0) {\n                    liveToast($(event.target), \"背景切换成功\", \"success\", true);\n                    $(\".default-cover-list .cover-item\").removeClass(\"current\").addClass(\"operable\");\n                    $(\".default-cover-list .id-\" + bkId).removeClass(\"operable\").addClass(\"current\");\n                } else {\n                    liveToast($(event.target), result.msg, \"info\", true);\n                }\n            }\n        });\n    },\n\n    // 删除背景图片\n    delBg: function (event, picId, callback) {\n        livePopup({\n            title: \"确定吗~\",\n            html: '<p>确定要删除图片吗？</p>',\n            type: \"action\",\n            width: \"350\",\n            button: {\n                confirm: \"确定\",\n                cancel: \"取消\"\n            },\n            onConfirm: function () {\n                var self = this;\n                $.ajax({\n                    type: \"POST\",\n                    data: {\n                        roomid: window.ROOMID,\n                        type: \"bg\",\n                        pic_id: picId\n                    },\n                    url: \"/liveact/deletePic\",\n                    dataType: \"JSON\",\n                    success: function (result) {\n                        if (result.code == 0) {\n                            view.getBgList();\n                            self.done();\n                        } else {\n                            liveToast($(event.target), result.msg, \"info\", true);\n                        }\n                    }\n                });\n            }\n        });\n\n    },\n\n    // 选择上传背景图片\n    uploadClick: function (event, bgNum) {\n        if (view.allowUploadBgTime != 0) {\n            liveToast($(event.target), \"╮(￣⊿￣)╭，下次可上传时间为：\" + view.allowUploadBgTime, \"info\", true);\n            return;\n        } else if (bgNum <= 0) {\n            liveToast($(event.target), \"当前您的等级不够，请加油升级哦\", \"info\", true);\n        } else {\n            $(\"#bg-img-input\").click();\n        }\n    },\n\n    // 上传背景图片\n    uploadBgImg: function () {\n        var $bgImgInput = $(\"#bg-img-input\");\n        if($bgImgInput[0].files[0].size > 4096000) {\n            liveToast($(\"#bg-upload-icon\"), \"文件大小不能超过500K\", \"info\", true);\n            return;\n        }\n        $(\"#bgFormFile\").submit();\n    },\n\n    // 背景 Tab 切换　\n    clickTab: function(e) {\n        var $tab = $(e.target),\n            target = $tab.data(\"target\");\n\n        // 切换到自定义背景 Tab 时请求数据　\n        if (target == \"custom\") {\n            view.getMasterInfo();\n        }\n\n        if (target !== view.curBgTarget) {\n            view.curBgTarget = target;\n        }\n    },\n\n    /**\n     * 获取房间基本信息\n     */\n\n    getMasterInfo: function (callback) {\n        $.ajax({\n            type: \"GET\",\n            data: {\n                roomid: window.ROOMID\n            },\n            url: \"/live/getMasterInfo\",\n            dataType: \"JSON\",\n            cache: false,\n            success: function (result) {\n                if (result.code == 0) {\n                    view.bgNum = result.data.bgNum;\n                    view.allowUpdateAreaTime = result.data.allowUpdateAreaTime;\n                    view.allowUploadBgTime = result.data.allowUploadBgTime;\n                    view.maxTag = result.data.tagsNum;\n                    view.bgListData = result.data.bgList;  // 刷新背景图片列表数据\n                    avalon.scan(view.$el.find(\".cover-list\")[0], view);  // Scan 视图节点\n                }\n                callback && callback(result);\n            }\n        });\n    },\n\n    /**\n     * 提交数据\n     */\n    clickSubmit: function() {\n        if (view.getNameCount(view.roomName) > view.maxNameCount) {\n\n        }\n\n        if (!view.roomName) {\n            view.tipMsg = \"请填写房间名称！\";\n            return;\n        }\n\n        if (view.nowAreaID == -1) {\n            view.tipMsg = \"请选择分区！\";\n            return;\n        }\n        var param = view.getAllData();\n\n        view.setData(param);\n    },\n    getAllData: function() {\n        var self = this,\n            tagStr;\n\n        tagStr = this.tag.join(\",\");\n\n\n        return {\n            tags: tagStr,\n            title: self.roomName,\n            description: self.des,\n            roomid: window.ROOMID,\n            area: self.nowAreaID\n        }\n    }\n});\n\n// 加载富文本插件\n(function() {\n    var staticUrl = \"http://static.hdslb.com/live-static\";\n\n    $.getScript(staticUrl + \"/libs/redactor/redactor-8.2.4.js\", function() {\n        $.getScript(staticUrl + \"/libs/redactor/redactor-8.2.4.zh_cn.js\", function() {\n            view.setText();\n        });\n    });\n\n    $(\"body\").append('<link rel=\"stylesheet\" href=\"http://static.hdslb.com/css/redactor-8.2.4.css\">');\n\n    // Upload Success\n    window.roomBgUploadSuccess = function(data) {\n        var data = JSON.parse(data);\n        if (data.code == 0) { // Success\n            view.getBgList();\n        } else { // Error\n            liveToast($(\"#bg-upload-icon\"), data.msg, \"info\", true);\n        }\n    };\n})();\n\n\n\n$(function() {\n    view.init();\n});\n\nmodule.exports = function() {\n    return view;\n};", "/**\n * 调用房间管理/信息修改/黑名单设置模块\n * @author fanfan\n *\n * */\n\nmodule.exports = function (userInfo) {\n\n    if (userInfo.ISANCHOR) {\n        require(\"./javascripts/live-info-manage.js\");       // 房间管理\n        require(\"./javascripts/room-info-edit.js\");         // 信息修改\n    }\n\n    if (userInfo.ISADMIN == 1 && userInfo.ISANCHOR != 1) {\n        require(\"./javascripts/room-admin.js\");             // 房管的黑名单设置\n    }\n\n};", "/*\n *  Background Changer by LancerComet at 14:36, 2016/01/18.\n *  # Carry Your World #\n *  ---\n *\n *  描述:\n *  ---\n *  房间背景切换节点.\n *  本模块不使用 Avalon.\n *\n */\n\nvar liveToast = require('../../../../../common/components/live-widget/live-toast/live-toast');\nvar randomEmoji = require('../../../../../common/functions/func-random-emoji/random-emoji');\n\nmodule.exports = function (window) {\n\n    if (!window.ISANCHOR) {\n        $(\"#bk-changers\").remove();\n        return;\n    }\n\n    $(function () {\n        // Action: 添加事件绑定.\n        $(\"#bk-changers\").show().on(\"click\", \".changer\", function (event) {\n            var $this = $(this);\n            var bkId = $this.attr(\"data-bk-id\");\n\n            // 向服务器发送请求更滑背景.\n            $.ajax({\n                url: \"/liveact/change_bg\",\n                type: \"POST\",\n                data: {\n                    roomid: window.ROOMID,\n                    bg_id: bkId\n                },\n                dataType: \"JSON\",\n                success: function (result) {\n                    if (result.code != 0) {\n                        liveToast($this, result.msg + randomEmoji.sad(), \"caution\");\n                        return;\n                    }\n                    liveToast($this, \"背景更换成功！\" + randomEmoji.happy(), \"success\");\n                    $this.addClass(\"active\").siblings(\".changer\").removeClass(\"active\");\n                    $this = bkId = null;\n                },\n                error: function (xhrObj) {\n                    liveToast($this, \"背景更换失败, 稍后再试试吧 \" + randomEmoji.sad(), \"caution\");\n                }\n            });\n\n        });\n    });\n\n\n};", "/*\n *  Chat Controller Panel By LancerComet at 11:11, 2015/12/25.\n *  # Carry Your World #\n *  ---\n *  聊天控制区域模块.\n */\n\nvar lazyInit = require('../../../../../common/functions/func-avalon-lazy-init/lazy-init');\nvar liveQuickLogin = require('../../../../../common/functions/func-live-quick-login/live-quick-login');\nvar liveToast = require('../../../../../common/components/live-widget/live-toast/live-toast');\nvar randomEmoji = require('../../../../../common/functions/func-random-emoji/random-emoji');\n\nmodule.exports = function () {\n    \"use strict\";\n\n    // Definition: 弹幕颜色对象定义. 此变量数据供 Flash 使用.\n    var danmuColor = 0xffffff;\n\n    avalon.ready(function () {\n\n        // Definition: 聊天区域控制面板控制器.\n        var chatCtrlPanelCtrl = avalon.define({\n            $id: \"chatCtrlPanelCtrl\",\n\n            // 弹幕滚动锁定标识.\n            chatScrollLocked: false,\n\n            // 弹幕发送部分.\n            danmuSend: {\n                data: \"\",\n                maxLength: 20,\n                send: function (event) {\n                    if (event.type && event.type === \"keyup\" && event.keyCode !== 13) {\n                        return;\n                    }\n                    chatCtrlPanelCtrl.$fire(\"sendDanmu\", event.target || event.srcElement);\n                }\n            },\n\n            // 节点控制标识对象.\n            doms: {\n                emojiPanel: false,\n                danmuColor: false\n            },\n\n            // 聊天控制按钮.\n            danmuCtrl: {\n                emoji: function () {\n                    chatCtrlPanelCtrl.doms.emojiPanel = true;\n                    setTimeout(function () {\n                        $(window).on(\"click\", closeEmojiPanel);\n                    }, 1)\n                },\n\n                hotWords: function () {\n\n                },\n\n                color: function () {\n                    chatCtrlPanelCtrl.doms.danmuColor = !chatCtrlPanelCtrl.doms.danmuColor;\n                    setTimeout(function () {\n                        $(window).on(\"click\", closeDanmuColorPanel);\n                    }, 1);\n                },\n\n                empty: function (event) {\n                    liveToast(event.target || event.srcElement, \"清屏成功 \" + randomEmoji.helpless(), \"success\");\n                    chatCtrlPanelCtrl.$fire(\"all!chatListEmpty\", event);\n                },\n\n                lock: function () {\n                    chatCtrlPanelCtrl.chatScrollLocked = !chatCtrlPanelCtrl.chatScrollLocked;\n                    chatCtrlPanelCtrl.$fire(\"all!lockChatList\", chatCtrlPanelCtrl.chatScrollLocked);\n                }\n            }\n\n        });\n\n        // Definition: 发送弹幕事件.\n        chatCtrlPanelCtrl.$watch(\"sendDanmu\", function (element) {\n\n            // 快速登录.\n            liveQuickLogin();\n\n            // Error Handler.\n            if (!chatCtrlPanelCtrl.danmuSend.data) {\n                liveToast(element, \"请输入弹幕后再发送~ \" + randomEmoji.helpless());\n                return;\n            }\n\n            // 向 Flash 发送弹幕.\n            $(\"#player_object\")[0].sendMsg(chatCtrlPanelCtrl.danmuSend.data, danmuColor);\n\n            // 还原弹幕框.\n            chatCtrlPanelCtrl.danmuSend.data = \"\";\n\n        });\n\n        // Action: 初始化控制器.\n        lazyInit(document.getElementById(\"chat-ctrl-panel\"), chatCtrlPanelCtrl, function () {\n\n            // Action: 颜文字面板委托事件.\n            $(\".emoji-panel\").on(\"click\", \"a\", function () {\n                var danmuData = chatCtrlPanelCtrl.danmuSend.data + $(this).text();\n                chatCtrlPanelCtrl.danmuSend.data = danmuData.substr(0, chatCtrlPanelCtrl.danmuSend.maxLength);\n                closeEmojiPanel();\n            });\n\n            // 如果是 VIP 则赋值默认颜色.\n            if (parseInt(VIP, 10) === 1) {\n                var $vipDefault = $(\".danmu-color-block[data-default=true]\");\n                danmuColor = $vipDefault.attr(\"data-color\");\n                setTimeout(function () { $vipDefault.click(); }, 1);\n            }\n\n            // Action: 弹幕颜色选择委托事件.\n            $(\".danmu-color-panel .danmu-color-block\").on(\"click\", function (event) {\n                liveQuickLogin();\n\n                // 判断弹幕颜色与账号 VIP 是否匹配.\n                if ($(this).attr(\"data-vip\").toString() === \"true\" && parseInt(VIP, 10) !== 1) {\n                    liveToast($(this)[0], \"彩色弹幕仅限老爷使用哦~ \" + randomEmoji.helpless());\n                    return;\n                }\n\n                $(this).addClass(\"active\").siblings(\".danmu-color-block\").removeClass(\"active\");\n                danmuColor = $(this).attr(\"data-color\");\n                closeDanmuColorPanel(event);\n            });\n\n        });\n\n\n        /* Definition goes below. */\n\n        // Definition: 关闭颜文字面板方法.\n        function closeEmojiPanel (event) {\n            var target = event && (event.target || event.srcElement);\n            if (target && target.className.indexOf(\"emoji-panel\") > -1) { return; }\n            $(\".emoji-panel\").fadeOut(200, function () {\n                chatCtrlPanelCtrl.doms.emojiPanel = false;\n                $(window).off(\"click\", closeEmojiPanel);\n            });\n        }\n\n        // Definition: 关闭弹幕颜色面板方法.\n        function closeDanmuColorPanel (event) {\n            if (event) {\n                var target = event.target || event.srcElement;\n                if (target.className.indexOf(\"danmu-color-panel\") > -1 || target.className.indexOf(\".danmu-color-block\") > -1) { return; }\n            }\n            $(\".danmu-color-panel\").fadeOut(200, function () {\n                chatCtrlPanelCtrl.doms.danmuColor = false;\n                $(window).off(\"click\", closeDanmuColorPanel);\n            });\n        }\n\n        // Definition: Flash 全屏模式获取弹幕颜色 By LancerComet at 13:59, 2015.11.16.\n        // 此方法供 Flash 主动调用，无需前端手动触发.\n        window.getDanmuColor = function () {\n            return danmuColor;\n        };\n\n    });\n\n};", "/*\n *  房间聊天区账号操作区域 at 18:22, 2015/12/24.\n *  ---\n *\n *  描述:\n *  ---\n *  包括: 老爷 粉丝勋章 头衔\n *\n */\n\nmodule.exports = function () {\n    require('./javascripts/profile-ctrl.js')();  // 帐号操作控制器定义.\n};", "/*\n *  Fans Medal at 14:39, 2015/12/28.\n *  ---\n *  粉丝勋章相关逻辑\n */\nvar liveQuickLogin = require('../../../../../../../common/functions/func-live-quick-login/live-quick-login')\n\nmodule.exports = function (profileCtrlVM) {\n    \"use strict\";\n\n    var fansMedal = {\n        // 请求锁: 如果为 true 则不能发佩戴请求\n        locked: false,\n        // 获取当前佩戴的粉丝勋章信息\n        ajaxGetMyWearMedal: function () {\n            $.ajax({\n                url: \"/i/ajaxGetMyWearMedal\",\n                type: \"get\",\n                dataType: \"json\",\n                cache: false,\n                success: function(result) {\n                    if (result.code == 0) { // 成功获取当前佩戴的粉丝勋章信息\n                        profileCtrlVM.fansMedal.isWear = result.data.isWear;\n                        profileCtrlVM.fansMedal.myWearMedal = result.data;\n                        var width = (result.data.intimacy / result.data.next_intimacy * 100) + \"%\";\n                        $(\".medal-intimacy-progress .medal-progerss-bar\").width(width);\n                        profileCtrlVM.fansMedal.dataReady = true;\n                    }\n                }\n            });\n        },\n\n        // 获取拥有的粉丝勋章 list\n        ajaxGetMyMedalList: function (callback) {\n            $.ajax({\n                url: \"/i/ajaxGetMyMedalList\",\n                type: \"get\",\n                dataType: \"json\",\n                cache: false,\n                success: function(result) {\n                    if (result.code == 0) { // 成功获取拥有的粉丝勋章 list\n                        profileCtrlVM.fansMedal.myMedalList = result.data;\n                    }\n                    callback && callback();\n                }\n            });\n        },\n\n        // 佩戴粉丝勋章\n        wearFansMedal: function(medalId, callback) {\n            // 防止连续点击的多次请求\n            if (fansMedal.locked) {\n                return;\n            }\n            fansMedal.locked = true;\n            $.ajax({\n                url: \"/i/ajaxWearFansMedal\",\n                type: \"post\",\n                data: {\n                    medal_id: medalId\n                },\n                dataType: \"json\",\n                success: function(result) {\n                    fansMedal.locked = false;\n                    if (result.code == 0) {\n                        profileCtrlVM.fansMedal.isWear = 1;\n                        // 佩戴勋章成功 刷新变量\n                        MEDAL.level = result.data.level;\n                        MEDAL.medal_name = result.data.medal_name;\n                        MEDAL.anchorName = result.data.anchorName;\n                        MEDAL.roomid = result.data.roomid;\n                    }\n                    callback && callback();\n                }\n            });\n        },\n\n        // 取消佩戴粉丝勋章\n        cancelFansMedal: function() {\n            $.ajax({\n                url: \"/i/ajaxCancelWear\",\n                type: \"get\",\n                dataType: \"json\",\n                success: function(result) {\n                    if (result.code == 0) {\n                        profileCtrlVM.fansMedal.isWear = 0;\n                    }\n                }\n            });\n        }\n\n\n    };\n\n    // 佩戴粉丝勋章\n    profileCtrlVM.fansMedal.wearFansMedal = function (medalId) {\n        fansMedal.wearFansMedal(medalId, function () {\n            fansMedal.ajaxGetMyWearMedal();\n        });\n    };\n\n    // 取消粉丝勋章\n    profileCtrlVM.fansMedal.cancelFansMedal = function () {\n        fansMedal.cancelFansMedal();\n        profileCtrlVM.fansMedal.myWearMedal.medal_id = -1;\n    };\n\n    // 切换粉丝勋章 Tip box 面板\n    profileCtrlVM.fansMedal.toggleTipbox = function () {\n        liveQuickLogin();\n        profileCtrlVM.fansMedal.visible = !profileCtrlVM.fansMedal.visible;\n        if (profileCtrlVM.fansMedal.visible) {\n            fansMedal.ajaxGetMyWearMedal();\n            setTimeout(function () {\n                $(document).on(\"click\", closeMedalPanel);\n            }, 1);\n        }\n    };\n\n    // 切换勋章选择面板\n    profileCtrlVM.fansMedal.choosePanelToggle = function () {\n        if (!profileCtrlVM.fansMedal.choosePanelVisible) {\n            fansMedal.ajaxGetMyMedalList(function () {\n                profileCtrlVM.fansMedal.choosePanelVisible = true;\n            });\n        } else {\n            profileCtrlVM.fansMedal.choosePanelVisible = false;\n        }\n    };\n\n    // 监听获得新粉丝勋章\n    profileCtrlVM.$watch(\"newFansMedalNotice\", function (medalData) {\n\n        /*\n         *  @ medalData: {\n         *    medalId: Number,\n         *    medalName: String,\n         *    medalLevel: String\n         *  }\n         */\n\n        profileCtrlVM.fansMedal.newFansMedal.medalId = medalData.medalId;\n        profileCtrlVM.fansMedal.newFansMedal.medalName = medalData.medalName;\n        profileCtrlVM.fansMedal.newFansMedal.medalLevel = medalData.medalLevel;\n        profileCtrlVM.fansMedal.newFansMedal.show = true;\n\n    });\n\n    profileCtrlVM.fansMedal.closeNewFansMedalNotice = function () {\n        profileCtrlVM.fansMedal.newFansMedal.show = false;\n    };\n\n    profileCtrlVM.fansMedal.newFansMedalWearNow = function (medalId) {\n        fansMedal.wearFansMedal(medalId, function () {\n            profileCtrlVM.fansMedal.newFansMedal.show = false;\n        });\n    };\n\n    // 关闭粉丝勋章面板\n    function closeMedalPanel () {\n        $(\".fans-medal-tips-box\").fadeOut(200, function () {\n            profileCtrlVM.fansMedal.visible = false;\n            profileCtrlVM.fansMedal.choosePanelVisible = false;\n            $(document).off(\"click\", closeMedalPanel);\n        });\n    }\n\n};", "/*\n *  Profile Ctrl at 14:26, 2015/12/28.\n *  ---\n *  聊天 Profile 控制区域模块.\n */\n\nvar lazyInit = require(\"../../../../../../../common/functions/func-avalon-lazy-init/lazy-init\");\nvar liveQuickLogin = require('../../../../../../../common/functions/func-live-quick-login/live-quick-login');\nmodule.exports = function () {\n    \"use strict\";\n\n    avalon.ready(function () {\n        var profileCtrlVM = avalon.define({\n            $id: \"profileCtrl\",\n            fansMedal: {\n                visible: false,\n                choosePanelVisible: false,\n                dataReady: false,\n                isWear: 0,\n                myWearMedal: {\n                    progressWidth: \"0%\"\n                },\n                newFansMedal: {\n                    show: false,\n                    medalId: 0,\n                    medalName: \"\",\n                    medalLevel: \"\"\n                },\n                myMedalList: []\n            },\n            title: {\n                visible: false,\n                choosePanelVisible: false,\n                dataReady: false,\n                isWear: 0,\n                myWearTitle:{\n                    titleName: \"\"\n                },\n                newTitle: {\n                    show: false,\n                    titleName: \"\"\n                },\n                myTitleList: []\n            },\n            vip: {\n                toVip: function () {\n                    liveQuickLogin();\n                    window.open('http://live.bilibili.com/i#to-vip', '_blank');\n                }\n            },\n            stopPropagation: function (event) {\n                event.stopPropagation();\n            }\n        });\n\n\n\n        lazyInit(document.getElementById(\"profile-ctrl\"), profileCtrlVM, function () {\n            // 粉丝勋章\n            require(\"./fans-medal\")(profileCtrlVM);\n\n            // 头衔\n            require(\"./title\")(profileCtrlVM);\n        });\n\n    });\n\n};", "/*\n *  Title at 17:10, 2016/01/12.\n *  ---\n *  头衔相关逻辑\n */\nvar liveQuickLogin = require('../../../../../../../common/functions/func-live-quick-login/live-quick-login');\n\nmodule.exports = function (profileCtrlVM) {\n    \"use strict\";\n\n    var title = {\n        // 请求锁: 如果为 true 则不能发佩戴请求\n        locked: false,\n\n        // 获取当前佩戴的头衔信息\n        ajaxGetMyWearTitle: function () {\n            $.ajax({\n                url: \"/i/ajaxGetMyWearTitle\",\n                type: \"get\",\n                dataType: \"json\",\n                success: function(result) {\n                    if (result.code == 0) { // 成功获取当前佩戴的头衔信息\n                        if (result.data.title) {  // 有佩戴头衔\n                            profileCtrlVM.title.isWear = 1;\n                        } else {  // 没有佩戴头衔\n                            profileCtrlVM.title.isWear = 0;\n                        }\n                        profileCtrlVM.title.myWearTitle = result.data;\n                        profileCtrlVM.title.dataReady = true;\n                    }\n                }\n            });\n        },\n\n        // 获取头衔 List\n        ajaxGetMyTitleList: function (callback) {\n            $.ajax({\n                url: \"/i/ajaxGetMyTitleList\",\n                type: \"get\",\n                dataType: \"json\",\n                success: function(result) {\n                    if (result.code == 0) { // 成功获取头衔 list\n                        profileCtrlVM.title.myTitleList = result.data;\n                    }\n                    callback && callback();\n                }\n            });\n        },\n\n        // 佩戴头衔\n        ajaxWearTitle: function (titleName, callback) {\n            // 防止连续点击的多次请求\n            if (title.locked) {\n                return;\n            }\n            title.locked = true;\n            $.ajax({\n                url: \"/i/ajaxWearTitle\",\n                type: \"post\",\n                data: {\n                    title: titleName\n                },\n                dataType: \"json\",\n                success: function(result) {\n                    title.locked = false;\n                    if (result.code == 0) {\n                        profileCtrlVM.title.isWear = 1;\n                        // 佩戴头衔成功 刷新变量\n                        TITLE.title = titleName;\n                    }\n                    callback && callback();\n                }\n            });\n        },\n\n        // 取消佩戴头衔\n        ajaxCancelWearTitle: function (callback) {\n            $.ajax({\n                url: \"/i/ajaxCancelWearTitle\",\n                type: \"post\",\n                dataType: \"json\",\n                success: function(result) {\n                    if (result.code == 0) {\n                        profileCtrlVM.title.isWear = 0;\n                    }\n                    callback && callback(result);\n                }\n            });\n        }\n    };\n\n    // 佩戴头衔\n    profileCtrlVM.title.wearTitle = function (titleName) {\n        title.ajaxWearTitle(titleName, function () {\n            title.ajaxGetMyWearTitle();\n        });\n    };\n\n    // 取消佩戴头衔\n    profileCtrlVM.title.cancelTitle = function () {\n        title.ajaxCancelWearTitle();\n    };\n\n    // 切换头衔 Tip box 面板\n    profileCtrlVM.title.toggleTipbox = function () {\n        liveQuickLogin();\n        profileCtrlVM.title.visible = !profileCtrlVM.title.visible;\n        if (profileCtrlVM.title.visible) {\n            title.ajaxGetMyWearTitle();\n            setTimeout(function () {\n                $(document).on(\"click\", closeTitlePanel);\n            }, 1);\n        }\n    };\n\n    // 切换头衔选择面板\n    profileCtrlVM.title.choosePanelToggle = function () {\n        if (!profileCtrlVM.title.choosePanelVisible) {\n            title.ajaxGetMyTitleList(function () {\n                profileCtrlVM.title.choosePanelVisible = true;\n            });\n        } else {\n            profileCtrlVM.title.choosePanelVisible = false;\n        }\n    };\n\n    // 监听获得新头衔\n    profileCtrlVM.$watch(\"newTitleNotice\", function (titleName) {\n        console.log(titleName);\n        profileCtrlVM.title.newTitle.titleName = titleName;\n        profileCtrlVM.title.newTitle.show = true;\n    });\n\n    profileCtrlVM.title.closeNewTitleNotice = function () {\n        profileCtrlVM.title.newTitle.show = false;\n    };\n\n    profileCtrlVM.title.newTitleWearNow = function (titleName) {\n        title.ajaxWearTitle(titleName, function () {\n            profileCtrlVM.title.newTitle.show = false;\n        });\n    };\n\n    // 关闭头衔面板\n    function closeTitlePanel () {\n        $(\".title-tips-box\").fadeOut(200, function () {\n            profileCtrlVM.title.visible = false;\n            profileCtrlVM.title.choosePanelVisible = false;\n            $(document).off(\"click\", closeTitlePanel);\n        });\n    }\n\n};", "/*\n *  Chat Controller Panel By LancerComet at 17:40, 2016/01/01.\n *  # Carry Your World #\n *  ---\n *  聊天弹幕控制器.\n */\nvar getAbsPosition = require('../../../../../common/functions/func-get-abs-position/get-abs-position');\nvar liveQuickLogin = require('../../../../../common/functions/func-live-quick-login/live-quick-login');\nvar liveToast = require('../../../../../common/components/live-widget/live-toast/live-toast');\nvar lazyInit = require('../../../../../common/functions/func-avalon-lazy-init/lazy-init');\nvar randomEmoji = require('../../../../../common/functions/func-random-emoji/random-emoji');\n\nmodule.exports = function () {\n    \"use strict\";\n\n    avalon.ready(function () {\n\n        // Definition: 聊天区域控制器定义。\n        var chatListCtrl = avalon.define({\n            $id: \"chatListCtrl\",\n\n            // 聊天区域数据存储对象.\n            data: {\n                chatList: [],  // 聊天记录数据数组.\n                clickedDanmu: {\n                    uid: null,\n                    msg: null,\n                    reason: null\n                }\n            },\n\n            // 聊天区域事件定义.\n            events: {\n\n                // 聊天记录列表.\n                chatList: {\n                    // 锁定聊天区域.\n                    lockToggle: function (value) {\n                        chatListCtrl.doms.chatArea.locked = value;\n                        chatListCtrl.doms.chatArea.noAppending = chatListCtrl.doms.chatArea.locked;\n                    }\n                },\n\n                // 点击弹幕事件.\n                showDanmuPopup: showDanmuPopup,\n\n                // 关闭弹幕点击面板.\n                hideDanmuPopup: hideDanmuPopup,\n\n                // 弹幕屏蔽事件.\n                forbidDanmu: forbidDanmu,\n\n                // 弹幕举报事件.\n                reportDanmu: {\n                    setup: reportDanmu,\n                    confirm: reportDanmuConfirm,\n                    cancel: reportDanmuCancel\n                },\n\n                // 黑名单添加事件.\n                blockUser: function () {\n                    if (ISADMIN != 1) { return; }\n\n                    ISANCHOR == 1 ? chatListCtrl.$fire(\"all!showLiveManageDialog\", {\n                        curTarget: \"blackManage\",\n                        blackName: chatListCtrl.doms.danmuPopup.uname\n                    }) : chatListCtrl.$fire(\"all!showBlackDialog\", {\n                        blackName: chatListCtrl.doms.danmuPopup.uname\n                    });\n\n                    chatListCtrl.events.hideDanmuPopup();\n                }\n            },\n\n            // 聊天区域节点定义.\n            doms: {\n\n                // 聊天记录列表.\n                chatArea: {\n                    locked: false,\n                    noAppending: false\n                },\n\n                // 弹幕弹出面板控制.\n                danmuPopup: {\n                    show: false,\n                    left: 0,\n                    top: 0,\n                    targetUID: null,\n                    uname: \"\"\n                },\n\n                // 弹幕举报面板.\n                danmuReportPanel: {\n                    show: false,\n                    out: false,\n                    focus: false\n                }\n            }\n        });\n\n        // Definition: 控制器事件定义.\n        (function eventsDefinition () {\n\n            // Definition: 聊天历史记录容器节点.\n            var $chatList = $(\"#chat-msg-list\");\n\n            // Definition: 弹幕添加事件. 弹幕添加不使用 Avalon 是考虑到性能问题, ms-repeat 造成的性能开销太大.\n            chatListCtrl.$watch(\"addDanmu\", function (json) {\n\n                console.log(\"Event: addDanmu\");\n                console.log(json);\n\n                // 如果锁定了弹幕框则退出.\n                if (chatListCtrl.doms.chatArea.locked && json.info[2][0] != UID) { return; }\n\n                // 如果是自己刚发送的弹幕则退出.\n                if (json.info[2][0] == UID && json.info[0][5] == DANMU_RND) { return; }\n\n                // Action: 聊天记录大于 100 后移除第一条.\n                $chatList.children().length > 100 && $chatList.children().eq(0).remove();\n\n                // Definition: 聊天记录节点结构.\n                var msgHTML = '<div class=\"chat-msg\" data-uname=\"' + json.info[2][1] + '\" data-uid=\"' + json.info[2][0] + '\" data-msg=\"' + json.info[1] + '\">';\n\n                // Action: 添加 VIP 标识.\n                if (json.info[2][3] == 1 || (json.info[2][0] == UID && VIP == 1)){\n                    msgHTML += '<a href=\"/i#to-vip\" target=\"_blank\"><span class=\"vip-icon\"><i class=\"live-icon vip-color v-middle\"></i></span></a>';\n                }\n\n                // Action: 添加播主标识.\n                if ((json.info[2][2] == 1 && json.info[2][0] == MASTERID) || (json.info[2][0] == UID && ISADMIN == 1 && UID == MASTERID)) {\n                    msgHTML += '<span class=\"square-icon master\">播主</span>'\n                }\n\n                // Action: 添加管理员标识.\n                if ((json.info[2][2] == 1 || (json.info[2][0] == UID && ISADMIN == 1)) && json.info[2][0] != MASTERID) {\n                    msgHTML += '<span class=\"square-icon admin\">房管</span>';\n                }\n\n                // Action: 添加粉丝勋章.\n                if ((json.info[2][0] == UID && !$.isEmptyObject(MEDAL)) || (json.info[3] && json.info[3].length)) {\n                    (json.info[3] && json.info[3].length) ? medalHTML({\n                        level: json.info[3][0],\n                        name: json.info[3][1],\n                        roomid: json.info[3][3],\n                        anchor: json.info[3][2]\n                    }) : medalHTML({\n                        level: MEDAL.level,\n                        name: MEDAL.medal_name,\n                        roomid: MEDAL.roomid,\n                        anchor: MEDAL.anchorName\n                    });\n                }\n\n                function medalHTML (data) {\n                    msgHTML += '<span class=\"medal-icon medal-icon-lv' + data.level + '\" data-medal=\"' + data.name +'\" data-level=\"' + data.level + '\"><div class=\"medal-info\"><span class=\"content\"><a href=\"/' + data.roomid + '\" target=\"_blank\">勋章主播：' + data.anchor + '</a></span></div></span>';\n                }\n\n                // Action: 设置账号头衔.（设置自己的头衔, 直接取 TITLE 中的第一个. 当用户没有选择头衔时, TITLE 中将为空数组.）\n                if (json.info[2][0] == UID && !$.isEmptyObject(TITLE)) {\n                    msgHTML += '<span class=\"live-title-icon '+ TITLE.title +'\"></span>';\n                }\n\n                // Action: 设置他人头衔.\n                if (msgHTML.indexOf(\"live-title-icon\") < 0 && json.info[5] && json.info[5].length) { msgHTML += '<span class=\"live-title-icon '+ json.info[5][0] +'\"></span>'; }\n\n\n                // Switch: 仅个人可见消息记录.\n                if (json.info[2][0] == UID) {\n\n                    // 添加用户等级.\n                    if (!$.isEmptyObject(USER_LEVEL) && USER_LEVEL.level > 0) {\n                        msgHTML += '<span class=\"user-level-icon lv-' + USER_LEVEL.level + '\"><div class=\"user-level-info\"><div class=\"content\"><p>用户等级：' + USER_LEVEL.level + '</p><p>排名：' + USER_LEVEL.rank + '</p></div></div></span>'\n                    }\n\n                    // 设置账户名称.\n                    msgHTML += '<span class=\"user-name\">[自己] : </span>';\n\n                    // 自己的消息添加类名.\n                    msgHTML = msgHTML.replace('<div class=\"chat-msg\"', '<div class=\"chat-msg mine\"');\n\n                } else {\n                    // Switch: 其他人聊天信息设置.\n\n                    // 设置用户等级.\n                    if ($.isArray(json.info[4]) && json.info[4].length > 0 && json.info[4][0] > 0) {\n                        msgHTML += '<span class=\"user-level-icon lv-' + json.info[4][0] + '\"><div class=\"user-level-info\"><div class=\"content\"><p>用户等级：' + json.info[4][0] + '</p><p>排名：' + json.info[4][1] + '</p></div></div></span>'\n                    }\n\n                    // 设置账户名称.\n                    msgHTML += '<span class=\"user-name color\">' + json.info[2][1] + ' : </span>';\n                }\n\n                // 添加聊天消息.\n                msgHTML += '<span class=\"msg-content\">' + json.info[1] + '</span></div>';\n                $chatList.append(msgHTML);\n\n                // 滚动至底部.\n                $chatList.scrollTop($chatList[0].scrollHeight);\n            });\n\n            // Definition: 礼物添加事件.\n            chatListCtrl.$watch(\"addGift\", function (json) {\n\n                console.log(\"Event: addGift\");\n                console.log(json);\n\n                // 如果锁定了弹幕框则退出.\n                if (chatListCtrl.doms.chatArea.locked && json.data.uid != UID) {\n                    json.data[\"super\"] > 0 && chatListCtrl.$fire(\"superGift\", json.data);\n                    return;\n                }\n\n                // 更新房间收礼总数.\n                chatListCtrl.$fire(\"all!giftReceived\", json.data.rcost);\n\n                // 更新投喂榜数据.\n                $.isArray(json.data.top_list) && json.data.top_list.length > 0 && chatListCtrl.$fire(\"all!updateGiftTop\", json.data.top_list);\n\n                // 更新闪耀之星票数.\n                json.data.starRank && chatListCtrl.$fire(\"all!shiningStarCount\", json.data.starRank);\n\n                // 判断礼物是否为本人送出, 如果为本人送出则退出.\n                if (window.giftTsHistory.indexOf(parseInt(json.data.timestamp, 10)) > -1 && json.data.uid == window.UID) {\n                    return;\n                }\n\n                // 连击礼物事件.\n                json.data[\"super\"] > 0 && chatListCtrl.$fire(\"superGift\", json.data);\n\n                // 添加送礼历史.\n                chatListCtrl.$fire(\"addGiftHistory\", json);\n\n            });\n\n            // Definition: 送礼记录 HTML 添加事件.\n            // 上方的为送礼广播事件，此事件为 HTML 的添加动作.\n            chatListCtrl.$watch(\"addGiftHistory\", function (json) {\n                console.log(\"addGiftHistory\");\n                console.log(json);\n                var giftHTML = '<div class=\"gift-msg\" role=\"listitem\">'\n                    + '<span class=\"user-name\">' + json.data.uname + '</span>'\n                    + '<span class=\"action\">'+ json.data.action + json.data.giftName + '</span>'\n                    + '<div class=\"gift-img gift-' + json.data.giftId + '\" role=\"img\"></div>'\n                    + '<span class=\"gift-count\">X ' + json.data.num + '</span>'\n                    + '</div>';\n                $(\"#chat-msg-list\").append(giftHTML);\n\n                // 滚动至底部.\n                $chatList.scrollTop($chatList[0].scrollHeight);\n\n                // Manual GC.\n                giftHTML = null;\n            });\n\n            // Definition: 聊天记录容器锁定事件.\n            chatListCtrl.$watch(\"lockChatList\", function (value) {\n                chatListCtrl.events.chatList.lockToggle(value);\n            });\n\n            // Definition: 聊天记录清空事件.\n            chatListCtrl.$watch(\"chatListEmpty\", function () {\n                $(\"#chat-msg-list\").empty();\n            });\n\n            // Definition: 连击礼物事件.\n            // 接收的 data 为广播下发的 json.data 或送礼返回的 result.data.data 数据.\n            chatListCtrl.$watch(\"superGift\", function (data) {\n                require(\"../super-gift/super-gift\").exec(data);\n            });\n\n            // Definition: Welcome 消息事件.\n            chatListCtrl.$watch(\"addWelcomeMsg\", function (json) {\n                if (json.data.uid == UID) { return; }\n                var msgHTML = '<div class=\"system-msg\">';\n\n                msgHTML += '<a target=\"_blank\" href=\"/i#to-vip\"><i class=\"live-icon vip-color v-middle\"></i></a>';\n\n                if (json.data.isadmin == 1) {\n                    if (json.data.uid == window.MASTERID) {\n                        msgHTML += '<span class=\"square-icon master\">播主</span>';\n                    } else {\n                        msgHTML += '<span class=\"square-icon admin\">房管</span>';\n                    }\n                }\n\n                msgHTML += '<span class=\"welcome v-middle\" style=\"color: #f25d8e\">' + json.data.uname + ' 老爷</span><span class=\"v-middle\">进入直播间</span></div>';\n\n                $chatList.append(msgHTML);\n\n                // 滚动至底部.\n                $chatList.scrollTop($chatList[0].scrollHeight);\n            });\n\n            // Definition: Welcome 消息事件（自己可见）.\n            chatListCtrl.$watch(\"addSelfWelcomeMsg\", function () {\n                var msgHTML = '<div class=\"system-msg\"><i class=\"live-icon vip-color v-middle\"></i><span class=\"welcome v-middle\" style=\"color: #f25d8e\">' + UNAME + ' 老爷</span><span class=\"v-middle\">进入直播间</span><span id=\"close-vip-tip-link\" class=\"bili-link v-middle\" style=\"color: #4fc1e9; cursor: pointer;\">关闭提示</span></div>';\n                $chatList.append(msgHTML);\n\n                // 设置老爷关闭事件.\n                $(\"#close-vip-tip-link\").on(\"click\", function () {\n                    var popup = livePopup({\n                        title: \"关闭老爷提示\",\n                        content: \"点击确认，可以关闭自己进入直播间的提示，关闭后可在直播个人中心重新开启提示功能哦 (●′ω`●)~\",\n                        width: 300,\n                        onConfirm: function () {\n                            $.ajax({\n                                url: \"/i/ajaxSetVipViewStatus\",\n                                type: \"POST\",\n                                data: {\n                                    status: 0\n                                },\n                                timeout: 5000,\n                                dataType: \"JSON\",\n                                success: function (result) {},\n                                error: function (result) {}\n                            });\n                            popup.remove();\n                            popup = null;\n                        },\n                        onCancel: function () {\n                            popup.remove();\n                            popup = null;\n                        }\n                    });\n                });\n            });\n\n            // Definition: 系统消息事件.\n            chatListCtrl.$watch(\"addSysMsg\", function (json) {\n                console.log(\"Event: addSysMsg\");\n\n                // Definition: 聊天区域系统公告 By LancerComet at XX:XX, 2015.11.19 and continued at 15:02, 2015.11.20.\n                var contentNode = null;\n                var title = json.msg.substr(0, json.msg.indexOf(\"：\") + 1);\n                var content = json.msg.substr(json.msg.indexOf(\"：\") + 1, json.msg.length);\n\n                if (json.url.length < 1) {\n                    contentNode = content;\n                } else {\n                    contentNode = '<a href=\"' + json.url + '\" target=\"_blank\">' + content + '</a>'\n                }\n\n                var systemMsg = '<div class=\"announcement-container\">' +\n                    '<i class=\"live-icon announcement\"></i>' +\n                    '<div class=\"announcement-content\">' +\n                    '<p><span>' + title + \"</span>\" + contentNode + '</p>' +\n                    '</div>' +\n                    '</div>';\n                $chatList.append(systemMsg);\n                $chatList.scrollTop($chatList[0].scrollHeight);\n                contentNode = content = title = systemMsg = null;\n\n            });\n\n            // Definition: 添加踢出消息.\n            chatListCtrl.$watch(\"addKickoutMsg\", function (json) {\n                $chatList.append('<div class=\"system-msg\">用户 <span style=\"color: #aaa\">' + json.uname + '</span> 已被管理员踢出房间</div>');\n            });\n\n\n        })();\n\n        // Action: Lazy Init.\n        lazyInit(document.getElementById(\"chat-list-ctnr\"), chatListCtrl, function () {\n            lazyInit($(\"#chat-panels\")[0], chatListCtrl);\n            //fanMedalHover();\n            //userLevelHover();\n        });\n\n        // Definition: 弹幕点击面板逻辑函数.\n        function showDanmuPopup (event) {\n            var target = event.target || event.srcElement;\n\n            // Return when cilicking other elements.\n            if (!$(target).hasClass(\"msg-content\") && !$(target).hasClass(\"user-name\")) {\n                chatListCtrl.doms.danmuPopup.show = false;\n                return;\n            }\n\n            var $parent = $(target).parent();\n\n            // 显示面板.\n            chatListCtrl.doms.danmuPopup.show = true;\n\n            // 设置面板位置.\n            var absPosition = getAbsPosition($parent[0]);\n            chatListCtrl.doms.danmuPopup.left = absPosition.left + 150;\n            chatListCtrl.doms.danmuPopup.top = $($parent[0]).position().top + 170;\n\n            // 设置相关数据.\n            chatListCtrl.doms.danmuPopup.targetUID = chatListCtrl.data.clickedDanmu.uid = $parent.attr(\"data-uid\");\n            chatListCtrl.doms.danmuPopup.uname = $parent.attr(\"data-uname\");\n            chatListCtrl.data.clickedDanmu.msg = $parent.attr(\"data-msg\");\n            $parent = null;\n        }\n\n        // Definition: 弹幕点击面板关闭方法.\n        function hideDanmuPopup () {\n            $(\".chat-msg-ctrl-panel\").fadeOut(200, function () {\n                chatListCtrl.doms.danmuPopup.show = false;\n            });\n        }\n\n        // Definition: 弹幕屏蔽事件.\n        function forbidDanmu (event) {\n            liveQuickLogin();\n            var target = event.target || event.srcElement;\n            $.ajax({\n                url: \"http://live.bilibili.com/liveact/shield_user\",\n                type: 'POST',\n                data: {\n                    roomid: ROOMID,\n                    uid: chatListCtrl.data.clickedDanmu.uid,\n                    type: 1\n                },\n                dataType: \"json\",\n                success: function (result) {\n                    if (result.code != 0) {\n                        liveToast(target, result.msg, \"caution\");\n                        return;\n                    }\n                    liveToast(target, \"屏蔽成功，再也见不到 TA 了~ \" + randomEmoji.helpless(), \"success\");\n                    $(\"#player_object\")[0].addShieldUser(result.data.uid, result.data.uname);\n                },\n                error: function() {\n                    liveToast(target, \"网络不好，请稍后再试~ \" + randomEmoji.sad(), \"error\");\n                }\n            });\n        }\n\n        // Definition: 弹幕举报事件.\n        function reportDanmu () {\n            liveQuickLogin();\n            chatListCtrl.doms.danmuReportPanel.show = true;\n        }\n\n        // Definition: 弹幕举报请求函数定义.\n        function reportDanmuConfirm (event) {\n            var target = event.target || event.srcElement;\n            if (!chatListCtrl.data.clickedDanmu.reason) { liveToast(target, \"请输入正确的举报原因~\", true); target = null; return; }\n            $.ajax({\n                url: \"/liveact/dmreport\",\n                type: \"POST\",\n                data: {\n                    roomid: window.ROOMID,\n                    uid: chatListCtrl.data.clickedDanmu.uid,\n                    msg: chatListCtrl.data.clickedDanmu.msg,\n                    reason: chatListCtrl.data.clickedDanmu.reason\n                },\n                dataType: \"JSON\",\n                success: function (result) {\n                    if (result.code != 0) {\n                        liveToast(target, result.msg, \"caution\");\n                        return;\n                    }\n                    liveToast(target, \"已成功举报，请安心等待处理！\" + randomEmoji.happy(), \"success\");\n                    reportDanmuCancel();\n                },\n                error: function (result) {\n                    liveToast(target, \"举报失败，网络可能不稳定，请稍后再试，非常对不起 \" + randomEmoji.sad(), \"error\");\n                }\n            });\n        }\n\n        // Definition: 取消举报弹幕.\n        function reportDanmuCancel () {\n            chatListCtrl.doms.danmuReportPanel.out = true;\n            setTimeout(function () {\n                chatListCtrl.doms.danmuReportPanel.show = false;\n                chatListCtrl.doms.danmuReportPanel.out = false;\n                chatListCtrl.doms.danmuReportPanel.focus = false;\n                chatListCtrl.data.clickedDanmu.reason = \"\";\n            }, 380);\n        }\n\n        // 消息列表勋章hover提示\n        function fanMedalHover () {\n            $(\"#chat-list-ctnr\").on(\"mouseenter\", \".medal-icon\", function(event) {\n                event.preventDefault();\n                var parentOffset = $(this).offset();\n                var roomMainCtnrOffset = $(\".room-main-ctnr\").offset();\n                var scrollLeft = $(document).scrollLeft();\n                var $nowMedalInfo = $(this).find(\".medal-info\");\n                $nowMedalInfo.css({\n                    top: parentOffset.top - 30,\n                    left: parentOffset.left - scrollLeft - roomMainCtnrOffset.left\n                });\n            });\n        }\n\n        // 消息列表用户等级hover提示\n        function userLevelHover () {\n            $(\"#chat-list-ctnr\").on(\"mouseenter\", \".user-level-icon\", function(event) {\n                event.preventDefault();\n                var parentOffset = $(this).offset();\n                var roomMainCtnrOffset = $(\".room-main-ctnr\").offset();\n                var scrollLeft = $(document).scrollLeft();\n                var $nowUserLevelInfo = $(this).find(\".user-level-info\");\n                console.log(roomMainCtnrOffset.top);\n                $nowUserLevelInfo.css({\n                    top: parentOffset.top - 45,\n                    left: parentOffset.left - scrollLeft - roomMainCtnrOffset.left\n                });\n            });\n        }\n\n    });\n\n};\n\n", "/*\n *  Chat Area Controller By LancerComet at 16:27, 2015/12/24.\n *  # Carry Your World #\n *  ---\n *  排行榜区域 Avalon 视图控制器定义.\n */\n\nvar appConfig = require('../../../../../../common/app-config/app-config');\nvar lazyInit = require('../../../../../../common/functions/func-avalon-lazy-init/lazy-init');\n\n// Definition: 是否允许请求控制标识.\nvar checkAllow = {\n    giftTop: true,\n    fansRank: true,\n    admin: true,\n    shiningStar: true,\n    riceCake: true\n};\n\nmodule.exports = function (result, window) {\n    \"use strict\";\n\n    avalon.ready(function () {\n\n        // Definition: Rank List 控制器定义.\n        var rankListCtrl = avalon.define({\n            $id: \"rankListCtrl\",\n            chatSilent: false,  // 禁言状态.\n\n            // 排行榜节点对象相关数据.\n            ranklist: {\n                showRanklist: \"sevenRank\",  // 当前显示排行榜.\n                height: 100,\n                switchList: function (event) {\n                    var target = event.target || event.srcElement;\n                    rankListCtrl.ranklist.showRanklist = target.attributes[\"data-target\"].value;\n                },\n                allowCheck: function (panel) {\n                    rankListCtrl.ranklist.height = 100;  // 还原排行榜高度.\n                    //checkAllow[panel] = true;\n                }\n            },\n\n            // 七日投喂榜.\n            giftTop: {\n                // 排行列表数据.\n                dataList: result.data.GIFT_TOP || [],\n\n                // 检查最新送礼排行.\n                check: function () {\n                    if (!checkAllow.giftTop) {\n                        expandList(\"giftTop\");\n                        return;\n                    }\n                    checkAllow.giftTop = false;\n                    rankListCtrl.giftTop.request();\n                    expandList(\"giftTop\");\n                },\n\n                // 还原控制标识.\n                restore: function () {\n                    rankListCtrl.ranklist.allowCheck(\"giftTop\");\n                },\n\n                // 数据请求方法.\n                request: function (callback) {\n                    $.ajax({\n                        url: \"/gift/getTop?roomid=\" + window.ROOMID,\n                        type: \"GET\",\n                        dataType: \"JSON\",\n                        success: function (result) {\n                            if (result.code != 0) { return; }\n                            rankListCtrl.giftTop.dataList = result.data;\n                            callback && typeof callback === \"function\" && callback();\n                        },\n                        error: function (result) {\n                            typeof callback === \"function\" && callback();\n                        }\n                    })\n                }\n            },\n\n            // 粉丝排行榜.\n            fansRank: {\n                dataList: [],\n\n                check: function () {\n                    if (!checkAllow.fansRank) {\n                        expandList(\"fansRank\");\n                        return;\n                    }\n                    checkAllow.fansRank = false;\n                    rankListCtrl.fansRank.request();\n                    expandList(\"fansRank\");\n                },\n\n                restore: function () {\n                    rankListCtrl.ranklist.allowCheck(\"fansRank\");\n                },\n\n                request: function (callback) {\n                    $.ajax({\n                        url: \"/liveact/ajaxGetMedalRankList\",\n                        type: \"POST\",\n                        dataType: \"JSON\",\n                        data: {\n                            roomid: window.ROOMID\n                        },\n                        success: function (result) {\n                            if (result.code != 0) { return; }\n                            if (result.msg != 0 && result.msg !== \"\") {\n                                // 播主已开通粉丝勋章.\n                                $(\".rank-list.fans-rank\").attr(\"data-hinter\", \"投喂一个 B 坷垃，勋章就能戴回家！ ε=ε=ε=ε=(ノ≧∇≦)ノ\");\n                            }\n                            rankListCtrl.fansRank.dataList =  result.data;\n                            callback && typeof callback === \"function\" && callback();\n                        },\n                        error: function (result) {\n                            typeof callback === \"function\" && callback();\n                        }\n                    })\n                }\n            },\n\n            // 闪耀之星排行榜.\n            shiningStar: {\n                dataList: [],\n\n                check: function () {\n                    if (!checkAllow.shiningStar) {\n                        expandList(\"shiningStar\");\n                        return;\n                    }\n                    checkAllow.shiningStar = false;\n                    rankListCtrl.shiningStar.request();\n                    expandList(\"shiningStar\");\n                },\n\n                restore: function () {\n                    rankListCtrl.ranklist.allowCheck(\"shiningStar\");\n                },\n\n                request: function (callback) {\n                    $.ajax({\n                        url: \"/gift/star\",\n                        type: \"GET\",\n                        data: {\n                            uid: window.MASTERID,\n                            ts: Date.now()\n                        },\n                        dataType: \"JSON\",\n                        success: function (result) {\n                            if (result.code == 0) {\n                                rankListCtrl.shiningStar.dataList = result.data;\n                                callback && typeof callback === \"function\" && callback();\n                            }\n\n                        },\n                        error: function (result) {\n\n                        }\n                    })\n                }\n\n            },\n\n            //春节年糕排行榜\n            riceCake: {\n                dataList: [],\n\n                request: function () {\n                    $.ajax({\n                        url: \"/gift/cake\",\n                        type: \"GET\",\n                        data: {\n                            uid: window.MASTERID,\n                            ts: Date.now()\n                        },\n                        dataType: \"JSON\",\n                        success: function (result) {\n                            if (result.code == 0) {\n                                rankListCtrl.riceCake.dataList = result.data;\n                            }\n                        },\n                        error: function (result) {\n                            // ...\n                        }\n                    })\n                },\n\n                check: function () {\n                    rankListCtrl.ranklist.height = rankListCtrl.riceCake.dataList.length * 33;  // 设置排行榜高度.\n                },\n\n                restore : function () {\n                    rankListCtrl.ranklist.allowCheck(\"riceCake\");\n                }\n            },\n\n            // 房管列表.\n            admin: {\n                dataList: [],\n\n                check: function () {\n                    rankListCtrl.ranklist.height = rankListCtrl.admin.dataList.length * 33;  // 设置排行榜高度.\n                },\n\n                request: function () {\n                    $.ajax({\n                        url: \"/liveact/ajaxGetAdminList\",\n                        type: \"POST\",\n                        data: {\n                            roomid: ROOMID\n                        },\n                        dataType: \"JSON\",\n                        success: function (result) {\n                            if (result.code == 0) {\n                                rankListCtrl.admin.dataList = result.data;\n                            }\n                        },\n                        error: function (result) {\n                            // ...\n                        }\n                    })\n                },\n\n                restore: function () {\n                    rankListCtrl.ranklist.allowCheck(\"admin\");\n                }\n            }\n\n        });\n\n        // Definition: 更新投喂榜数据事件.\n        rankListCtrl.$watch(\"updateGiftTop\", function (data) {\n            console.log(\"Event: updateGiftTop\");\n            if (Object.prototype.toString.call(data) !== \"[object Array]\") {\n                consoleText.log(appConfig.consoleText.error + \"排行榜数据不合法.\");\n                return;\n            }\n            data.length > 0 ? rankListCtrl.giftTop.dataList = data : void(0);\n            data.length <= 3 ? checkAllow.giftTop = true : void(0);\n        });\n\n        // Definition: 更新闪耀之星排行榜.\n        rankListCtrl.$watch(\"updateShiningStar\", function (data) {\n            console.log(\"Event: updateShiningSTAR\");\n            if (Object.prototype.toString.call(data) !== \"[object Array]\") {\n                consoleText.log(appConfig.consoleText.error + \"排行榜数据不合法.\");\n                return;\n            }\n            data.length > 0 ? rankListCtrl.shiningStar.dataList = [] : void(0);\n        });\n\n        //Definition: 更新春节年糕排行榜\n        //rankListCtrl.$watch(\"updateRiceCake\", function (data) {\n        //    console.log(\"Event: updateRiceCake\");\n        //    if (Object.prototype.toString.call(data) !== \"[object Array]\") {\n        //        consoleText.log(appConfig.consoleText.error + \"排行榜数据不合法.\");\n        //        return;\n        //    }\n        //    data.length > 0 ? rankListCtrl.riceCake.dataList = data : void(0);\n        //    data.length <= 3 ? checkAllow.riceCake = true : void(0);\n        //});\n\n        lazyInit(document.getElementById(\"rank-list-ctnr\"), rankListCtrl);\n\n        // Definition: 扩展列表通用方法.\n        function expandList (listName) {\n            rankListCtrl.ranklist.height = rankListCtrl[listName].dataList.length * 32;\n        }\n\n    });\n};", "/*\n *  Super Gift By LancerComet at 11:52, 2016/1/11.\n *  # Carry Your World #\n *  ---\n *  连击礼物模块逻辑.\n *  移植自旧代码, 没有任何改动.\n *  此代码在 chat-list-ctnr 中被用作为 Avalon 事件.\n */\n\n\n// Definition: 连击礼物相关事件对象定义.\nvar superGift = {};\n\n// Definition: 连击礼物节点的父容器节点.\nvar $appendTarget = $(\".super-gift-ctnr\");\n\n// Definition: 模块设置.\nsuperGift.settings = {\n    showTime: 10000  // 连击礼物显示时间.\n};\n\n// Definition: 连击礼物节点构造函数.\nsuperGift.newGift = function (superGiftInfo, hitNum) {\n    var giftDom = document.createElement(\"div\");\n    giftDom.className = 'supergift supergift-' + superGiftInfo.giftId + ' gift-step-2 animated';\n    giftDom.setAttribute(\"data-gift-id\", superGiftInfo.id);\n    giftDom.innerHTML = '<img class=\"supergift-img gift-step-1 animated\" src=\"http://static.hdslb.com/live-static/images/gifts/gift-' + superGiftInfo.giftId +'.gif\">' +\n        '<div class=\"supergift-text\">' +\n        '<p class=\"supergift-text-sec gift-step-3 animated\"><span class=\"supergift-uname\">'+ superGiftInfo.uname +'</span><span class=\"supergift-action\">赠送'+ superGiftInfo.giftName +'</span><span class=\"supergift-num\">'+ superGiftInfo.num +'个</span></p></div>' +\n        '<img class=\"supergift-cross gift-step-4 animated\" src=\"http://static.hdslb.com/live-static/images/supergift/cross.png\"><p class=\"supergift-hitnum gift-step-6 animated\">'+ hitNum +'</p><p class=\"combo-text gift-step-5 animated\">combo</p>';\n\n    // 构造计时器.\n    setTimeout(function () {\n        $(giftDom).addClass('fadeOutLeft').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {\n            $(giftDom).remove();\n        });\n    }, superGift.settings.showTime);\n\n    this.create = giftDom;\n};\n\n// Definition: FFF 团连击礼物.\nsuperGift.fffGift = function (superGiftInfo, hitNum) {\n    var giftDom = document.createElement(\"div\");\n    giftDom.className = 'supergift supergift-' + superGiftInfo.giftId + ' gift-step-2 animated';\n    giftDom.setAttribute(\"data-gift-id\", superGiftInfo.id);\n    giftDom.innerHTML = '<div style=\"background-color: #9B5131\" class=\"supergift-img gift-step-1 animated\">' +\n        '<img src=\"http://static.hdslb.com/live-static/images/gifts/gift-13-fireball.png\" style=\"position: absolute; top: -20px; left: -10px;\">' +\n        '</div>' +\n        '<div class=\"supergift-text\">' +\n        '<p class=\"supergift-text-sec gift-step-3 animated\" style=\"color: #fff; margin-left: 10px; top: -3px;\"><span class=\"supergift-uname\" style=\"vertical-align: top; color: rgb(255, 232, 0);\">'+ superGiftInfo.uname +'</span>使用了大火球术！</p></div>' +\n        '<img class=\"supergift-cross gift-step-4 animated\" src=\"http://static.hdslb.com/live-static/images/supergift/cross.png\"><p class=\"supergift-hitnum gift-step-6 animated\">'+ hitNum +'</p><p class=\"combo-text gift-step-5 animated\">combo</p>';\n\n    // 构造计时器.\n    setTimeout(function () {\n        $(giftDom).addClass('fadeOutLeft').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {\n            giftDom.parentNode.removeChild(giftDom);\n        });\n    }, superGift.settings.showTime);\n\n    this.create = giftDom;\n};\n\n// 执行方法, 此方法在 SEND_GIFT 和送礼 AJAX 中执行.\nsuperGift.exec = function (data) {\n\n    // Action: 当礼物连击数为 0 的时候不属于连击礼物, 终止执行.\n    if (data[\"super\"] == 0) {\n        return false;\n    }\n\n    // Definition: 连击礼物唯一标识符与礼物信息.\n    var id = data.uid + \"_\" + data.giftId + \"_\" + data.num + \"_\" + data[\"super\"],\n        superGiftInfo = {  // 礼物的信息.\n            id: id,\n            uname: data.uname,\n            num: data.num,\n            giftName: data.giftName,\n            giftId: data.giftId\n        };\n\n    // 如果列表中超过三个礼物.\n    if($appendTarget.children().length >= 3){\n        $('.supergift:first-child', $appendTarget).remove();\n        $('.supergift', $appendTarget).addClass('moveUp').one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function() {\n            $(this).removeClass(\"moveUp\");\n        });\n    }\n\n    // Action: 新建礼物.\n    // 判断是否为 FFF 团大火球, 如果是大火球, 建立大火球礼物.\n    var newGift = null;\n    if (data.giftName === \"FFF\") {\n        newGift = new superGift.fffGift(superGiftInfo, data.super).create;\n    } else {\n        newGift = new superGift.newGift(superGiftInfo, data.super).create;\n    }\n    $('.supergift', $appendTarget).removeClass('gift-step-2 animated');\n    $appendTarget.append(newGift);\n\n};\n\nmodule.exports = superGift;", "/*\n *  Chat Area Intro File by LancerComet at 11:22, 2015/12/17.\n *  # Carry Your World #\n *  ---\n *\n *  描述:\n *  ---\n *  这是房间页聊天区主入口文件. (Browserify)\n *  请在此处引用编写好的模块文件, **切勿**在此文件中直接编写业务逻辑.\n *  使用 Browserify 对此文件进行打包将生成首页完整的 JavaScript 文件.\n *  Browserify 遵循 Common.JS 编写规范.\n *\n */\n\nmodule.exports = function (roomInfo) {\n\n    // 说明: 参数 roomInfo 为房间初始化后获得的数据.\n\n    // 模块引用.\n    // ===================\n    require('./components/rank-list/javascripts/rank-list')(roomInfo, window);  // 排行榜模块引用.\n    require('./components/chat-msg-list/chat-list-ctnr')();  // 聊天区域（弹幕列表）模块引用.\n    require(\"./components/chat-ctrl-panel/chat-ctrl-panel\")();  // 聊天区域控制面板控制器.\n    require('./components/chat-ctrl-panel/profile-ctrl/intro-javascripts')();  // 账号操作区域模块引用.（与上方控制器独立）\n    require(\"./components/bk-changer/bk-changer\")(window);  // 房间背景切换模块.\n\n};", "/*\n *  Live Room Gift Section Script Entry By LancerComet at 14:09, 2016.01.05.\n *  # Carry Your World #\n *  ---\n *  房间送礼节点逻辑入口文件.\n */\n\nmodule.exports = function () {\n    require(\"./javascripts/gift-section-ctrl\")(window);\n    require(\"./javascripts/gift-package-ctrl\")();\n};", "/*\n *  Gift Package at 18:08, 2016.01.06.\n *  ---\n *  道具包裹相关逻辑\n */\n\n//var lazyInit = require(\"lazyInit\");\nvar lazyInit = require('../../../../common/functions/func-avalon-lazy-init/lazy-init');\n//var liveToast = require(\"liveToast\");\nvar liveToast = require(\"../../../../common/components/live-widget/live-toast/live-toast\");\n//var randomEmoji = require(\"randomEmoji\");\nvar randomEmoji = require(\"../../../../common/functions/func-random-emoji/random-emoji\");\n\nvar liveQuickLogin = require('../../../../common/functions/func-live-quick-login/live-quick-login');\n\nmodule.exports = function () {\n    \"use strict\";\n    avalon.ready(function () {\n        var giftPackagelVM = avalon.define({\n            $id: \"giftPackageCtrl\",\n            giftPackageStatus: 0,  // 0: 没有道具 1: 包裹中有赠送的新道具 2:包裹里非新增道具\n            panelStatus: false,\n            giftPackageData: [],\n\n            // Toggle 道具包裹\n            toggleGiftPackage: function (event) {\n                event.stopPropagation();\n                liveQuickLogin();\n                if (!giftPackagelVM.panelStatus) {\n                    if (giftPackagelVM.giftPackageStatus == 1) {  // 有新道具，先打开新送道具面板\n                        openGiftPackageNewPanel();\n                    } else {\n                        openGiftPackagePanel();  // 否则直接打开包裹\n                    }\n                } else {\n                    closeGiftPackagePanel();\n                }\n            },\n\n            // 送礼面板（道具包裹）\n            giftSendPanel: {\n                giftData: {\n                    giftId: \"\",\n                    giftName: \"\",\n                    giftNum: 0,\n                    type: \"silver\",\n                    count: 1,\n                    bagId: 0\n                },\n                show: false,\n                out: false,\n                outTimeout: null,\n                open: openGiftSendPanel,\n                close: closeGiftSendPanel,\n                sendGift: sendGift\n            },\n\n            // 新收到的礼物面板\n            giftPackageNewPanel: {\n                data: [],\n                show: false,\n                out: false,\n                outTimeout: null,\n                open: openGiftPackageNewPanel,\n                close: closeGiftPackageNewPanel\n            },\n\n            // 阻止冒泡\n            stopPropagation: function (event) {\n                event.stopPropagation();\n            }\n        });\n\n        // 加入 avalon 初始化队列\n        lazyInit($(\"#gift-package-send-panel\")[0], giftPackagelVM, function () {\n            // 初始化道具包裹状态\n            getGiftPackageStatus(function (result) {\n                giftPackagelVM.giftPackageStatus = result.data.result;\n            });\n        });\n\n        lazyInit($(\"#gift-package-new-panel\")[0], giftPackagelVM);\n\n        // 关闭包裹面板\n        function closeGiftPackagePanel () {\n            $(\".gifts-package-panel\").fadeOut(200, function () {\n                giftPackagelVM.panelStatus = false;\n                $(document).off(\"click\", closeGiftPackagePanel);\n            });\n        }\n\n        // 打开包裹面板\n        function openGiftPackagePanel () {\n            getGiftPackage(function (result) {\n                giftPackagelVM.giftPackageData = result.data;\n                giftPackagelVM.panelStatus = true;\n            });\n            setTimeout(function () {\n                $(document).on(\"click\", closeGiftPackagePanel);\n            }, 1);\n        }\n\n        // 打开送礼面板\n        function openGiftSendPanel (giftId, giftName, giftNum, bigId) {\n            var sendPanel = giftPackagelVM.giftSendPanel;\n\n            sendPanel.giftData.giftId = giftId;\n            sendPanel.giftData.giftName = giftName;\n            sendPanel.giftData.giftNum = giftNum;\n            sendPanel.giftData.count = 1;\n            sendPanel.giftData.bagId = bigId;\n\n            giftPackagelVM.panelStatus = false;\n            sendPanel.show = true;\n        }\n\n        // 关闭送礼面板\n        function closeGiftSendPanel () {\n            var sendPanel = giftPackagelVM.giftSendPanel;\n            sendPanel.out = true;\n            sendPanel.outTimeout = setTimeout(function () {\n                sendPanel.out = false;\n                sendPanel.show = false;\n                sendPanel = null;\n            }, 380);\n        }\n\n        // 打开新送道具面板\n        function openGiftPackageNewPanel () {\n            var giftPackageNewPanel = giftPackagelVM.giftPackageNewPanel;\n            // 获取赠送的新道具数据\n            getSendGift(function (result) {\n                if (result.code == 0) {\n                    giftPackageNewPanel.data = result.data;\n                    giftPackageNewPanel.show = true;\n                }\n            });\n        }\n\n        // 关闭新送道具面板\n        function closeGiftPackageNewPanel () {\n            var giftPackageNewPanel = giftPackagelVM.giftPackageNewPanel;\n            giftPackageNewPanel.out = true;\n            giftPackageNewPanel.outTimeout = setTimeout(function () {\n                giftPackageNewPanel.out = false;\n                giftPackageNewPanel.show = false;\n                giftPackageNewPanel = null;\n                giftPackagelVM.giftPackageStatus = 2;\n                openGiftPackagePanel();  // 打开包裹\n            }, 380);\n        }\n\n        // 送礼事件\n        function sendGift (event) {\n            if (event.type === \"keyup\" && event.keyCode !== 13) { return; }\n\n            var element = event.target || event.srcElement;\n            var giftData = giftPackagelVM.giftSendPanel.giftData;\n            var num = parseInt(giftData.count, 10);\n\n            // 检测礼物数量是否为合法数字.\n            if (isNaN(num)) {\n                giftData.count = \"\";\n                liveToast(element, \"请填写正确的送礼数量 \" + randomEmoji.helpless(), true);\n                return;\n            }\n\n            giftPackagelVM.$fire(\"all!sendGift\", {\n                element: element,\n                type: \"package\",\n                data: {\n                    giftId: giftData.giftId,\n                    num: num,\n                    coinType: giftData.type,\n                    bagId: giftData.bagId\n                },\n                callback: function (result) {\n                    if (result.code == 0) {\n                        giftData.giftNum = result.data.remain;\n                        // 当 remain 为 0 时检查包裹状态并更新\n                        if (result.data.remain == 0) {\n                            getGiftPackageStatus(function (result) {\n                                giftPackagelVM.giftPackageStatus = result.data.result;\n                            });\n                        }\n                    }\n                }\n            });\n        }\n    });\n\n    /*\n     * 道具包裹接口\n     */\n\n    // 获取是否有赠送的新道具的状态\n    function getGiftPackageStatus (callback) {\n        $.ajax({\n            url: \"/giftBag/sendDaily\",\n            type: 'GET',\n            dataType: \"json\",\n            success: function (result) {\n                // 回调函数\n                callback && callback(result);\n            }\n        });\n    };\n\n    // 获取赠送的新道具数据\n    function getSendGift (callback) {\n        $.ajax({\n            url: \"/giftBag/getSendGift\",\n            type: 'GET',\n            dataType: \"json\",\n            success: function (result) {\n                // 回调函数\n                callback && callback(result);\n            }\n        });\n    };\n\n    // 获取道具包裹的数据\n    function getGiftPackage (callback) {\n        $.ajax({\n            url: \"/gift/playerBag\",\n            type: 'GET',\n            dataType: \"json\",\n            success: function (result) {\n                // 回调函数\n                callback && callback(result);\n            }\n        });\n    };\n\n};\n\n", "/*\n *  Gift Section Controller By LancerComet at 14:08, 2016.01.05.\n *  # Carry Your World #\n *  ---\n *  送礼节点控制器逻辑.\n */\n\nvar lazyInit = require('../../../../common/functions/func-avalon-lazy-init/lazy-init');\nvar avalonSetNum = require('../../../../common/functions/func-setnum-avalon/avalon-set-num');\nvar timestampShorter = require('../../../../common/functions/func-timestamp-shorter/timestamp-shorter');\nvar randomEmoji = require('../../../../common/functions/func-random-emoji/random-emoji');\nvar liveToast = require('../../../../common/components/live-widget/live-toast/live-toast');\nvar livePopup = require('../../../../common/components/live-widget/live-popup/live-popup');\nvar liveQuickLogin = require('../../../../common/functions/func-live-quick-login/live-quick-login');\n\nmodule.exports = function (window) {\n    \"use strict\";\n\n    avalon.ready(function () {\n\n        // Definition: 送礼节点控制器定义.\n        var giftCtrl = avalon.define({\n            $id: \"giftCtrl\",\n\n            // 账户金钱信息.\n            currency: {\n                silver: 0,\n                gold: 0\n            },\n\n            // 礼物信息面板.\n            giftInfoPanel: {\n                show: false,\n                out: false,\n                outTimeout: null,\n                mouseTimeout: null,\n\n                left: 0,\n                top: 0,\n                type: \"\",  // 当前鼠标悬停的礼物类型.\n\n                info: {\n                    giftId: \"\",\n                    title: \"\",\n                    content: \"\",\n                    effects: \"\",\n                    cost: \"\"\n                },\n\n                events: {\n                    in: function () {\n                        clearTimeout(giftCtrl.giftInfoPanel.outTimeout);\n                        clearTimeout(giftCtrl.giftInfoPanel.mouseTimeout);\n                    },\n                    out: hideGiftPanel\n                }\n            },\n\n            // 送礼面板.\n            giftSendPanel: {\n                show: false,\n                out: false,\n                outTimeout: null,\n                cost: \"\",\n                allowGold: false,\n                allowSilver: false,\n                disableInput: false,\n                close: closeGiftSendPanel\n            },\n\n            // 选择事件定义.\n            chooseGift: {\n                normal: normalGiftChoice,\n                flash: flashGiftChoice,\n                activity: activityGiftChoice\n            },\n\n            // 送礼事件相关数据定义.\n            sendGift: {\n                countSet: [10, 99, 188, 450, 520, 1314],\n\n                data: {\n                    giftId: \"\",\n                    giftName: \"\",\n                    type: \"silver\",\n                    count: 1\n                },\n\n                events: {\n                    setCount: setGiftCount,\n                    send: sendGift\n                }\n            },\n\n            // 显示兑换或充值面板.\n            exchange: function (panel) {\n                liveQuickLogin();  // 未登录用户提示登录\n                giftCtrl.$fire(\"all!showExchange\", panel);\n            }\n\n        });\n\n        // Definition: 货币更新事件.\n        giftCtrl.$watch(\"fillCurrency\", function (seeds) {\n            (seeds.gold !== null && seeds.gold !== undefined) && avalonSetNum(seeds.gold, giftCtrl.currency.gold, \"giftCtrl.currency.gold\");\n            (seeds.silver !== null && seeds.silver !== undefined) && avalonSetNum(seeds.silver, giftCtrl.currency.silver, \"giftCtrl.currency.silver\");\n        });\n\n        // Definition: 送礼请求事件.\n        giftCtrl.$watch(\"sendGift\", function (param) {\n\n            /*\n             *  @ param: {\n             *    element: Object,  // 送礼事件触发的节点, 将在 liveToast 中使用.\n             *    type: \"normal\" || \"package\",  // 普通礼物 || 道具包裹礼物\n             *    data: {\n             *        giftId: Number || String,\n             *        num: Number,  // 送礼数量.\n             *        coinType: \"silver\" || \"gold\",\n             *        bagId: Number,\n             *        callback: Function\n             *    }\n             *  }\n             */\n\n            // Definition: 设置送礼时间戳.\n            var timestamp = timestampShorter(Date.now());\n            window.giftTsHistory.length > 200 && window.giftTsHistory.splice(0, 1);  // 如果礼物时间戳记录数组长度大于 200 则裁剪.\n            window.giftTsHistory.indexOf(parseInt(timestamp, 10) < 0) && window.giftTsHistory.push(parseInt(timestamp, 10));  // 将最后送礼的时间戳推入记录数组.\n\n            // 判断普通礼物 & 道具包裹 送礼接口\n            var sendGiftUrl = \"\";\n            if (param.type == \"normal\") {\n                sendGiftUrl = \"/gift/send\";\n            } else if (param.type == \"package\") {\n                sendGiftUrl = \"/giftBag/send\";\n            }\n\n            // 送礼请求.\n            $.ajax({\n                url: sendGiftUrl,\n                type: \"POST\",\n                data: {\n                    giftId: param.data.giftId,\n                    roomid: ROOMID,\n                    ruid: MASTERID,\n                    num: param.data.num,\n                    coinType: param.data.coinType,\n                    Bag_id: param.data.bagId,\n                    timestamp: timestamp,\n                    rnd: DANMU_RND,\n                    token: $.cookie(\"LIVE_LOGIN_DATA\") || \"\"\n                },\n                dataType: \"JSON\",\n                success: function (result) {\n\n                    if (result.code == 0) {\n\n                        console.log(\"Send gifts successfully.\");\n\n                        // 更新瓜子数.\n                        giftCtrl.$fire(\"all!updateCurrency\", {\n                            gold: result.data.gold,\n                            silver: result.data.silver\n                        });\n\n                        // 如果是弹幕道具通知 Flash.\n                        result.data.data.giftType == 1 && $(\"#player_object\")[0].sendGift(result.data.data.giftId, result.data.data.num);\n\n                        // 如果获得勋章.\n                        if (result.data.data.newMedal == 1) {\n                            giftCtrl.$fire(\"all!newFansMedalNotice\", {\n                                medalId: result.data.data.medal.medalId,\n                                medalName: result.data.data.medal.medalName,\n                                medalLevel: result.data.data.medal.level\n                            });\n                        }\n\n                        console.log(result);\n                        // 获得新头衔\n                        if (result.data.data.newTitle == 1) {\n                            giftCtrl.$fire(\"all!newTitleNotice\", result.data.data.title);\n                        }\n\n                        // 本地添加送礼记录.\n                        giftCtrl.$fire(\"all!addGiftHistory\", result.data);\n\n                        // 连击礼物.\n                        giftCtrl.$fire(\"all!superGift\", result.data.data);\n\n                        // 更新投喂榜.\n                        giftCtrl.$fire(\"all!updateGiftTop\", result.data.data.top_list);\n\n                    }\n\n                    // 余额不足自动弹出相应弹窗.\n                    else if (result.code == -400 && result.msg == \"余额不足\") {\n                        giftCtrl.$fire(\"all!noSeed\");\n                        closeGiftSendPanel();\n                    }\n\n                    // Error Handler.\n                    else {\n                        liveToast(param.element, result.msg + \" \" + randomEmoji.sad(), \"caution\", true);\n                    }\n\n                    // Callback\n                    param.callback && param.callback(result);\n                },\n                error: function (result) {\n                    liveToast(param.element, randomEmoji.sad() + \" 送礼失败：\" + result.statusText + \" \" + randomEmoji.sad(), \"error\");\n                }\n            });\n\n        });\n\n        // Aciton: 初始化控制器.\n        lazyInit($(\"#gift-panel\")[0], giftCtrl, function () {\n\n            var giftPanel = giftCtrl.giftInfoPanel;\n\n            // Definition: 礼物显示信息面板 Hover 事件.\n            $(\"#gift-panel\").find(\".gifts-ctnr\")\n                .on(\"mouseenter\", \".gift-item\", function (event) {\n                    event.stopPropagation();\n                    clearTimeout(giftPanel.outTimeout);\n                    clearTimeout(giftPanel.mouseTimeout);\n\n                    var element = event.target || event.srcElement;\n\n                    // 防止 Hover 到角标节点导致面板位置与数据错误.\n                    if (!$(element).hasClass(\"gift-item\")) { return; }\n\n                    var giftId = $(element).attr(\"data-gift-id\"),\n                        title = $(element).attr(\"data-title\"),\n                        content = $(element).attr(\"data-desc\"),\n                        effects = $(element).attr(\"data-effect\"),\n                        type = $(element).parent().attr(\"data-type\"),\n                        position = $(element).position();\n\n                    giftPanel.show = true;\n                    giftPanel.left = position.left;\n                    giftPanel.top = position.top;\n                    giftPanel.type = type;\n\n                    giftPanel.info.giftId = giftId;\n                    giftPanel.info.title = title;\n                    giftPanel.info.content = content;\n                    giftPanel.info.effects = effects;\n\n                    var costs = {\n                        gold: parseInt($(element).attr(\"data-gold\"), 10),\n                        silver: parseInt($(element).attr(\"data-silver\"), 10)\n                    };\n\n                    var costHTML = \"\";\n                    if (costs.gold > 0) { costHTML += '<span class=\"cost-hint\"><i class=\"live-icon gold-seed vertical-top\"></i><span class=\"vertical-top\">' + costs.gold + '</span></span>' }\n                    if (costs.silver > 0) { costHTML += '<span class=\"cost-hint\"><i class=\"live-icon silver-seed vertical-top\"></i><span class=\"vertical-top\">' + costs.silver + '</span></span>' }\n                    giftPanel.info.cost = costHTML;\n\n                })\n                .on(\"mouseleave\", \".gift-item\", hideGiftPanel);\n\n            lazyInit($(\"#gift-send-panel\")[0], giftCtrl);\n\n        });\n\n        // Definition: 关闭礼物面板方法.\n        function hideGiftPanel (event) {\n            event.stopPropagation();\n            var giftPanel = giftCtrl.giftInfoPanel;\n            giftPanel.mouseTimeout = setTimeout(function () {\n                giftPanel.out = true;\n                giftPanel.outTimeout = setTimeout(function () {\n                    giftPanel.out = false;\n                    giftPanel.show = false;\n                    giftPanel = null;\n                }, 380);\n            }, 1);  // 鼠标移动延时, 为产品留的坑.（哪天说不定就礼物详情面板上要求鼠标 Hover.）\n        }\n\n        // Definition: 普通礼物选择事件.\n        function normalGiftChoice (event) {\n            chooseGiftCommonExec(event);\n        }\n\n        // Definition: 弹幕礼物选择事件.\n        function flashGiftChoice (event) {\n            chooseGiftCommonExec(event);\n        }\n\n        // Definition: 活动礼物选择事件.\n        function activityGiftChoice (event) {\n            // 春节年糕活动\n            if(event.target.className.indexOf(\"gift-18\") > 0) {\n                chooseGiftCommonExec(event);\n            }\n        }\n\n        // Definition: 选择礼物公用逻辑.\n        function chooseGiftCommonExec (event) {\n            var target = event.target || event.srcElement;\n\n            if (!$(target).hasClass(\"gift-item\")) {\n                target = null;\n                return;\n            }\n\n            var giftData = giftCtrl.sendGift.data;\n\n            // 复位数据.\n            giftData.count = 1;\n            giftData.type = \"silver\";\n            giftCtrl.giftSendPanel.allowGold = false;\n            giftCtrl.giftSendPanel.allowSilver = false;\n            giftCtrl.giftSendPanel.disableInput = false;\n\n            // 打开送礼面板.\n            giftCtrl.giftSendPanel.show = true;\n\n            // 设置送礼数据.\n            giftData.giftId = $(target).attr(\"data-gift-id\");\n            giftData.giftName = $(target).attr(\"data-title\");\n\n            // 如果要求禁用输入数量则禁用.\n            if ($(target).attr(\"data-custom_input\") == \"0\") {\n                giftCtrl.giftSendPanel.disableInput = true;\n            }\n\n            // 设置瓜子花费.\n            var costs = {\n                gold: parseInt($(target).attr(\"data-gold\"), 10),\n                silver: parseInt($(target).attr(\"data-silver\"), 10)\n            };\n            var costHTML = \"\";\n            if (costs.gold > 0) {\n                giftCtrl.giftSendPanel.allowGold = true;\n                costHTML += '<span class=\"cost-hint\"><i class=\"live-icon gold-seed vertical-top\"></i><span class=\"vertical-top\">' + costs.gold + '</span></span>'\n            }\n            if (costs.silver > 0) {\n                giftCtrl.giftSendPanel.allowSilver = true;\n                costHTML += '<span class=\"cost-hint\"><i class=\"live-icon silver-seed vertical-top\"></i><span class=\"vertical-top\">' + costs.silver + '</span></span>'\n            }\n\n            // 如果是金瓜子礼物则设置送礼类型为金瓜子.\n            giftData.type = giftCtrl.giftSendPanel.allowGold && !giftCtrl.giftSendPanel.allowSilver ? \"gold\" : \"silver\";\n\n            giftCtrl.giftSendPanel.cost = costHTML;\n\n            // 设置预设送礼数量.\n            giftCtrl.sendGift.countSet = $(target).attr(\"data-count_set\").split(\",\");\n        }\n\n        // Definition: 设置礼物数量.\n        function setGiftCount (event) {\n            var target = event.target || event.srcElement;\n            giftCtrl.sendGift.data.count = $(target).attr(\"data-count\");\n        }\n\n        // Definition: 关闭送礼面板.\n        function closeGiftSendPanel () {\n            var sendPanel = giftCtrl.giftSendPanel;\n            sendPanel.out = true;\n            sendPanel.outTimeout = setTimeout(function () {\n                sendPanel.out = false;\n                sendPanel.show = false;\n                sendPanel = null;\n            }, 380);\n        }\n\n        // Definition: 送礼事件.\n        function sendGift (event) {\n            liveQuickLogin();\n            if (event.type === \"keyup\" && event.keyCode !== 13) { return; }\n\n            var element = event.target || event.srcElement;\n            var giftData = giftCtrl.sendGift.data;\n            var num = parseInt(giftData.count, 10);\n\n            // 检测礼物数量是否为合法数字.\n            if (isNaN(num)) {\n                giftData.count = \"\";\n                liveToast(element, \"请填写正确的送礼数量 \" + randomEmoji.helpless(), true);\n                return;\n            }\n\n            giftCtrl.$fire(\"sendGift\", {\n                element: element,\n                type: \"normal\",\n                data: {\n                    giftId: giftData.giftId,\n                    num: num,\n                    coinType: giftData.type,\n                    bagId: 0\n                }\n            });\n\n        }\n\n    });\n\n};\n", "/*\n *  Header Section By LancerComet at 17:31, 2015/12/21.\n *  # Carry Your World #\n *  ---\n *  房间头部信息节点.\n */\n\nvar appConfig = require('../../../common/app-config/app-config');\nvar lazyInit = require(\"../../../common/functions/func-avalon-lazy-init/lazy-init\");\nvar livePopup = require('../../../common/components/live-widget/live-popup/live-popup');\nvar liveToast = require('../../../common/components/live-widget/live-toast/live-toast');\nvar liveQuickLogin = require('../../../common/functions/func-live-quick-login/live-quick-login');\nvar avalonSetNum = require('../../../common/functions/func-setnum-avalon/avalon-set-num');\nvar randomEmoji = require('../../../common/functions/func-random-emoji/random-emoji');\n\nmodule.exports = function (result, window) {\n\n    var headInfoCtrl = null;\n\n    // Definition: 头部信息节点控制器定义.\n    avalon.ready(function () {\n\n        window.ISATTENTION = parseInt(window.ISATTENTION, 10);\n\n        headInfoCtrl = avalon.define({\n            $id: \"headInfoCtrl\",\n\n            // 播主信息.\n            anchorInfo: {\n                UID: result.data.MASTERID,\n                nickname: result.data.ANCHOR_NICK_NAME,\n                level: result.data.USER_LEVEL.level,\n                rank: result.data.USER_LEVEL.rank,\n                nextScore: 0,\n                levelProgress: \"0%\"\n            },\n\n            // 房间信息.\n            roomInfo: {\n                title: result.data.ROOMTITLE,\n                area: result.data.AREAID,\n                liveStatus: result.data._status,\n                viewerCount: 0,\n                favourite: 0,\n                giftReceived: 0,\n                starRank: 0\n            },\n\n            // 播主信息悬浮面板.\n            anchorInfoPanel: {\n                allowRequest: true,\n                show: false,\n                out: false,\n                outTimeout: null,\n                outTimeout2: null,\n                loaded: false,\n                showFunc: function (event) {\n                    event.stopPropagation();\n                    var panel = headInfoCtrl.anchorInfoPanel;\n                    var element = event.target || event.srcElement;\n\n                    clearTimeout(panel.outTimeout);\n                    clearTimeout(panel.outTimeout2);\n                    panel.out = false;\n                    panel.show = true;\n\n                    if (panel.allowRequest) {\n                        $.ajax({\n                            url: \"/user/getMasterInfo\",\n                            type: \"POST\",\n                            data: {\n                                uid: window.MASTERID\n                            },\n                            dataType: \"JSON\",\n                            success: function (result) {\n                                panel.loaded = true;  // 隐藏进度条.\n\n                                if (result.code != \"REPONSE_OK\") {\n                                    liveToast(element, \"播主信息获取失败：\" + result.msg, \"caution\");\n                                    return;\n                                }\n\n                                headInfoCtrl.anchorInfo.level = result.data.master_level;\n                                headInfoCtrl.anchorInfo.rank = result.data.sort;\n                                headInfoCtrl.anchorInfo.nextScore = parseInt(result.data.upgrade_score, 10);\n\n                                var upLevelScore = parseInt(result.data.next_score, 10);\n\n                                panel.allowRequest = false;\n                                setTimeout(function () {\n                                    headInfoCtrl.anchorInfo.levelProgress = Math.floor((upLevelScore - headInfoCtrl.anchorInfo.nextScore) / upLevelScore * 100) + \"%\";\n                                    upLevelScore = null;\n                                }, 350);\n                            },\n                            error: function (result) {\n                                liveToast(element, \"播主信息获取失败：\" + result.statusText, \"error\");\n                                panel.loaded = true;  // 隐藏进度条.\n                            }\n                        });\n                    } else {\n                        panel.loaded = true;\n                    }\n\n                },\n                hideFunc: function () {\n                    var panel = headInfoCtrl.anchorInfoPanel;\n                    panel.outTimeout = setTimeout(function () {\n                        panel.out = true;\n                        panel.outTimeout2 = setTimeout(function () {\n                            panel.show = false;\n                            panel.out = false;\n                            panel.loaded = false;\n                            panel = null;\n                        }, 250);\n                    }, 300);\n                }\n            },\n\n            // 举报房间.\n            report: {\n                show: false,\n                out: false,\n                outTimeout: null,\n                reason: null,\n                imageLink: null,\n                permission: true,\n                statusText: \"您还没有选择图片.\",\n                submitBtn: $(\"#report-upload-image-btn\")[0],\n\n                // 打开举报面板.\n                openPanel: function () {\n                    liveQuickLogin();\n                    if (!headInfoCtrl.report.permission) { return; }\n                    headInfoCtrl.report.show = true;\n                    headInfoCtrl.report.permission = false;\n                },\n\n                // 确认举报.\n                confirm: function (event) {\n                    if (event.type === \"keyup\" && event.keyCode !== 13) { return; }\n                    if (!headInfoCtrl.report.imageLink || !headInfoCtrl.report.reason) {\n                        liveToast(headInfoCtrl.report.submitBtn, \"请提供举报理由与举报截图后再上传哦! \" + randomEmoji.happy());\n                        return;\n                    }\n\n                    $.ajax({\n                        url: \"/liveact/report_room\",\n                        type: \"POST\",\n                        data: {\n                            room_id: window.ROOMID,\n                            picUrl: headInfoCtrl.report.imageLink,\n                            reason: headInfoCtrl.report.reason\n                        },\n                        dataType: \"JSON\",\n                        success: function (result) {\n                            if (result.code != 0) {\n                                resultToast(result.msg);\n                                return;\n                            }\n                            liveToast(headInfoCtrl.report.submitBtn, \"您已成功举报, 感谢您的支持！\" + randomEmoji.happy(), \"success\");\n                            headInfoCtrl.report.cancel();\n                        },\n                        error: function (result) {\n                            resultToast(result.statusText);\n                        }\n                    });\n\n                    function resultToast (msg) {\n                        liveToast(headInfoCtrl.report.submitBtn, \"举报信息提交失败：\" + msg + \"，请您稍后再试或联系客服，实在抱歉 > <\", \"caution\");\n                    }\n                },\n\n                // 取消举报.\n                cancel: function () {\n                    headInfoCtrl.report.out = true;\n                    setTimeout(function () {\n                        headInfoCtrl.report.reason = null;\n                        headInfoCtrl.report.imageLink = null;\n                        headInfoCtrl.report.statusText = \"您还没有选择图片.\";\n                        headInfoCtrl.report.permission = true;\n                        headInfoCtrl.report.out = false;\n                        headInfoCtrl.report.show = false;\n                    }, 380);\n                },\n\n                // 选择举报图片.\n                selectImage: function () {\n                    $(\"#report-image\").click();\n                },\n\n                // 先行上传举报图片.\n                uploadImage: function () {\n                    var fileObject = $(\"#report-image\")[0].files[0];\n                    if (!fileObject) { return; }\n                    if (fileObject.type !== \"image/jpeg\" && fileObject.type !== \"image/jpg\" && fileObject.type !== \"image/png\") {\n                        liveToast(headInfoCtrl.report.submitBtn, \"请上传 PNG 或 JPG 的图片~ \" + randomEmoji.helpless());\n                        return;\n                    }\n                    if (fileObject && fileObject.size > 1048576) {\n                        liveToast(headInfoCtrl.report.submitBtn, \"图片请不要超过 1MB 哦! \" + randomEmoji.sad());\n                        return;\n                    }\n                    headInfoCtrl.report.statusText = \"图片上传中, 请稍后...\";\n                    var formData = new FormData();\n                    formData.append(\"fileUp\", fileObject);\n                    $.ajax({\n                        xhr: function () {\n                            var xhr = new window.XMLHttpRequest();\n                            xhr.upload.addEventListener(\"progress\", function (event) {\n                                headInfoCtrl.report.statusText = event.lengthComputable && \"上传中：\" + (event.loaded / event.total * 100) + \"%\";\n                                headInfoCtrl.report.statusText = event.lengthComputable && event.loaded / event.total === 1 && \"举报图片上传完毕, 您可以提交了! \" + randomEmoji.happy();\n                            }, false);\n                            return xhr;\n                        },\n                        url: \"/pic/upload\",\n                        type: \"POST\",\n                        data: formData,\n                        processData: false,\n                        contentType: false,\n                        success: function (result) {\n                            // result: <script>window.parent.uploadSuccess('http://x-img.hdslb.net/group1/M00/2A/11/oYYBAFaDPnaAIGzsAAFpWFacBJs468.jpg|http://x-img.hdslb.net/group1/M00/2A/11/oYYBAFaDPnaAIGzsAAFpWFacBJs468.jpg');</script>\n                            var imgLink = result.toString().match(/http:\\/\\/.*\\|/);\n                            if (imgLink) {\n                                headInfoCtrl.report.imageLink = imgLink[0].slice(0, imgLink[0].length - 1);\n                            } else {\n                                var str = \"请确保网络通畅与图片类型为 PNG 或 JPG后重试.\";\n                                liveToast($(\"#report-upload-image-btn\"), str, \"caution\");\n                                headInfoCtrl.report.statusText = str;\n                                headInfoCtrl.report.imageLink = null;\n                            }\n                        },\n                        error: function (result) {\n                            consoleText.log(appConfig.consoleText.error + \"举报图片上传失败:\");\n                            consoleText.log(result.statusText);\n                            liveToast(headInfoCtrl.report.submitBtn, \"图片上传失败, 请稍后重试: \" + result.statusText, \"caution\");\n                            headInfoCtrl.report.imageLink = null;\n                        }\n                    });\n                }\n            },\n\n            // 分享面板.\n            share: showSharePanel,\n\n            // 房间直播状态切换.（点击直播开关）\n            liveStatusSwitch: function () {\n                if (parseInt(ISANCHOR, 10) !== 1) { return; }\n\n                // 当房间是开启直播时.\n                if (window._status === \"on\") {\n                    headInfoCtrl.liveOffPanel.text = \"您确定关闭直播？\";\n                    headInfoCtrl.liveOffPanel.show = true;\n                } else {\n                    // 房间没有开启直播时.\n                    headInfoCtrl.$fire(\"liveStatus\", \"on\");\n                }\n            },\n\n            // 关闭直播面板.\n            liveOffPanel: {\n                show: false,\n                out: false,\n                outTimeout: null,\n                text: \"您确定关闭直播？\",\n                hide: function () {\n                    headInfoCtrl.liveOffPanel.out = true;\n                    clearTimeout(headInfoCtrl.liveOffPanel.outTimeout);\n                    headInfoCtrl.liveOffPanel.outTimeout = setTimeout(function () {\n                        headInfoCtrl.liveOffPanel.out = false;\n                        headInfoCtrl.liveOffPanel.show = false;\n                    }, 380);\n                }\n            },\n\n            // 关闭直播请求.\n            offLive: function () {\n                if (quizSystem.betStatus) {\n                    var popup = livePopup({\n                        title: \"当前竞猜尚未结束\",\n                        html: '<div class=\"popup-content-container\" style=\"margin: 30px; padding: 15px; border-radius: 10px; border: 1px dashed #F54178; color: #F54178; text-align: center; background-color: #FFE2E2;\"><h3 style=\"margin-bottom: 10px; font-weight: 400;\">当前竞猜尚未结束，您确定要关闭直播么？</h3><p>当您关闭直播后，请尽快在直播间或个人中心结算未结束的竞猜。若您在 5 分钟之内未进行结算，系统将强制流局并扣除您的信用值。</p></div>',\n                        button: {\n                            confirm: \"确认关闭\",\n                            cancel: \"取消\"\n                        },\n                        onConfirm: function () {\n                            headInfoCtrl.$fire(\"liveStatus\", \"off\");\n                            popup.remove();\n                            popup = null;\n                        }\n                    })\n                } else {\n                    headInfoCtrl.$fire(\"liveStatus\", \"off\");\n                }\n            },\n\n            // 关注功能.\n            attention: {\n                isAttend: window.ISATTENTION,  // 关注状态控制标识.\n                statusText: (window.ISATTENTION === 1 ? \"已关注\" : \"关注\"),\n                fansCount: result.data.FANS_COUNT || 0,\n                attend: function (event) {\n                    event.stopPropagation();\n                    liveQuickLogin();\n\n                    var element = event.target || event.srcElement;\n                    var type = window.ISATTENTION === 1 ? 0 : 1;\n\n                    $.ajax({\n                        url: \"/liveact/attention\",\n                        type: \"POST\",\n                        data: {\n                            uid: result.data.MASTERID,\n                            type: type\n                        },\n                        dataType: \"JSON\",\n                        success: function (result) {\n                            if (result.code != 0) {\n                                liveToast(element, result.msg + \" \" + randomEmoji.helpless());\n                                return;\n                            }\n                            window.ISATTENTION = type;\n                            headInfoCtrl.attention.isAttend = type;\n\n                            // 通知 Flash 房间关注结果.\n                            try {\n                                $(\"#player_object\")[0].attendStatus(type);\n                            } catch (tryErr) {\n                                // ...\n                            }\n\n                            changeStatusText();\n                            toast();\n                        },\n                        error: function (result) {\n                            liveToast(element, \"关注失败, 请稍后再试 \" + randomEmoji.sad(), \"caution\");\n                        },\n                        timeout: appConfig.appConfig.xhrTimeout\n                    });\n\n                    function changeStatusText () {\n                        if (parseInt(window.ISATTENTION, 10) === 1) {\n                            headInfoCtrl.attention.fansCount += 1;\n                            headInfoCtrl.attention.statusText = \"已关注\";\n                        } else {\n                            headInfoCtrl.attention.fansCount > 0 && headInfoCtrl.attention.fansCount--;\n                            headInfoCtrl.attention.statusText = \"关注\";\n                        }\n                    }\n\n                    function toast () {\n                        parseInt(window.ISATTENTION, 10) === 1 ? liveToast(element, \"感谢关注！ \" + randomEmoji.happy(), \"success\") : liveToast(element, \"已悄悄地取消~ \" + randomEmoji.helpless(), \"info\");\n                    }\n                },\n                mouseover: false,\n                mouseenter: function () {\n                    headInfoCtrl.attention.mouseover = true;\n                },\n                mouseleave: function () {\n                    headInfoCtrl.attention.mouseover = false;\n                }\n            },\n            roomEdit: function() {\n                headInfoCtrl.$fire(\"all!showRoomEditDialog\");\n            },\n            liveManage: function() {\n                headInfoCtrl.$fire(\"all!showLiveManageDialog\", { curTarget: \"liveManage\"});\n            },\n            blackManage: function() {\n                headInfoCtrl.$fire(\"all!showBlackDialog\");\n            }\n        });\n\n        // Definition: 房间直播状态更改事件.\n        // Usage: $fire(\"liveStatus\", \"on\" || \"off\")\n        headInfoCtrl.$watch(\"liveStatus\", function (status) {\n            // 开启直播间.\n            if (status === \"on\" || status === true) {\n                changeStatus(1, function () {\n                    headInfoCtrl.roomInfo.liveStatus = \"on\";\n                    headInfoCtrl.$fire(\"all!showStreamCode\");  // 当开启直播时显示直播码.\n                });\n                console.log(\"liveStatus: on\");\n            } else {\n                // 关闭直播.\n                changeStatus(0, function () {\n                    headInfoCtrl.roomInfo.liveStatus = \"off\";\n                    headInfoCtrl.liveOffPanel.hide();\n                });\n                console.log(\"liveStatus: off\");\n            }\n        });\n\n        // Definition: 房间直播状态按钮更变事件.\n        headInfoCtrl.$watch(\"liveStatusButton\", function (status) {\n            if (status === \"on\" || status === true) {\n                headInfoCtrl.roomInfo.liveStatus = \"on\";\n                console.log(\"liveStatus: on\");\n            } else {\n                headInfoCtrl.roomInfo.liveStatus = \"off\";\n            }\n        });\n\n        // Definition: 后台强行关闭直播间.\n        headInfoCtrl.$watch(\"liveCutOff\", function () {\n            if (UID != MASTERID) { return; }\n            changeStatus(0)\n        });\n\n        // Definition: 房间观看人数更改事件.\n        headInfoCtrl.$watch(\"setViewerCount\", function (value) {\n            if (isNaN(parseInt(value, 10))) {\n                throw new Error(appConfig.consoleText.error + \"房间人数变量数值类型错误, 必须为可转为数字的有效变量.\");\n            }\n            avalonSetNum(value, headInfoCtrl.roomInfo.viewerCount, \"headInfoCtrl.roomInfo.viewerCount\");\n        });\n\n        // Definition: 房间送礼数更新事件.\n        headInfoCtrl.$watch(\"giftReceived\", function (value) {\n            if (isNaN(parseInt(value, 10))) {\n                throw new Error(appConfig.consoleText.error + \"房间送礼数值类型错误, 必须为可转为数字的有效变量.\");\n            }\n            avalonSetNum(value, headInfoCtrl.roomInfo.giftReceived, \"headInfoCtrl.roomInfo.giftReceived\");\n        });\n\n        // Definition: 闪耀之星数据更新事件.\n        headInfoCtrl.$watch(\"shiningStarCount\", function (value) {\n            avalonSetNum(value, headInfoCtrl.roomInfo.starRank, \"headInfoCtrl.roomInfo.starRank\");\n        });\n\n        lazyInit(document.getElementById(\"head-info-panel\"), headInfoCtrl, function () {\n            lazyInit(document.getElementById(\"report-panel\"), headInfoCtrl);\n\n            // 设置送礼数量.\n            headInfoCtrl.$fire(\"giftReceived\", result.data.RCOST);\n        });\n\n    });\n\n    /* Definition goes below. */\n\n    // Definition: 直播状态更变函数.\n    function changeStatus (type, callback) {\n        if (window.ISANCHOR !== 1) {\n            callback && callback();\n        } else {\n            // type: 0: 关闭 || 1: 开启\n            if (type === 0) { headInfoCtrl.liveOffPanel.text = \"女儿祈祷中……\"; }\n            request();\n        }\n\n        function request () {\n            $.ajax({\n                url: \"/liveact/live_status_mng\",\n                type: \"POST\",\n                data: {\n                    status: type,\n                    roomid: ROOMID\n                },\n                dataType: \"JSON\",\n                timeout: appConfig.appConfig.xhrTimeout,\n                success: function (result) {\n                    if (result.code != 0) {\n                        livePopup({\n                            title: \"开启直播失败\",\n                            html: \"<p>直播开启失败，请稍后再试，如还有问题，请联系客服，真的很抱歉 > <</p><p>Detail: \" + result.msg + \"</p>\",\n                            type: \"info\"\n                        });\n                        return;\n                    }\n                    window._status = type === 1 ? \"on\" : \"off\";  // 更新房间直播状态.\n                    callback && callback();\n                },\n                error: function (result) {\n                    livePopup({\n                        title: \"开启直播失败\",\n                        html: \"<p>竞猜开启失败，请稍后再试，如还有问题，请联系客服，真的很抱歉 > <</p><p>Detail: \" + result.statusText + \"</p>\",\n                        type: \"info\"\n                    });\n                }\n            });\n        }\n\n    }\n\n    // Definition: 分享面板.\n    var sharePanel = null;\n    var qrCode = null;\n    function showSharePanel () {\n        var URL = \"http://static.hdslb.com/live-static/libs/\";\n\n        if (!window.QRCode || !window.ZeroClipboard) {\n            $.when(\n                !window.QRCode && $.getScript(URL + \"qr-code/qrcode.min.js\"),\n                !window.ZeroClipboard && $.getScript(URL + \"zero-clipboard/ZeroClipboard.min.js\")\n            ).done(shareExec);\n        } else {\n            shareExec();\n        }\n\n        function shareExec () {\n\n            if (sharePanel) {\n                sharePanel.open();\n            } else {\n\n                // Definition: Copy Data.\n                var roomCopyData = 'http://live.bilibili.com/' + window.ROOMURL;\n                var flashCopyData = 'http://static.hdslb.com/live-static/swf/LivePlayerEx_1.swf?room_id=' + window.ROOMID + '&cid=' + window.ROOMID + '&state=LIVE';\n\n                // Definition: 分享面板结构.\n                var panelHTML = '<div class=\"share-panel clear-float\" style=\"padding-top: 10px; height: 80px\">' +\n                    '<div class=\"left-part float-left\">' +\n                    '<div class=\"room-link\">' +\n                    '<span class=\"dp-inline-block\" style=\"width: 75px\">直播间地址：</span><input type=\"text\" id=\"share-room-link\" class=\"live-input\" readonly aria-readonly=\"true\" value=\"' + roomCopyData + '\"><button id=\"share-room-copy\" class=\"live-btn default\" data-clipboard-text=\"' + roomCopyData + '\">复制</button>' +\n                    '</div>' +\n                    '<div class=\"flash-link\" style=\"margin-top: 16px\">' +\n                    '<span class=\"dp-inline-block\" style=\"width: 75px\">Flash 地址：</span><input type=\"text\" id=\"share-flash-link\" class=\"live-input\" readonly aria-readonly=\"true\" value=\"' + flashCopyData + '\"><button id=\"share-flash-copy\" class=\"live-btn default\" data-clipboard-text=\"' + flashCopyData + '\">复制</button>' +\n                    '</div>' +\n                    '</div>' +\n                    '<div class=\"right-part p-relative float-right\" style=\"top: -25px;\">' +\n                    '<p class=\"text-center\" style=\"margin: 5px\">扫码分享</p>' +\n                    '<div id=\"share-qr-code\" style=\"width: 70px; height: 70px; padding: 3px; border: 1px solid #4fc1e9; border-radius: 5px\"></div>' +\n                    '</div>' +\n                    '<div class=\"external-link\">' +\n                    '<div id=\"share-qzone\" class=\"link share-btn qzone\"></div>' +\n                    '<div id=\"share-weibo\" class=\"link share-btn weibo\"></div>' +\n                    '</div>' +\n                    '</div>';\n\n                sharePanel = livePopup({\n                    title: \"喊小伙伴一起来看\",\n                    html: panelHTML,\n                    type: \"info\",\n                    button: false,\n                    width: 450,\n                    initFunc: function () {\n\n                        // Action: 生成 QR 码.\n                        !qrCode ? qrCode = new QRCode($(\"#share-qr-code\")[0], {\n                            text: roomCopyData,\n                            width: 70,\n                            height: 70\n                        }) : void(0);\n\n\n                        var roomCopy = new ZeroClipboard($(\"#share-room-copy\")[0]);\n                        roomCopy.on(\"ready\", function (readyEvent) {\n                             //alert( \"ZeroClipboard SWF is ready!\" );\n                            roomCopy.on(\"aftercopy\", function (event) { liveToast($(\"#share-room-copy\")[0], \"复制成功，快去分享吧！\" + randomEmoji.happy(), \"success\", true); });\n                        });\n\n                        var flashCopy = new ZeroClipboard($(\"#share-flash-copy\")[0]);\n                        flashCopy.on(\"ready\", function (readyEvent) {\n                            //alert( \"ZeroClipboard SWF is ready!\" );\n                            flashCopy.on(\"aftercopy\", function (event) { liveToast($(\"#share-flash-copy\")[0], \"复制成功，快去分享吧！\" + randomEmoji.happy(), \"success\", true); });\n                        });\n\n                    }\n                });\n\n                // Action: 绑定外部分享事件.\n                var shareData = {\n                    url: window.location.href,\n                    title: ROOMTITLE + '的直播间',\n                    pic: '',\n                    nickname: ANCHOR_NICK_NAME,\n                    desc: ROOMTITLE + '的直播间',\n                    summary: ' ',\n                    shortTitle: document.title,\n                    searchPic: false\n                };\n\n                // QZone 分享.\n                $(\"#share-qzone\").off(\"click\").on(\"click\", function () {\n                    openShareWindow('http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?', {\n                        url: shareData.url || \"\",\n                        showcount: 1,\n                        desc: shareData.desc || \"\",\n                        summary: shareData.summary || \"\",\n                        title: '#哔哩哔哩生放送#　' + (shareData.weiboTag || \"\") + (shareData.title || \"\") + '　播主：' + (shareData.nickname || \"\") + '，正在哔哩哔哩进行直播，还不快来一起嗨！！',\n                        site: '哔哩哔哩',\n                        pics: shareData.pic || \"\",\n                        style: '203',\n                        width: 98,\n                        height: 22\n                    });\n                });\n\n                // 微博分享.\n                $(\"#share-weibo\").off(\"click\").on(\"click\", function () {\n                    openShareWindow('http://service.weibo.com/share/share.php?', {\n                        url: shareData.url,\n                        type: '3',\n                        count: '1',\n                        /**是否显示分享数，1显示(可选)*/\n                        appkey: shareData.appkey && shareData.appkey.weibo ? shareData.appkey.weibo : '2841902482',\n                        /**您申请的应用appkey,显示分享来源(可选)*/\n                        title: '#哔哩哔哩生放送#　' + (shareData.weiboTag || \"\") + (shareData.title || \"\") + '　播主：' + (shareData.nickname || \"\") + '，正在哔哩哔哩进行直播，还不快来一起嗨！！',\n                        /**分享的文字内容(可选，默认为所在页面的title)*/\n                        pic: shareData.pic || \"\",\n                        /**分享图片的路径(可选)*/\n                        searchPic: shareData.searchPic === false ? false : true,\n                        ralateUid: '',\n                        /**关联用户的UID，分享微博会@该用户(可选)*/\n                        language: 'zh_cn',\n                        /**设置语言，zh_cn|zh_tw(可选)*/\n                        rnd: new Date().valueOf()\n                    });\n                });\n\n            }\n        }\n    }\n\n    // Definition: 分享公共函数.\n    function openShareWindow (base, param) {\n        var temp = [];\n        for (var p in param) {\n            temp.push(p + '=' + encodeURIComponent(param[p] || ''));\n        }\n        var _u = base + temp.join('&');\n        window.open(_u, '', 'width=700, height=680, top=0, left=0, toolbar=no, menubar=no, scrollbars=no, location=yes, resizable=no, status=no');\n        return false;\n    }\n\n};\n", "/*\n *  Bilibili Room Sidebar Left Intro at 12:18, 2015.12.21.\n *  ---\n *\n *  描述：\n *  ---\n *  本文件为直播房间页面 Sidebar Left JS 入口文件.\n *  本文件不编写任何逻辑, 仅做引用.\n *\n *  使用：\n *  ---\n *  房间左边栏打开／关闭\n *  VM.$fire(\"all!toggleRoomSidebarLeft\");\n *\n *  房间左边栏打开\n *  VM.$fire(\"all!toggleRoomSidebarLeft\", true);\n *\n *  房间左边栏关闭\n *  VM.$fire(\"all!toggleRoomSidebarLeft\", false);\n *\n */\n\nmodule.exports = function () {\n    var roomSidebarLeftVM = require(\"./javascripts/sidebar-ctrl\")();\n};", "/*\n *  Sidebar Avalon Controller transferred By LancerComet at LancerComet at 10:48, 2015/12/22.\n *  Originally By Felix.\n *  # Carry Your World #\n *  ---\n *  左侧边栏控制器定义.\n */\n\nvar wish = require(\"../../wish/intro.js\")();\nrequire('perfect-scrollbar/jquery')(window.jQuery);\n\n\n// Definition: 视图控制器对象. 提到外面以使得函数引用.\nvar roomSidebarLeftVM = null;\n\nmodule.exports = function () {\n    \"use strict\";\n\n    // Definition: 左侧侧栏控制器定义.\n    roomSidebarLeftVM = avalon.define({\n        $id: \"roomSidebarLeftCtrl\",\n        newTask: false,  // 新任务状态控制标识, 当为 true 时, 我的任务按钮添加 .splashing 并开始呼吸闪烁.\n        roomSidebarLeftStatus: true,  // 左侧侧栏展开状态控制标识.\n\n        // 打开关闭 Sidebar Left\n        toggleSidebarLeft: function () {\n            // 切换面板开关状态\n            roomSidebarLeftVM.roomSidebarLeftStatus = !roomSidebarLeftVM.roomSidebarLeftStatus;\n        },\n\n        // 打开绘马祈愿面板.\n        clickWish: function() {\n            wish.show();\n        }\n\n    });\n\n    // 监视房间左边栏展开状态属性\n    roomSidebarLeftVM.$watch(\"roomSidebarLeftStatus\", function (status) {\n        status ? sideBarOpen() : sideBarClose();\n    });\n\n    // 监视 toggleRoomSidebarLeft，通过 fire 来控制房间左边栏状态.（左侧侧栏切换事件.）\n    roomSidebarLeftVM.$watch(\"toggleRoomSidebarLeft\", function (status) {\n        // 如果传的 status 参数是布尔值, 则直接操作房间侧边栏状态, 否则切换面板开关状态\n        roomSidebarLeftVM.roomSidebarLeftStatus = typeof status === \"boolean\" ? status : !roomSidebarLeftVM.roomSidebarLeftStatus;\n    });\n\n\n    return roomSidebarLeftVM;\n};\n\n$(function() {\n    $(\".room-left-sidebar\").find(\".main-ctnr\").perfectScrollbar();  // 初始化自定义滚动条\n    setTimeout(leftSidebarStatus, 500);\n});\n\n\n/* Definition goes below. */\n\n// Definition: 左侧侧栏状态监测函数.\n// 在进入页面时会在 localStorage 中存放一个时间戳、是否为今日第一次登录、侧栏状态三个控制标识.\nfunction leftSidebarStatus () {\n\n    // Error Handler.\n    if (!localStorage) { return; }\n\n    // Definition: 当前页面访问时间.\n    var visitTime = Date.now();\n\n    // Definition: 上次访问记录的时间.\n    var lastVisitTime = localStorage.getItem(\"lastVisitTime\");\n\n    // 如果没有上次访问记录时间（第一次访问）, 设置上次访问时间为当前时间并强制打开侧栏.\n    // 如果本次访问距离上次访问时间超过 24 小时, 更新上次访问时间并打开侧栏.\n    if (!lastVisitTime || visitTime - lastVisitTime >= 86400000) {\n        setVisitTime(visitTime);\n        sideBarOpen();\n        return;\n    }\n\n    // 判断用户最后的侧栏状态并做出动作.\n    var sidebarStatus = localStorage.getItem(\"sidebarStatus\");\n    if (sidebarStatus === \"open\") { sideBarOpen() } else { sideBarClose() }\n\n    visitTime = null;\n    sidebarStatus = null;\n\n}\n\n// Definition: 设置最后访问时间.\nfunction setVisitTime (visitTime) {\n    localStorage.setItem(\"lastVisitTime\", visitTime);\n}\n\n// Definition: 左侧侧栏开启函数.\nfunction sideBarOpen () {\n    $(\".body-container\").addClass(\"sidebar-left-open\");\n    localStorage.setItem(\"sidebarStatus\", \"open\");\n    roomSidebarLeftVM.roomSidebarLeftStatus = true;\n}\n\n// Definition: 左侧侧栏关闭函数.\nfunction sideBarClose () {\n    $(\".body-container\").removeClass(\"sidebar-left-open\");\n    localStorage.setItem(\"sidebarStatus\", \"closed\");\n    roomSidebarLeftVM.roomSidebarLeftStatus = false;\n}\n", "/*\n *  Bilibili Live Room My Attention at 12:04, 2015.12.23.\n *  ---\n *\n *  描述：\n *  ---\n *  本文件为直播房间页面我的关注模块 JS 入口文件.\n *  本文件不编写任何逻辑, 仅做引用.\n */\n\nmodule.exports = function () {\n    require(\"./javascripts/my-attention.js\")();  // 我的关注\n};", "/*\n *  Bilibili Live Room My Attention at 12:11, 2015.12.23.\n *  ---\n *\n *  描述：\n *  ---\n *  我的关注面板相关逻辑\n *\n */\n\nrequire('perfect-scrollbar/jquery')($);\nvar liveQuickLogin = require('../../../../common/functions/func-live-quick-login/live-quick-login');\n\n// 房间页我的关注模块\nmodule.exports = function () {\n    var heartBeatTimer = null,\n        FEED_HEARTBEAT = 0,\n        FEED_LIST_PAGER = 1;\n\n    // 我的关注面板 VM\n    var attentionVM = avalon.define({\n        $id: \"myAttentionCtrl\",\n        open: false,\n        list: [],\n        hasMore: false,\n        feedMode: 1,\n        count: 0,\n\n        // 设置是否提醒\n        setFeedMode: function () {\n            attentionVM.feedMode = (attentionVM.feedMode == 1)  ? 0 : 1;\n            $.ajax({\n                url: \"/feed/on/\",\n                data: {\n                    open: attentionVM.feedMode\n                },\n                type: \"POST\",\n                dataType: \"JSON\",\n                success: function (result) {\n                    attentionVM.feedMode = result.data.open;\n                }\n            });\n        },\n\n        // 关注列表项渲染完成\n        listItemsReady: function () {\n            var $panel = $(this).parent(\".my-attention-body\");\n            // 更新自定义滚动条状态\n            $panel.perfectScrollbar(\"update\");\n        },\n\n        // 跳转至所有关注\n        readMore: function () {\n            liveQuickLogin();\n            window.open('/i/following', '_blank');\n        }\n    });\n\n    // 设置 Cookie\n    var setAttentionCookie = function(data) {\n        var now = new Date(),\n            expiresDate = new Date(now.getTime() + 60 * 1000),\n            dataString = JSON.stringify(data);\n\n        $.cookie(\"attentionData\", dataString, {\n            expires: expiresDate\n        });\n\n    };\n\n    // 更新数据\n    var changeData = function (result) {\n\n        FEED_HEARTBEAT = result.data.hb;\n        attentionVM.feedMode = result.data.open;\n\n        if (result.code == 0) {\n            attentionVM.count = result.data.count;\n            if (result.data.open && result.data.has_new) {  // 提醒开关开启 && 有新开播\n                FEED_LIST_PAGER = 1;\n                attentionVM.open = true;\n                attentionVM.$fire(\"all!toggleRoomSidebarLeft\", true);\n                getFeedList();\n            }\n        } else {\n            clearInterval(heartBeatTimer);\n        }\n    };\n\n    // 心跳相关逻辑\n    var heartBeat = function () {\n        $.ajax({\n            url: \"/feed/heartBeat/heartBeat\",\n            data: {\n                hb: FEED_HEARTBEAT\n            },\n            type: \"POST\",\n            dataType: \"JSON\",\n            cache: false,\n            success: function (result) {\n                changeData(result);\n                setAttentionCookie(result);\n            }\n        });\n\n    };\n\n    // 发送心跳 & 每 60 秒发送一次心跳\n    heartBeat();\n    // 判断浏览器是否支持 WebSocket，支持则接收服务器通知，否则计时器发送心跳 window.WebSocket\n    if (false){\n        var client = new MyClient({\n            notify: function() {\n                heartBeat();\n            }\n        });\n    } else {\n        // 每60秒，发一次心跳\n        heartBeatTimer = setInterval(function () {\n            var attentionData = $.cookie(\"attentionData\"),\n                attentionDataJSON;\n\n            if (attentionData) {\n                attentionDataJSON = $.parseJSON(attentionData);\n                changeData(attentionDataJSON);\n            } else {\n                heartBeat();\n            }\n        }, 1000 * 60);\n    }\n\n    // 加载开播房间列表\n    var getFeedList = function () {\n        $.ajax({\n            url: \"/feed/getList/\" + FEED_LIST_PAGER,\n            type: \"POST\",\n            dataType: \"JSON\",\n            cache: false,\n            success: function (result) {\n                var $panel = $(\"#room-my-attention .my-attention-body\");\n                // 加载第一页数据时重置 list 数组中的数据，否则将数据向 list 中追加\n                if (FEED_LIST_PAGER == 1) {\n                    $panel.scrollTop(0);\n                    attentionVM.list = result.data.list;\n                } else {\n                    attentionVM.list = attentionVM.list.concat(result.data.list);\n                }\n\n                // 如果本次加载条目总数小于 10, 则把 hasMore 设置为 false\n                if (result.data.list.length < 10) {\n                    attentionVM.hasMore = false;\n                } else {\n                    attentionVM.hasMore = true;\n                }\n            }\n        });\n    };\n\n    getFeedList();\n\n    $(function() {\n        // 初始化自定义滚动条\n        var $panel = $(\"#room-my-attention .my-attention-body\");\n        $panel.perfectScrollbar();\n\n        // Feed列表滚动到底加载新项目\n        $panel.on('ps-y-reach-end', function () {\n            if (attentionVM.hasMore) {\n                FEED_LIST_PAGER++;\n                getFeedList();\n            }\n        });\n    });\n}\n\n", "/*\n *  Quiz System Intro File By LancerComet at 10:40, 2015/12/17.\n *  # Carry Your World #\n *  ---\n *  竞猜系统入口文件.\n *\n */\n\nmodule.exports = function () {\n    require(\"./javascripts/quiz-protocol\")(window);  // 竞猜广播方法扩充.\n    require(\"./javascripts/quiz-avalon-ctrl\")(window, window.avalon);  // 竞猜节点控制器.\n};\n", "/*\n *  Quiz Avalon Controller By LancerComet at 14:06, 2015/12/18.\n *  # Carry Your World #\n *  ---\n *  竞猜系统 Avalon 控制器.\n *\n */\n\nvar appConfig = require('../../../../common/app-config/app-config');\nvar avalonSetNum = require('../../../../common/functions/func-setnum-avalon/avalon-set-num');\nvar lazyInit = require(\"../../../../common/functions/func-avalon-lazy-init/lazy-init\");\nvar liveToast = require('../../../../common/components/live-widget/live-toast/live-toast');\nvar randomEmoji = require(\"../../../../common/functions/func-random-emoji/random-emoji\");\nvar livePopup = require('../../../../common/components/live-widget/live-popup/live-popup');\n\n// Definition: 本模块用到的计时器对象.\nvar timeouts = {\n    residentCountChk: null\n};\n\nmodule.exports = function (window, avalon, undefined) {\n    \"use strict\";\n\n    // Definition: 竞猜全局变量设置.\n    // 用于外部通信.\n    window.quizSystem = {\n        betStatus: false  // 竞猜状态, 默认设置为 false.\n    };\n\n    // 在 Avalon 准备完毕后定义控制器.\n    avalon.ready(quizCtrlInit);\n\n    // Definition: 竞猜控制器初始化函数.\n    function quizCtrlInit () {\n\n        // Definition: 竞猜控制器定义.\n        var quizCtrl = avalon.define({\n            $id: \"quizCtrl\",\n\n            // 竞猜信息定义.\n            quiz: {\n                betId: -1,  // 竞猜 ID.\n                betStatus: false,  // 当前是否开启了竞猜.\n                disabled: false,  // 竞猜禁止操作.\n\n                // 竞猜题目信息.\n                info: {\n                    id: null,  // 竞猜 ID, 同上.\n                    uid: null,  // 竞猜播主的 UID.\n                    question: \"--\",  // 竞猜题目.\n                    a: \"--\",  // 竞猜答案 A.\n                    b: \"--\",  // 竞猜答案 B.\n                    answer: null,  // 竞猜最终选择答案.\n                    status: null,  // 竞猜状态.\n                    update_time: null  // 竞猜状态最后更新时间.\n                },\n\n                // 竞猜答案信息.\n                answerInfo: {\n                    gold: { a: {}, b: {} },\n                    silver: { a: {}, b: {} }\n                },\n\n                // 坐庄数据信息.（供坐庄发送请求用.）\n                beResidentData: {\n                    answer: \"\",  // \"a\" || \"b\"\n                    currencyType: \"silver\",  // 货币类型, 不可更改.\n                    odds: \"\",  // 坐庄倍率.\n                    oddsChk: function (event) {\n                        var target = event.target || event.srcElement;\n                        var odds = parseFloat(quizCtrl.quiz.beResidentData.odds);\n                        if (isNaN(odds)) {\n                            liveToast(target, \"手滑了吧~ 只能是数字喔~ \" + randomEmoji.helpless());\n                            quizCtrl.quiz.beResidentData.odds = \"\";\n                            return;\n                        }\n                        clearTimeout(quizCtrl.quiz.beResidentData.oddsChkTimeout);\n                        quizCtrl.quiz.beResidentData.oddsChkTimeout = setTimeout(function () {\n                            if (odds < 0.1 || odds > 9.9) {\n                                liveToast(target, \"倍率要在 0.1 到 9.9 之间喔~ \" + randomEmoji.helpless());\n                                quizCtrl.quiz.beResidentData.odds = \"\";\n                            }\n                        }, 10);\n                    },\n                    oddsChkTimeout: null,\n                    residentCount: \"\"  // 坐庄底金.\n                },\n\n                // 竞猜下注购买信息.\n                betBuyData: {\n                    bankerId:\"\",\n                    buyCount : \"\",\n                    maxBuyCount: 0,  // 可购买最大注数, 每次弹出面板后更新.\n                    buyIncome: 0  // 购买当前注数后获得利润, 由上方计算而出.\n                },\n\n                // 竞猜结算信息.\n                quizCheckoutData: {\n                    choicedAnswer: \"\"\n                },\n\n                permission: false,  // 当前房间是否拥有竞猜开启权限.\n                allowNewQuiz: false,  // 当前房间是否允许开启新竞猜.\n                quizJoined: false,  // 当前登陆账号是否已参加竞猜. 将用在获奖结果请求进行判断, 没有参与竞猜的账号在结算时不发送请求.\n                initFinished: false  // 初始化状态标识符.\n            },\n\n            // 账号信息定义.\n            account: {\n                currency: { gold: \"--\", silver: \"--\"},  // 当前账号瓜子数.\n                type: false  // 当前账号类型, \"anchor\" || \"guest\" || false, 根据不同账号类型控制节点显示.\n            },\n\n            // 竞猜节点控制标识.\n            doms: {\n\n                // 购买与下注按钮的 Title.\n                displayTitle: \"\",\n\n                // 竞猜设置面板.\n                quizSetupPanel: {\n                    show: false,\n                    out: false,\n                    outTimeout: null\n                },\n\n                // 竞猜购买面板.\n                betBuyPanel: {\n                    show: false,\n                    out: false,\n                    outTimeout: null\n                },\n\n                // 坐庄面板.\n                beResidentPanel: {\n                    show: false,\n                    out: false,\n                    outTimeout: null\n                },\n\n                // 认购表.\n                subscriptionList: {\n                    show: false,\n                    out: false,\n                    outTimeout: null\n                },\n\n                // 竞猜封盘面板.\n                adjournPanel: {\n                    show: false,\n                    out: false,\n                    outTimeout: null\n                },\n\n                // 竞猜结算面板.\n                quizCheckoutPanel: {\n                    show: false,\n                    out: false,\n                    outTimeout: null\n                }\n\n            },\n\n            // 竞猜事件定义, 主要为 Dom 中的点击事件.\n            events: {\n\n                // 设置新竞猜.\n                quizSetup: function () {\n                    quizCtrl.quiz.allowNewQuiz && !quizCtrl.quiz.betStatus && quizCtrl.account.type === \"anchor\" && quizCtrl.$fire(\"QuizSetup\");\n                },\n\n                // 取消新竞猜设置.\n                quizCancelSetup: function () {\n                    quizCtrl.$fire(\"QuizCancelSetup\");\n                },\n\n                // 开始新竞猜.\n                quizStart: function (event) {\n                    if (event.keyCode === 13 || !event.keyCode) {\n                        var target = event.target || event.srcElement;\n                        if (quizCtrl.quiz.info.question.length < 1 || quizCtrl.quiz.info.a.length < 1 || quizCtrl.quiz.info.b.length < 1) {\n                            liveToast(target, \"请输入完整的竞猜内容喔~ \" + randomEmoji.helpless());\n                            return;\n                        }\n                        quizCtrl.$fire(\"QuizStart\", {\n                            toastElement: target\n                        });\n                    }\n                },\n\n                // 竞猜封盘.\n                quizAdjourn: function () {\n                    quizCtrl.$fire(\"QuizAdjourning\");\n                },\n\n                // 确认封盘.\n                quizAdjournConfirm: function (event) {\n                    quizCtrl.$fire(\"QuizAdjournConfirm\", {\n                        targetElement: event.target || event.srcElement\n                    })\n                },\n\n                // 取消封盘.\n                quizAdjournCancel: function () {\n                    quizCtrl.$fire(\"QuizAdjournCancel\");\n                },\n\n                // 准备结算竞猜.\n                quizOnClose: function () {\n                    quizCtrl.$fire(\"QuizOnClose\");\n                },\n\n                // 确认结算竞猜（结算竞猜）.\n                quizCheckout: function (event) {\n                    quizCtrl.$fire(\"QuizCheckout\", {\n                        targetElement: event.target || event.srcElement\n                    });\n                },\n\n                // 取消结算竞猜.\n                quizCancelCheckout: function () {\n                    quizCtrl.$fire(\"QuizCancelCheckout\")\n                },\n\n                // 购买下注.\n                betBuy: function (event) {\n                    var target = event.target || event.srcElement;\n\n                    quizCtrl.$fire(\"BetBuy\", function () {\n                        var answerInfo = quizCtrl.quiz.answerInfo[target.attributes[\"data-type\"].value][target.attributes[\"data-target\"].value];\n                        // 放在内部确保获取的数据为最新数据, 而不可放在回调函数外部.\n                        // quizCtrl.quiz.answerInfo.silver.a || quizCtrl.quiz.answerInfo.silver.b\n\n                        // 设置 bankerId.\n                        quizCtrl.quiz.betBuyData.bankerId = answerInfo.id;\n\n                        // 设置可购买数量.\n                        quizCtrl.quiz.betBuyData.maxBuyCount = answerInfo.amount ? answerInfo.amount : 0;\n\n                        // 设置当前坐庄的倍率.\n                        quizCtrl.quiz.betBuyData.odds = answerInfo.times ? answerInfo.times : 0.1;\n\n                        // 复位购买利润显示.\n                        quizCtrl.quiz.betBuyData.buyIncome = 0;\n                    });\n                },\n\n                // 购买全部下注.\n                buyMax: function () {\n                    quizCtrl.quiz.betBuyData.buyCount = quizCtrl.quiz.betBuyData.maxBuyCount;\n                    quizCtrl.quiz.betBuyData.buyIncome = Math.floor(quizCtrl.quiz.betBuyData.buyCount * (1 + quizCtrl.quiz.betBuyData.odds) * 0.95);\n                },\n\n                // 更新收益数据.\n                updateBetBuyIncome: function (event) {\n                    // 从 betBuyData 中的数据计算而出.\n\n                    quizCtrl.quiz.betBuyData.buyCount = parseInt(quizCtrl.quiz.betBuyData.buyCount, 10);\n\n                    // Error Handler.\n                    if (isNaN(quizCtrl.quiz.betBuyData.buyCount)) {\n                        quizCtrl.quiz.betBuyData.buyCount = null;\n                        liveToast(event.target || event.srcElement, \"只能输入数字哦 \" + randomEmoji.helpless());\n                    }\n\n                    if (parseInt(quizCtrl.quiz.betBuyData.buyCount, 10) > parseInt(quizCtrl.quiz.betBuyData.maxBuyCount, 10)) {\n                        quizCtrl.quiz.betBuyData.buyCount = quizCtrl.quiz.betBuyData.maxBuyCount;\n                        liveToast(event.target || event.srcElement, \"不能超过最大额度哦 \" + randomEmoji.helpless());\n                    }\n\n                    quizCtrl.quiz.betBuyData.buyIncome = Math.floor(quizCtrl.quiz.betBuyData.buyCount * (1 + quizCtrl.quiz.betBuyData.odds) * 0.95);\n\n                    event.keyCode === 13 && quizCtrl.events.betBuyConfirm(event);\n                },\n\n                // 确认购买下注（发送请求）.\n                betBuyConfirm: function (event) {\n                    if (event.type === \"keyup\" && event.keyCode !== 13) { return; }\n                    quizCtrl.$fire(\"BetBuyConfirm\", event);\n                },\n\n                // 取消购买下注.\n                betBuyCancel: function () {\n                    quizCtrl.$fire(\"BetBuyCancel\");\n                },\n\n                // 显示坐庄面板.\n                betBeResident: function (event) {\n                    quizCtrl.$fire(\"BetBeResident\");\n                },\n\n                // 确认坐庄.\n                betBeResidentConfirm: function (event) {\n                    var target = event.target || event.srcElement;\n                    var residentCount = parseInt(quizCtrl.quiz.beResidentData.residentCount, 10);\n\n                    // Error Handler.\n                    if (isNaN(quizCtrl.quiz.beResidentData.residentCount)) {\n                        liveToast(target, \"手滑了吧~ 只能是数字喔~ \" + randomEmoji.helpless());\n                        quizCtrl.quiz.beResidentData.residentCount = \"\";\n                        return;\n                    }\n\n                    clearTimeout(timeouts.residentCountChk);\n                    timeouts.residentCountChk = setTimeout(function () {\n                        residentCount < 10000 && liveToast(target, \"底金不得少于 10000 哦~ \" + randomEmoji.helpless());\n                    }, 300);\n\n                    if (event.keyCode && event.keyCode !== 13) { return; }\n\n                    if (residentCount < 10000) {\n                        clearTimeout(timeouts.residentCountChk);\n                        liveToast(target, \"底金不得少于 10000 哦~ \" + randomEmoji.helpless());\n                        return;\n                    }\n\n                    quizCtrl.$fire(\"BetBeResidentConfirm\", {\n                        element: target\n                    });\n\n                },\n\n                // 取消坐庄.\n                beResidentCancel: function () {\n                    quizCtrl.$fire(\"BetBeResidentCancel\");\n                },\n\n                // 显示认购表.\n                showSubscription: function (event) {\n                    quizCtrl.$fire(\"BetShowSubscriptionList\", event);\n                },\n\n                // 关闭认购表.\n                closeSubScription: function () {\n                    quizCtrl.doms.subscriptionList.out = true;\n                    setTimeout(function () {\n                        quizCtrl.doms.subscriptionList.show = false;\n                        quizCtrl.doms.subscriptionList.out = false;\n                    }, 380);\n                }\n\n            },\n\n            // 竞猜部分数据定义.\n            data: {\n                subscriptionList: []  // 认购表数据.\n            }\n\n        });\n\n\n        // Definition: 竞猜相关事件定义.\n        (function quizEventsDefinition () {\n\n            // 竞猜初始阶段事件定义.\n            // ==========================================\n            require(\"./quiz-ctrl-quiz-setup\")(quizCtrl);\n\n\n            // 竞猜控制方法事件定义.\n            // ==========================================\n            require(\"./quiz-ctrl-methods\")(quizCtrl);\n\n\n            // 竞猜用户事件定义.\n            // ==========================================\n            require(\"./quiz-ctrl-user-events\")(quizCtrl);\n\n\n            // 竞猜信息控制事件.\n            // ==========================================\n            require(\"./quiz-ctrl-status-ctrl\")(quizCtrl);\n\n\n            // 公共服务事件定义.\n            // ==========================================\n            (function publicService () {\n                // Definition: 瓜子更新事件.\n                quizCtrl.$watch(\"fillCurrency\", function (value) {\n                    if (value.gold !== undefined && value.gold !== null) { quizCtrl.account.currency.gold = value.gold; }\n                    if (value.silver !== undefined && value.silver !== null) { quizCtrl.account.currency.silver = value.silver; }\n                });\n            })();\n\n        })();\n\n        // Action: 判断账号类型.\n        if ($.cookie(\"DedeUserID\") && parseInt(window.ISANCHOR, 10) === 1) {\n            quizCtrl.account.type = \"anchor\";\n        }\n\n        if ($.cookie(\"DedeUserID\") && parseInt(window.ISANCHOR, 10) === 0) {\n            quizCtrl.account.type = \"guest\";\n        }\n\n        if (!$.cookie(\"DedeUserID\")) {\n            quizCtrl.account.type = false;  // 未登录.\n        }\n\n        // 预先定义前端模板.\n        avalon.templateCache[\"quiz-panel.html\"] = \"\";\n        avalon.templateCache[\"quiz-panel-anchor.html\"] = \"\";\n\n        // 初始化控制器.\n        lazyInit(document.getElementById(\"quiz-control-panel\"), quizCtrl, secInit);\n\n        // 设置弹窗初始化. 如果没有竞猜权限, 则不加载前端模板.\n        function secInit () {\n            quizCtrl.$fire(\"QuizCheckStatus\");\n            lazyInit(document.getElementById(\"quiz-setting-container\"), quizCtrl);\n            lazyInit($(\"#room-left-sidebar\").find(\".small-btn.quiz\")[0], quizCtrl);\n        }\n    }\n\n};", "(function (global){\n/*\n *  Live Quiz Control Methods By LancerComet at 10:15, 2015/12/23.\n *  # Carry Your World #\n *  ---\n *  竞猜控制方法定义.\n */\nvar appConfig = require('../../../../common/app-config/app-config');\nvar liveToast = require('../../../../common/components/live-widget/live-toast/live-toast');\nvar livePopup = require('../../../../common/components/live-widget/live-popup/live-popup');\nvar randomEmoji = require(\"../../../../common/functions/func-random-emoji/random-emoji\");\n\n// 竞猜控制方法事件定义.\n// ==========================================\nmodule.exports = function (quizCtrl) {\n\n    // Definition: 开始竞猜.\n    quizCtrl.$watch(\"QuizStart\", function (param) {\n        /*\n         *   @ param: {\n         *     targetElement: HTMLElement  // 用于定位弹窗.\n         *   }\n         */\n        $.ajax({\n            url: \"/bet/addBet\",\n            type: \"POST\",\n            dataType: \"JSON\",\n            data: {\n                question: quizCtrl.quiz.info.question,\n                a: quizCtrl.quiz.info.a,\n                b: quizCtrl.quiz.info.b,\n                token: $.cookie(\"LIVE_LOGIN_DATA\") || \"\"\n            },\n            success: function (result) {\n                if (result.code != 0) {\n                    consoleText.log(appConfig.consoleText.error + \"竞猜开启失败, 必炸必炸动画 (╯‵□′)╯︵┻━┻\");\n                    consoleText.log(\"Detail: \" + result.msg.toString());\n                    liveToast(param.toastElement, \"竞猜开启失败：\" + result.msg.toString(), \"error\");\n                    return;\n                }\n\n                quizCtrl.quiz.betId = result.data.betId;  // 设置 betID.\n                quizCtrl.quiz.allowNewQuiz = false;  // 不允许新的竞猜.\n                quizCtrl.quiz.quizJoined = true;  // 已加入竞猜.\n                quizCtrl.events.quizCancelSetup();  // 关闭设置面板, 借助取消设置事件关闭面板.\n\n                // 然后所有人会接到竞猜开始的广播 BET_START, 竞猜信息将在广播 BET_START 中填写.\n            },\n            error: function (result) {\n                consoleText.log(appConfig.consoleText.error + \"竞猜开启失败, 网络通信失败\");\n                liveToast(param.toastElement, \"竞猜开启失败, 还请您稍后重试… \" + randomEmoji.sad(), \"error\");\n            }\n        });\n    });\n\n    // Definition: 竞猜封盘事件.\n    quizCtrl.$watch(\"QuizAdjourning\", function () {\n        if (quizCtrl.account.type !== \"anchor\" || quizCtrl.quiz.allowNewQuiz) { return; }\n        quizCtrl.doms.adjournPanel.show = true;\n        quizCtrl.quiz.allowNewQuiz = false;\n    });\n\n    // Definition: 竞猜已经封盘.\n    quizCtrl.$watch(\"QuizAdjourned\", function () {\n        quizCtrl.quiz.disabled = true;\n        quizCtrl.doms.displayTitle = \"竞猜已封盘，停手啦 \" + randomEmoji.helpless();\n        quizCtrl.quiz.allowNewQuiz = false;\n        setTimeout(function () {\n            ISANCHOR != 1 && liveToast($(\".be-resident-btn\"), \"竞猜封盘啦，不能挖坑啦~ \" + randomEmoji.helpless());\n        }, 1);\n    });\n\n    // Definition: 竞猜取消事件.\n    quizCtrl.$watch(\"QuizAdjournCancel\", function () {\n        quizCtrl.doms.adjournPanel.out = true;\n        setTimeout(function () {\n            quizCtrl.doms.adjournPanel.show = false;\n            quizCtrl.doms.adjournPanel.out = false;\n        }, 380);\n    });\n\n    // Definition: 竞猜封盘请求.\n    quizCtrl.$watch(\"QuizAdjournConfirm\", function (param) {\n        /*\n         *   @ param: {\n         *     targetElement: HTMLElement  // 用于定位弹窗.\n         *   }\n         */\n        if (quizCtrl.account.type !== \"anchor\" || quizCtrl.quiz.allowNewQuiz) { return; }\n\n        // 发送封盘请求.\n        $.ajax({\n            url: \"/bet/seal\",\n            type: \"POST\",\n            data: {\n                betId: quizCtrl.quiz.betId,\n                token: $.cookie(\"LIVE_LOGIN_DATA\") || \"\"\n            },\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code != 0) {\n                    var msg = result.msg ? result.msg : \"服务器响应为封盘失败\";\n                    liveToast(param.targetElement, \"封盘失败：\" + msg + \"，请稍后再试试 \" + randomEmoji.sad(), \"error\");\n                    return;\n                }\n                liveToast(param.targetElement, \"封盘成功！\" + randomEmoji.happy(), \"success\");\n                quizCtrl.$fire(\"QuizAdjournCancel\");\n            },\n            error: function (result) {\n                var msg = result.msg ? result.msg : \"服务器响应为封盘失败\";\n                liveToast(param.targetElement, \"封盘失败：\" + msg + \"，请稍后再试试 \" + randomEmoji.sad(), \"error\");\n            }\n        });\n    });\n\n    // Definition: 竞猜关闭事件.（仅仅显示结算面板, 非确认关闭事件）\n    quizCtrl.$watch(\"QuizOnClose\", function () {\n        if (quizCtrl.account.type !== \"anchor\" || quizCtrl.quiz.allowNewQuiz) { return; }\n        quizCtrl.doms.quizCheckoutPanel.show = true;\n    });\n\n    // Definition: 竞猜结算事件.\n    quizCtrl.$watch(\"QuizCheckout\", function (param) {\n        if (quizCtrl.account.type !== \"anchor\" || quizCtrl.quiz.allowNewQuiz) { return; }\n        if (quizCtrl.quiz.betId === null || quizCtrl.quiz.betId === undefined) {\n            livePopup({\n                title: \"竞猜出现错误\",\n                html: \"<p>由于没有正确获取到竞猜 ID, 您的本次竞猜出现了问题, 请刷新浏览器, 如果多次刷新后竞猜存在且无法正常爆破, 请您联系客服进行处理, 真的很抱歉！> <<br/><br/>Detail: 未获取到正确的 betId.</p>\",\n                type: \"alert\"\n            });\n            return;\n        }\n\n        if (!quizCtrl.quiz.quizCheckoutData.choicedAnswer) {\n            liveToast(param.targetElement, \"请选择您的答案哦~ \" + randomEmoji.helpless());\n            return;\n        }\n\n        $.ajax({\n            url: \"/bet/endBet\",\n            type: \"POST\",\n            dataType: \"JSON\",\n            data: {\n                betId: quizCtrl.quiz.betId,\n                answer: quizCtrl.quiz.quizCheckoutData.choicedAnswer,\n                token: $.cookie(\"LIVE_LOGIN_DATA\") || \"\"\n            },\n            success: function (result) {\n                if (result.code != 0) {\n                    liveToast(param.targetElement, \"竞猜爆破失败：\" + result.msg, \"error\");\n                    return;\n                }\n                liveToast(param.targetElement, \"爆破成功！您可以到竞猜中心查看记录~ \" + randomEmoji.happy() || result.msg, \"success\");\n                quizCtrl.$fire(\"QuizCancelCheckout\");\n            },\n            error: function (result) {\n                livePopup({\n                    title: \"竞猜爆破失败 \" + randomEmoji.sad(),\n                    html: \"<p>由于网络错误或服务器出现问题, 竞猜爆破失败, 请您稍后再试或联系客服处理, 真的很抱歉！\" + randomEmoji.sad() + \"<br/><br/>Detail: \" + result.statusText + \"</p>\"\n                });\n            }\n        });\n\n    });\n\n    // Definition: 取消结算竞猜.\n    quizCtrl.$watch(\"QuizCancelCheckout\", function () {\n        quizCtrl.doms.quizCheckoutPanel.out = true;\n        quizCtrl.quiz.quizCheckoutData.choicedAnswer = null;\n        setTimeout(function () {\n            quizCtrl.doms.quizCheckoutPanel.show = false;\n            quizCtrl.doms.quizCheckoutPanel.out = false;\n        }, 380);\n    });\n\n    // Definition: 竞猜结算中状态事件.\n    quizCtrl.$watch(\"QuizOnEnding\", function () {\n        console.log(\"avalon: QuizOnEnding\");\n        quizCtrl.quiz.disabled = true;\n        quizCtrl.doms.displayTitle = \"竞猜正在爆破中 \" + randomEmoji.helpless();\n        quizCtrl.quiz.info.question += \"（爆破中）\";\n        setTimeout(function () {\n            ISANCHOR != 1 && liveToast($(\".be-resident-btn\"), \"竞猜爆破中，等下一波吧~ \" + randomEmoji.happy(), \"success\");\n        }, 1);\n    });\n\n    // Definition: 获取竞猜结果.\n    quizCtrl.$watch(\"QuizGetResult\", function (callback) {\n        console.log(\"Event: QuizGetResult\");\n        console.log(\"QuizJoined: \" + quizCtrl.quiz.quizJoined);\n\n\n        if (!quizCtrl.quiz.quizJoined) {\n            quizCtrl.$fire(\"QuizRestorePanel\");\n            return;\n        }\n\n        $.ajax({\n            url: \"/bet/getUserProfit\",\n            type: \"POST\",\n            data: {\n                betId: quizCtrl.quiz.betId\n            },\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code != 0) {\n                    consoleText.log(appConfig.consoleText.error + \"竞猜结果获取失败.\");\n                    consoleText.log(\"Detail: \" + result.msg);\n                    return;\n                }\n\n                // Definition: 结算金币结果.\n                var summary = {\n                    gold: parseInt(result.data.profit.gold, 10),\n                    silver: parseInt(result.data.profit.silver, 10)\n                };\n\n                // 弹出结算面板.\n                var summaryPanel = null;\n                var resultText = {\n                    gold: \"\",\n                    silver: \"\"\n                };\n\n                // Action: 判断当前账号类型.\n                // 播主弹出播主的结算面板, 用户弹出用户的结算面板.\n                parseInt(global.ISANCHOR, 10) === 1 ? anchorResult() : guestResult();\n                \n                function anchorResult () {\n                    //summary.gold >= 0 ? resultText.gold = '<p style=\"color: #4fc1e9; margin:10px 0\"><i class=\"live-icon gold-seed\"></i> 赢得 ' + summary.gold + ' 金瓜子</p>' : resultText.gold = '<p style=\"color: #E16C97; margin:10px 0\"><i class=\"live-icon gold-seed\"></i> 损失 ' + (-summary.gold) + ' 金瓜子</p>';\n                    summary.silver >= 0 ? resultText.silver = '<p style=\"color: #4fc1e9\"><i class=\"live-icon silver-seed v-middle\"></i><span class=\"v-middle\" style=\"margin-left: 5px\"> 赢得 ' + summary.silver + ' 银瓜子</span></p>' : resultText.silver = '<p style=\"color: #E16C97\"><i class=\"live-icon silver-seed\"></i> 损失 ' + (-summary.silver) + ' 银瓜子</p>';\n\n                    summaryPanel = livePopup({\n                        title: \"爆破成功\",\n                        html: '<p>本轮竞猜您一共：</p>' +\n                        '<p class=\"text-center\">' + resultText.gold + resultText.silver + '</p>' +\n                        '<p style=\"text-align:center; margin: 10px 0;\"><a href=\"/i/bet\" target=\"_blank\" style=\"color: #4fc1e9;\">点击查看详情...</a></p>',\n                        type: \"info\",\n                        width: 300,\n                        onConfirm: function () {\n                            summaryPanel.remove();\n                            summaryPanel = null;\n                        }\n                    });\n                }\n                \n                \n                function guestResult () {\n\n                    //summary.gold >= 0 ? resultText.gold = '<p style=\"color: #4fc1e9; margin:10px 0\"><i class=\"live-icon gold-seed\"></i> 赢得 ' + summary.gold + ' 金瓜子</p>' : resultText.gold = '<p style=\"color: #E16C97; margin:10px 0\"><i class=\"live-icon gold-seed\"></i> 损失 ' + (-summary.gold) + ' 金瓜子</p>';\n                    summary.silver >= 0 ? resultText.silver = '<p style=\"color: #4fc1e9\"><i class=\"live-icon silver-seed v-middle\"></i><span class=\"v-middle\" style=\"margin-left: 5px\"> 赢得 ' + summary.silver + ' 银瓜子</span></p>' : resultText.silver = '<p style=\"color: #E16C97\"><i class=\"live-icon silver-seed\"></i> 损失 ' + (-summary.silver) + ' 银瓜子</p>';\n\n                    summaryPanel = livePopup({\n                        title: \"竞猜结束\",\n                        html: '<p>本轮竞猜答案为：<span style=\"color: pink\" class=\"quiz-summary-guest-answer\">' + result.data.bet.answer + '</span></p>' +\n                        resultText.silver +\n                        '<p style=\"text-align:center; margin: 10px 0;\"><a href=\"/i/bet\" target=\"_blank\" style=\"color: #4fc1e9;\">点击查看详情...</a></p>',\n                        type: \"info\",\n                        width: 300,\n                        onConfirm: function () {\n                            summaryPanel.remove();\n                            summaryPanel = null;\n                        }\n                    });\n                }\n                \n                quizCtrl.$fire(\"all!updateCurrency\", {\n                    gold: result.data.user.gold,\n                    silver: result.data.user.silver\n                });\n\n                quizCtrl.quiz.info = {\n                    id: null,  // 竞猜 ID, 同上.\n                    uid: null,  // 竞猜播主的 UID.\n                    question: \"--\",  // 竞猜题目.\n                    a: \"--\",  // 竞猜答案 A.\n                    b: \"--\",  // 竞猜答案 B.\n                    answer: null,  // 竞猜最终选择答案.\n                    status: null,  // 竞猜状态.\n                    update_time: null  // 竞猜状态最后更新时间.\n                };\n\n                quizCtrl.quiz.answerInfo =  {\n                    gold: { a: { }, b: {} },\n                    silver: { a: { times: null, progress: 0, c: 0}, b: { times: null, progress: 0, c: 0 } }\n                };\n\n                callback && callback();\n            },\n            error: function (result) {\n\n            }\n        });\n    });\n\n    // Definition: 还原竞猜面板.\n    quizCtrl.$watch(\"QuizRestorePanel\", function (json) {\n        console.log(\"Event: QuizRestorePanel\");\n\n        quizCtrl.quiz.disabled = false;\n\n        quizCtrl.quiz.permission = true;\n        quizCtrl.quiz.allowNewQuiz = true;\n        quizCtrl.quiz.betStatus = false;\n        quizSystem.betStatus = false;\n        quizCtrl.quiz.quizJoined = false;\n\n        quizCtrl.quiz.betId = -1;\n        quizCtrl.quiz.disabled = false;\n\n    });\n\n};\n}).call(this,typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})", "/*\n *  Live Quiz Control Methods By LancerComet at 11:32, 2015/12/23.\n *  # Carry Your World #\n *  ---\n *  竞猜初始设置方法.\n */\n\n// 竞猜初始阶段事件定义.\n// ==========================================\nmodule.exports = function (quizCtrl) {\n    \"use strict\";\n\n    // Definition: 设置新的竞猜.\n    quizCtrl.$watch(\"QuizSetup\", function () {\n        quizCtrl.doms.quizSetupPanel.show = true;\n        quizCtrl.doms.quizSetupPanel.out = false;\n        quizCtrl.quiz.info.question = \"\";\n        quizCtrl.quiz.info.a = \"\";\n        quizCtrl.quiz.info.b = \"\";\n    });\n\n    // Definition: 取消竞猜设置.\n    quizCtrl.$watch(\"QuizCancelSetup\", function () {\n        quizCtrl.doms.quizSetupPanel.out = true;\n        clearTimeout(quizCtrl.doms.quizSetupPanel.outTimeout);\n        quizCtrl.doms.quizSetupPanel.outTimeout = setTimeout(function () {\n            quizCtrl.doms.quizSetupPanel.show = false;\n            quizCtrl.doms.quizSetupPanel.out = false;\n        }, 380);\n    });\n\n};", "/*\n *  Live Quiz Status Control By LancerComet at 11:36, 2015/12/23.\n *  # Carry Your World #\n *  ---\n *  竞猜信息控制事件.\n */\n\nvar appConfig = require('../../../../common/app-config/app-config');\n\nvar tplLoaded = {\n    common: false,\n    anchor: false\n};\n\n// 竞猜信息控制事件.\n// ==========================================\nmodule.exports = function (quizCtrl) {\n    \"use strict\";\n\n    // Definition: 竞猜状态检查事件.\n    quizCtrl.$watch(\"QuizCheckStatus\", function (param) {\n        /*\n         *  @ param: {\n         *    type: \"normal\" || \"protocol\",\n         *    json: null || {},\n         *    callback: null || Function,\n         *  }\n         */\n\n        param = param || { type: \"normal\" };\n\n        if (param.type !== \"normal\" && param.type !== \"protocol\") {\n            throw new Error(appConfig.consoleText.error + \"非法调用, 骚年你撸多了.\");\n        }\n\n        // 如果是广播调用, 则跳过请求.\n        if (param.type === \"protocol\" && param.json) {\n            successCallback(param.json);\n            return;\n        }\n\n        // 默认状态下发送请求.\n        $.ajax({\n            url: \"/bet/getRoomBet\",\n            type: \"POST\",\n            dataType: \"JSON\",\n            data: {\n                roomid: ROOMID\n            },\n            success: successCallback,\n            error: errorCallback\n        });\n\n        function successCallback (result) {\n            // Error Handler.\n            if (parseInt(result.code, 10) !== 0) {\n                consoleText.log(appConfig.consoleText.error + \"竞猜信息获取错误, 必炸必炸动画  (╯‵□′)╯︵┻━┻\");\n                consoleText.log(\"Detail: \" + result.msg);\n                quizCtrl.quiz.allowNewQuiz = false;  // 竞猜系统异常, 不允许开启新竞猜.\n                return;\n            }\n\n            // 判断竞猜权限, 如果没有竞猜权限, 终止执行.\n            if (!result.data.isBet) {\n                console.log(appConfig.consoleText.info + \"播主没有竞猜权限, 终止运行.\");\n                quizCtrl.quiz.permission = false;\n                quizCtrl.quiz.allowNewQuiz = false;\n                return false;\n            }\n\n\n            // 设置全局竞猜状态, 供外部调用（关闭直播时状态判断）.\n            quizSystem.betStatus = result.data.betStatus;\n\n            // 初始化时根据返回值设置是否参与竞猜.\n            // 其实这里不管是不是初始化都根据服务器数据来设定看起来是没问题的, 但这里采取了无视后端的策略, 防止数据错误.\n\n            // 以上说法不对, 如果用户刷新页面将导致状态丢失, 需要根据服务器返回状态设置.\n            !quizCtrl.quiz.initFinished ? quizCtrl.quiz.quizJoined = result.data.isInBet : void(0);\n\n            // 竞猜权限与状态.\n            quizCtrl.quiz.permission = result.data.isBet;\n            quizCtrl.quiz.betStatus = result.data.betStatus;\n\n\n            // 数据单向同步.\n            if (result.data.bet !== [] && !$.isEmptyObject(result.data.bet)) {\n                quizCtrl.quiz.betStatus = result.data.betStatus;\n                quizCtrl.quiz.allowNewQuiz = !result.data.isInBet;\n                result.data.bet.id ? quizCtrl.quiz.betId = result.data.bet.id : void(0);\n                quizCtrl.quiz.info = result.data.bet;\n                try {\n\n                    // 补全数据, 否则 Avalon 不会同步.\n                    if (!result.data.silver.a.amount) { result.data.silver.a.amount = 0; }\n                    if (!result.data.silver.b.amount) { result.data.silver.b.amount = 0; }\n                    if (!result.data.silver.a.times) { result.data.silver.a.times = null; }\n                    if (!result.data.silver.b.times) { result.data.silver.b.times = null; }\n\n                    quizCtrl.quiz.answerInfo.gold = result.data.gold;\n                    quizCtrl.quiz.answerInfo.silver = result.data.silver;\n\n                } catch (tryErr) {\n                    // ...\n                    console.log(\"QuizCheckStatus 单向数据绑定错误: \" + tryErr);\n                }\n                quizCtrl.doms.displayTitle = \"\";\n            }\n\n            // 初始化完毕.\n            !quizCtrl.quiz.initFinished ? quizCtrl.quiz.initFinished = true : void(0);\n\n            // 判断当前竞猜状态, 如果为 true 说明已开启竞猜.\n            if (result.data.betStatus == true) {\n                console.log(\"房间已开启竞猜.\");\n                quizCtrl.quiz.allowNewQuiz = false;\n\n            } else {\n                console.log(\"房间未开启竞猜.\");\n                quizCtrl.quiz.allowNewQuiz = true;  // 允许新竞猜.\n            }\n\n            // Execute callback if there it is.\n            if (param.callback) {\n                setTimeout(param.callback, 1);\n            }\n\n            // 加载前端模板.\n            if (result.data.isBet) {\n\n                // 加载公共部分.\n                if (!tplLoaded.common) {\n                    $.getScript(\"http://static.hdslb.com/live-static/live-room/tpls/tpl-quiz.js\", function (result) {\n                        avalon.templateCache[\"quiz-panel.html\"] = window.liveTpls[\"room-template/quiz-guest.html\"];\n                        tplLoaded.common = true;\n                    });\n                }\n\n                // 加载播主部分.\n                if (ISANCHOR == 1 && !tplLoaded.anchor) {\n                    $.getScript(\"http://static.hdslb.com/live-static/live-room/tpls/tpl-quiz-anchor.js\", function (result) {\n                        avalon.templateCache[\"quiz-panel-anchor.html\"] = window.liveTpls[\"room-template/quiz-anchor.html\"];\n                        tplLoaded.anchor = true;\n                    });\n                }\n            }\n\n            // 检测是否已封盘, 封盘则封盘.\n            if (parseInt(result.data.bet.status, 10) === -2) {\n                console.log(\"进入页面, 发现当前竞猜已在封盘\");\n                quizCtrl.$fire(\"QuizAdjourned\");\n                return;\n            }\n\n            // 检测是否在结算中, 如果在结算则进入结算状态.\n            if (parseInt(result.data.bet.status, 10) === -3) {\n                console.log(\"进入页面, 发现当前竞猜已在结算\");\n                quizCtrl.$fire(\"QuizOnEnding\");\n            }\n        }\n\n        function errorCallback (result) {\n            consoleText.log(appConfig.consoleText.error + \"竞猜信息获取失败:\");\n            consoleText.log(result.statusText);\n\n        }\n\n    });\n\n    // Definition: 竞猜信息更新事件.\n    quizCtrl.$watch(\"QuizUpdateInfo\", function () {\n\n    });\n\n};\n", "/*\n *  Live Quiz User Events By LancerComet at 11:32, 2015/12/23.\n *  # Carry Your World #\n *  ---\n *  竞猜用户事件定义.\n */\nvar appConfig = require('../../../../common/app-config/app-config');\nvar randomEmoji = require('../../../../common/functions/func-random-emoji/random-emoji');\nvar livePopup = require('../../../../common/components/live-widget/live-popup/live-popup');\nvar liveToast = require('../../../../common/components/live-widget/live-toast/live-toast');\n\n// 竞猜用户事件定义.\n// ==========================================\nmodule.exports = function (quizCtrl, undefined) {\n\n    // 竞猜坐庄.\n    // ===========================================\n\n    // Definition: 开启坐庄面板事件.\n    quizCtrl.$watch(\"BetBeResident\", function () {\n        if (quizCtrl.quiz.allowNewQuiz) {\n            return;\n        }\n        if (quizCtrl.account.type === \"anchor\") {\n            liveToast(event.target || event.srcElement, \"播主不可以挖坑喔~\" + randomEmoji.helpless());\n            return;\n        }\n        if (quizCtrl.account.type === false) {\n            liveToast(event.target || event.srcElement, \"您还没有登录哦~\" + randomEmoji.helpless());\n            return;\n        }\n        quizCtrl.doms.beResidentPanel.show = true;\n        quizCtrl.$fire(\"all!updateCurrency\");\n    });\n\n    // Definition: 确认坐庄事件.\n    quizCtrl.$watch(\"BetBeResidentConfirm\", function (param) {\n        // Error Handler.\n        if (quizCtrl.quiz.allowNewQuiz) {\n            consoleText.log(appConfig.consoleText.caution + \"allowNewQuiz = false, 当前不允许挖坑.\");\n            return;\n        }\n\n        if (!quizCtrl.quiz.beResidentData.answer || !quizCtrl.quiz.beResidentData.odds || !quizCtrl.quiz.beResidentData.residentCount) {\n            liveToast(param.element, \"请将数据填写完整~~\" + randomEmoji.shock(), \"caution\");\n            return;\n        }\n\n\n        if (quizCtrl.quiz.betId === null || quizCtrl.quiz.betId === undefined || quizCtrl.quiz.betId === \"\") {\n            var popup = livePopup({\n                title: \"出现错误 \" + randomEmoji.sad(),\n                content: \"> < 竞猜出现错误, 请刷新页面后重试… <br/><br/>Detail: 没有获取正确的 betId.\",\n                type: \"alert\",\n                onConfirm: function () {\n                    popup.remove();\n                }\n            });\n            return;\n        }\n\n        $.ajax({\n            url: \"/bet/addBanker\",\n            type: \"POST\",\n            dataType: \"JSON\",\n            data: {\n                answer: quizCtrl.quiz.beResidentData.answer,\n                times: parseFloat(quizCtrl.quiz.beResidentData.odds).toFixed1(),\n                coin: quizCtrl.quiz.beResidentData.residentCount,\n                coinType: quizCtrl.quiz.beResidentData.currencyType,\n                betId: quizCtrl.quiz.betId,\n                token: $.cookie(\"LIVE_LOGIN_DATA\") || \"\"\n            },\n            timeout: appConfig.appConfig.xhrTimeout,\n            success: function (result) {\n                if (result.code != 0) {\n                    consoleText.log(appConfig.consoleText.error + \"坐庄失败.\");\n                    consoleText.log(\"Detail: \" + result.msg);\n                    //var popup = livePopup({\n                    //    title: \"挖坑失败… \" + randomEmoji.sad(),\n                    //    content: \"> < 挖坑失败了…… 请您稍后再试, 真的很抱歉… <br/><br/>Detail: \" + result.msg + \".\",\n                    //    type: \"alert\",\n                    //    onConfirm: function () {\n                    //        popup.remove();\n                    //    }\n                    //});\n                    liveToast(param.element, \"挖坑失败惹：\" + result.msg + randomEmoji.happy(), \"caution\");\n                    return;\n                }\n\n                liveToast(param.element, \"挖坑成功!~ \" + randomEmoji.happy(), \"success\");\n                quizCtrl.quiz.quizJoined = true;\n                console.log(\"quizJoined: \" + quizCtrl.quiz.quizJoined);\n                quizCtrl.$fire(\"BetBeResidentCancel\");  // 借助取消事件关闭面板.\n\n            },\n            error: function (result) {\n                consoleText.log(appConfig.consoleText.error + \"挖坑请求失败.\");\n                consoleText.log(\"Detail: \" + result.msg);\n                var popup = livePopup({\n                    title: \"挖坑失败… \" + randomEmoji.sad(),\n                    content: \"> < 挖坑失败了…… 请您稍后再试, 真的很抱歉… <br/><br/>Status: \" + result.status + \".<br/>Detail: \" + result.statusText + \".\",\n                    type: \"alert\",\n                    onConfirm: function () {\n                        popup.remove();\n                    }\n                });\n            }\n        });\n\n\n\n    });\n\n    // Definition: 取消坐庄事件.\n    quizCtrl.$watch(\"BetBeResidentCancel\", function () {\n        quizCtrl.quiz.beResidentData.answer = \"\";\n        quizCtrl.quiz.beResidentData.odds = \"\";\n        quizCtrl.quiz.beResidentData.residentCount = \"\";\n        quizCtrl.doms.beResidentPanel.out = true;\n        clearTimeout(quizCtrl.doms.beResidentPanel.outTimeout);\n        quizCtrl.doms.beResidentPanel.outTimeout = setTimeout(function () {\n            quizCtrl.doms.beResidentPanel.show = false;\n            quizCtrl.doms.beResidentPanel.out = false;\n        }, 380);\n    });\n\n\n\n    // 认购表.\n    // ===========================================\n\n    // Definition: 显示认购表.\n    quizCtrl.$watch(\"BetShowSubscriptionList\", function (event) {\n        var element = event && event.target || event.srcElement;\n        $.ajax({\n            url: \"/bet/getBankers\",\n            type: \"POST\",\n            data: {\n                betId: quizCtrl.quiz.betId\n            },\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code != 0) {\n                    console.log(\"Bilibili Live Error: 认购表数据获取错误.\");\n                    element && liveToast(element, \"认购表数据获取错误：\" + result.msg, \"caution\", true);\n                    return;\n                }\n                quizCtrl.doms.subscriptionList.show = true;\n                quizCtrl.data.subscriptionList = result.data;\n                element = null;\n            },\n            error: function (result) {\n                element && liveToast(element, \"认购表数据获取错误：\" + result.statusText, \"error\", true);\n            }\n        });\n    });\n\n    // Definition: 关闭认购表.\n    quizCtrl.$watch(\"BetHideSubscriptionList\", function () {\n\n    });\n\n\n\n    // 下注.\n    // ===========================================\n\n    // Definition: 下注事件.\n    quizCtrl.$watch(\"BetBuy\", function (callback) {\n        if (quizCtrl.quiz.allowNewQuiz) { return; }\n        if (quizCtrl.account.type === \"anchor\") {\n            liveToast(event.target || event.srcElement, \"播主不可以填坑哦~\" + randomEmoji.helpless());\n            return;\n        }\n        if (quizCtrl.account.type === false) {\n            liveToast(event.target || event.srcElement, \"您还没有登录哦~\" + randomEmoji.helpless());\n            return;\n        }\n        quizCtrl.$fire(\"all!updateCurrency\");\n        quizCtrl.$fire(\"QuizCheckStatus\", {\n            type: \"normal\",\n            callback: function () {\n                callback();\n                quizCtrl.doms.betBuyPanel.show = true;\n            }\n        });\n    });\n\n\n    // Definition: 下注请求事件.\n    quizCtrl.$watch(\"BetBuyConfirm\", function (event) {\n        var element = event ? event.target || event.srcElement : document.body;\n\n        if (!quizCtrl.quiz.betBuyData.buyCount) {\n            liveToast(element, \"您好像并没有填写填坑量嘛~~ \" + randomEmoji.helpless());\n            return;\n        }\n\n        // 发送购买请求.\n        $.ajax({\n            url: \"/bet/addBettor\",\n            type: \"POST\",\n            dataType: \"JSON\",\n            data: {\n                bankerId: quizCtrl.quiz.betBuyData.bankerId,\n                amount: quizCtrl.quiz.betBuyData.buyCount,\n                token: $.cookie(\"LIVE_LOGIN_DATA\") || \"\"\n            },\n            success: function (result) {\n                if (result.code != 0) {\n                    consoleText.log(appConfig.consoleText.error + \"填坑失败.\");\n                    consoleText.log(\"Detail: \" + result.msg);\n                    liveToast(element, \"填坑失败惹：\" + result.msg, \"caution\");\n                    return;\n                }\n                liveToast(element, \"填坑成功!~ \" + randomEmoji.happy(), \"success\");\n                quizCtrl.quiz.quizJoined = true;\n                console.log(\"quizJoined: \" + quizCtrl.quiz.quizJoined);\n                quizCtrl.$fire(\"BetBuyCancel\");  // 借助取消事件关闭面板.\n            },\n            error: function (result) {\n                consoleText.log(appConfig.consoleText.error + \"填坑请求失败.\");\n                consoleText.log(\"Detail: \" + result.msg);\n                var popup = livePopup({\n                    title: \"填坑失败了… \" + randomEmoji.sad(),\n                    content: \"> < 填坑失败了…… 请您稍后再试, 真的很抱歉… <br/><br/>Status: \" + result.status + \".<br/>Detail: \" + result.statusText + \".\",\n                    type: \"alert\",\n                    onConfirm: function () {\n                        popup.remove();\n                    }\n                });\n            }\n        })\n\n    });\n\n\n    // Definition: 下注取消事件.\n    quizCtrl.$watch(\"BetBuyCancel\", function () {\n        quizCtrl.quiz.betBuyData.bankerId = \"\";\n        quizCtrl.quiz.betBuyData.buyCount = \"\";\n        quizCtrl.quiz.betBuyData.maxBuyCount = 0;\n        quizCtrl.quiz.betBuyData.buyIncome = 0;\n        quizCtrl.doms.betBuyPanel.out = true;\n        clearTimeout(quizCtrl.doms.betBuyPanel.outTimeout);\n        quizCtrl.doms.betBuyPanel.outTimeout = setTimeout(function () {\n            quizCtrl.doms.betBuyPanel.show = false;\n            quizCtrl.doms.betBuyPanel.out = false;\n        }, 380);\n    });\n\n\n\n};", "/*\n *  Quiz Broadcast Listener By LancerComet at 10:41, 2015/12/17.\n *  # Carry Your World #\n *  ---\n *  竞猜系统广播监听器.\n *\n */\nvar appConfig = require('../../../../common/app-config/app-config');\n\nmodule.exports = function (window, undefined) {\n    \"use strict\";\n\n    // Error Handler.\n    if (!window.protocol) {\n        //window.protocol = {};\n        throw new Error(appConfig.console.error + \"protocol 未加载, 竞猜模块必须在 protocol 初始化完毕后才可运行.\");\n    }\n\n    // Definition: 引用 Flash 广播视图对象.\n    var flashProtoCtrl = avalon.vmodels.flashProtoCtrl;\n\n    // 竞猜开启广播, 通知房间所有用户竞猜已开启.\n    window.protocol.BET_START = function (json) {\n        console.log(\"BET_START\");\n        console.log(json);\n        // 开启竞猜后业务流程：\n        // 1. 检查竞猜状态, 并使用广播数据进行判断, 不再让 \"checkQuizStatus\" 发送请求.\n        flashProtoCtrl.$fire(\"all!QuizCheckStatus\", {\n            type: \"protocol\",\n            json: json.data\n        });\n\n    };\n\n    // 竞猜中信息下发广播.\n    window.protocol.BET_BANKER = function (json) {\n        console.log(\"BET_BANKER\");\n        console.log(json);\n        flashProtoCtrl.$fire(\"all!QuizCheckStatus\", {\n            type: \"protocol\",\n            json: json.data\n        });\n    };\n\n    // 当有人购买之后下发的广播.\n    window.protocol.BET_BETTOR = function (json) {\n        console.log(\"BET_BETTOR\");\n        console.log(json);\n        flashProtoCtrl.$fire(\"all!QuizCheckStatus\", {\n            type: \"protocol\",\n            json: json.data\n        });\n    };\n\n    // 封盘广播.\n    window.protocol.BET_SEAL = function (json) {\n        console.log(\"BET_SEAL\");\n        console.log(json);\n        flashProtoCtrl.$fire(\"all!QuizAdjourned\");\n    };\n\n    // 结算中状态广播.\n    window.protocol.BET_ENDING = function (json) {\n        console.log(\"BET_ENDING\");\n        console.log(json);\n        flashProtoCtrl.$fire(\"all!QuizCheckStatus\", {\n            type: \"protocol\",\n            json: json.data\n        });\n    };\n\n    // 竞猜结束广播, 通知房间所有用户竞猜结束.\n    window.protocol.BET_END = function (json) {\n        console.log(\"BET_END\");\n        console.log(json);\n        flashProtoCtrl.$fire(\"all!QuizGetResult\", function () {\n            flashProtoCtrl.$fire(\"all!QuizRestorePanel\", json);\n        });\n    };\n\n};", "/*\n *  Recommend Videos Node By LancerComet at 14:16, 2015/12/22.\n *  # Carry Your World #\n *  ---\n *  推荐视频模块.\n */\n\nvar appConfig = require('../../../common/app-config/app-config');\nvar lazyInit = require(\"../../../common/functions/func-avalon-lazy-init/lazy-init\");\n\nmodule.exports = function (window) {\n    \"use strict\";\n\n    avalon.ready(function () {\n\n        // Error Handler.\n        if (!window.ROOMID || !window.ANCHOR_NICK_NAME) {\n            throw new Error(appConfig.consoleText.error + \"未获取到 ROOMID, 请检查函数的执行顺序.\");\n        }\n\n\n        var recommendVideoCtrl = avalon.define({\n            $id: \"recommendVideoCtrl\",\n            title: window.ANCHOR_NICK_NAME + \"的视频\",\n            spaceLink: \"http://space.bilibili.com/\" + window.MASTERID,\n            show: false,\n            videoList: [],\n            mouseEnter: function (event) {\n                var target = event.target || event.srcElement;\n                $(target).find(\".video-props\").addClass(\"hover\");\n                $(target).find(\".video-merge\").addClass(\"hover\");\n            },\n            mouseLeave: function (event) {\n                var target = event.target || event.srcElement;\n                $(target).find(\".video-props\").removeClass(\"hover\");\n                $(target).find(\".video-merge\").removeClass(\"hover\");\n            }\n        });\n\n\n        $.ajax({\n            url: \"/live/getVideoList/\" + window.ROOMID,\n            type: \"GET\",\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code != 0) {\n                    consoleText.log(appConfig.consoleText.error + \"服务器返回数据错误: \" + result.msg || \"（服务器无消息返回）\");\n                    return;\n                }\n                recommendVideoCtrl.videoList = result.data;\n                recommendVideoCtrl.show = true;\n            },\n            error: function (result) {\n                consoleText.log(appConfig.consoleText.error + \"推荐视频获取失败: \\n\" + result.statusText);\n            }\n        });\n\n\n        lazyInit(document.getElementById(\"recommend-videos\"), recommendVideoCtrl);\n    });\n\n\n\n};\n", "/*\n *  Charge Panel By LancerComet at 14:29, 2016/1/8.\n *  # Carry Your World #\n *  ---\n *  快速购买 BP 逻辑.\n */\n\nvar livePopup = require('../../../common/components/live-widget/live-popup/live-popup');\nvar liveToast = require('../../../common/components/live-widget/live-toast/live-toast');\nvar randomEmoji = require('../../../common/functions/func-random-emoji/random-emoji');\n\n// Definition: 按钮状态变换计时器.\nvar btnTextInterval = null;\n\nmodule.exports = function (event, seedExchangeCtrl) {\n    \"use strict\";\n\n    var target = event.target || event.srcElement;\n    var buyCount = parseInt(seedExchangeCtrl.data.charge.buyCount, 10);\n\n    // Error Handler.\n    if (buyCount <= 0 || isNaN(buyCount)) {\n        liveToast(target, \"请输入大于 0 的数字喔 \" + randomEmoji.helpless(), true);\n        return;\n    }\n\n    // 设置按钮文字.\n    (function setBtnText () {\n        seedExchangeCtrl.doms.charge.btnText = \"正在兑换中.\";\n        var dots = 1;\n        btnTextInterval = setInterval(function () {\n            if (dots >= 6) {\n                seedExchangeCtrl.doms.charge.btnText = \"正在兑换中\";\n                dots = 0;\n                return;\n            }\n            seedExchangeCtrl.doms.charge.btnText += \".\";\n            dots++;\n        }, 500);\n\n    })();\n\n    $.ajax({\n        url: \"/payCenter/quickPay\",\n        type: \"GET\",\n        data: {\n            bpNum: buyCount\n        },\n        dataType: \"JSON\",\n        success: function (result) {\n            // 还原按钮文字.\n            clearInterval(btnTextInterval);\n            seedExchangeCtrl.doms.charge.btnText = \"立刻购买\";\n\n            if (result.code == 0) {\n\n                // 余额不够, 弹窗进行 Bp 购买快捷支付.\n            } else if (result.code == -400) {\n\n                // Definition: 定义订单信息.\n                var payData = {\n                    orderNo: result.data.order,\n                    cashierURL: result.data.cashier_url\n                };\n\n                // 开始 BP 快速充值逻辑.\n                seedExchange(payData);\n\n                // 其他状态.\n            } else {\n                liveToast(target, result.msg);\n            }\n        },\n        error: function (result) {\n            clearInterval(btnTextInterval);\n            seedExchangeCtrl.doms.charge.btnText = \"立刻购买\";\n            liveToast(target, \"与服务器通信失败，请稍后再试 > <\", \"error\");\n        }\n    });\n\n\n\n    function seedExchange (payData) {\n        // Action: 创建充值提示弹窗.\n        var quickPayPopup = livePopup({\n            title: \"BP 不够惹\",\n            content: \"您的 B 币余额不足，要不要充一点？\" + randomEmoji.happy(),\n            button: {\n                confirm: \"葱！\",\n                cancel: \"先不葱了~\"\n            },\n            width: \"300px\",\n\n            // 点击进入快速充值逻辑.\n            onConfirm: function () {\n                window.open(payData.cashierURL);\n                payInProcess();\n            },\n\n            // 关闭面板时也更新瓜子数量.\n            onCancel: function () {\n                seedExchangeCtrl.$fire(\"all!updateCurrency\");\n                seedExchangeCtrl.$fire(\"getBp\");\n            }\n        });\n\n\n        // Definition: 进入 Bp 充值中状态函数.\n        function payInProcess () {\n\n            // Action: 移除之前的提示弹窗.\n            quickPayPopup.remove();\n\n            // Definition: 创建正在支付弹窗.\n            var payInProcessPanel = livePopup({\n                title: \"正在支付中……\",\n                content: '请在支付完毕后点击下方的 \"支付完成\" 按钮喔！' + randomEmoji.happy(),\n                width: \"350px\",\n                type: \"info\",\n                button: {\n                    confirm: \"支付完成\"\n                },\n                onConfirm: function () {\n\n                    // 查询订单状态.\n                    $.ajax({\n                        url: \"/payCenter/orderStatus\",\n                        type: \"GET\",\n                        data: {\n                            order: payData.orderNo\n                        },\n                        dataType: \"JSON\",\n                        success: successCallback,\n                        error: errorCallback\n                    });\n\n                }\n            });\n\n            // 成功回调.\n            function successCallback (result) {\n                if (result.code == \"0\") {\n\n                    // 销毁正在充值面板.\n                    payInProcessPanel.remove();\n\n                    // 进入充值成功逻辑.\n                    paySucceed(result);\n\n                } else {\n                    liveToast(payInProcessPanel.confirmBtn, result.msg, true);\n                }\n            }\n\n            // 失败回调.\n            function errorCallback (result) {\n                livePopup({\n                    title: \"订单状态查询错误\",\n                    html: \"<p>您的订单状态查询失败，请您刷新页面并到个人中心检查您的金额，如果充值失败，请联系客服，真的非常抱歉！> <<br/><br/>失败原因: \" + result.statusText + \"</p>\",\n                    width: \"350px\",\n                    type: \"alert\",\n                    button: {\n                        confirm: \"真的很抱歉 > <\"\n                    }\n                });\n            }\n\n            // Definition: 充值成功.\n            function paySucceed (result) {\n                // 创建成功弹窗.\n                livePopup({\n                    title: \"购买完成惹！\",\n                    content: \"您已经成功购买 \" + result.data.orderGold + \" 金瓜子，恭喜恭喜！\" + randomEmoji.happy(),\n                    width: \"300px\",\n                    button: {\n                        confirm: \"完成完成！\"\n                    },\n                    type: \"info\"\n                });\n\n                // 更新金瓜子.\n                seedExchangeCtrl.$fire(\"all!updateCurrency\", {\n                    gold: result.data.gold\n                });\n\n                // 更新 Bp 数量.\n                seedExchangeCtrl.$fire(\"getBp\");\n            }\n\n        }\n    }\n\n\n\n\n\n\n\n\n\n\n};\n", "/*\n *  Exchange Events By LancerComet at 18:12, 2016/1/8.\n *  # Carry Your World #\n *  ---\n *  瓜子兑换逻辑定义.\n */\n\nvar liveToast = require('../../../common/components/live-widget/live-toast/live-toast');\nvar livePopup = require('../../../common/components/live-widget/live-popup/live-popup');\nvar randomEmoji = require('../../../common/functions/func-random-emoji/random-emoji');\nvar liveQuickLogin = require('../../../common/functions/func-live-quick-login/live-quick-login');\n\nmodule.exports = {\n\n    // Definition: 使用金瓜子兑换.\n    exchangeViaGold: function (event, seedExchangeCtrl) {\n        liveQuickLogin();\n\n        var element = event.target || event.srcElement;\n        var exchangeGold = parseInt(seedExchangeCtrl.data.exchange.count.gold, 10);\n\n        if (isNaN(exchangeGold) || exchangeGold < 1) {\n            liveToast(element, \"请输入正确的数量哦 \" + randomEmoji.helpless(), true);\n            return;\n        }\n\n        $.ajax({\n            url: \"/gold/goldToSilver\",\n            type: \"GET\",\n            data: {\n                cgold: exchangeGold\n            },\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code == 0) {\n\n                    liveToast(element, \"已成功兑换 \" + result.data.csilver + \" 银瓜子！\" + randomEmoji.happy(), \"success\");\n\n                    seedExchangeCtrl.$fire(\"all!updateCurrency\", {\n                        gold: result.data.gold,\n                        silver: result.data.silver\n                    });\n\n                } else if (result.code == -400) {\n\n                    var popup = livePopup({\n                        title: \"金瓜子不够惹~\",\n                        content: \"您的金瓜子不够了，要不要充一点？\" + randomEmoji.helpless(),\n                        button: {\n                            confirm: \"葱！\",\n                            cancel: \"先不葱了~\"\n                        },\n                        width: \"320px\",\n                        onConfirm: function () {\n                            seedExchangeCtrl.$fire(\"showExchange\", \"charge\");\n                            popup.remove();\n                            popup = null;\n                        }\n                    })\n\n                } else {\n                    liveToast(element, result.msg || \"兑换出现问题，还请稍后再试，一定会好的……\" + randomEmoji.sad(), \"caution\", true);\n                }\n            },\n            error: function (result) {\n                var popup = livePopup({\n                    title: \"呜~~~……\",\n                    html: \"<p>兑换出现问题，可能是网络不通畅，也可能是炸了 \" + randomEmoji.sad() + \"，还请您稍后再试… 实在很抱歉 \" + randomEmoji.sad() + \"<br>错误原因: \" + result.statusText + \"</p>\",\n                    type: \"alert\",\n                    width: 300,\n                    onConfirm: function () {\n                        popup.remove();\n                        popup = null;\n                    }\n                });\n            }\n        })\n\n\n    },\n\n    // Definition: 使用硬币兑换.\n    exchangeViaCoin: function (event, seedExchangeCtrl) {\n        liveQuickLogin();\n        var element = event.target || event.srcElement;\n        var exchangeCoin = parseInt(seedExchangeCtrl.data.exchange.count.coin, 10);\n\n        if (isNaN(exchangeCoin) || exchangeCoin < 0) {\n            liveToast(element, \"请输入正确的数量哦 \" + randomEmoji.helpless(), true);\n            return;\n        }\n\n        $.ajax({\n            url: \"/exchange/coin2silver\",\n            type: \"POST\",\n            data: {\n                coin: exchangeCoin\n            },\n            dataType: \"JSON\",\n            success: function (result) {\n                if (result.code != 0) {\n                    liveToast(element, result.msg, \"caution\", true);\n                    return;\n                }\n                liveToast(element, \"成功兑换 \" + result.data.silver + \" 银瓜子！\" + randomEmoji.happy(), \"success\", true);\n\n                // 更新瓜子数.\n                seedExchangeCtrl.$fire(\"all!updateCurrency\");\n            },\n            error: function (result) {\n                var popup = livePopup({\n                    title: \"呜~~~……\",\n                    html: \"<p>兑换出现问题，可能是网络不通畅，也可能是炸了 \" + randomEmoji.sad() + \"，还请您稍后再试… 实在很抱歉 \" + randomEmoji.sad() + \"<br>错误原因: \" + result.statusText + \"</p>\",\n                    type: \"alert\",\n                    width: 300,\n                    onConfirm: function () {\n                        popup.remove();\n                        popup = null;\n                    }\n                });\n            }\n        })\n    }\n\n};", "/*\n *  Seed Exchange By LancerComet at 16:49, 2016/1/7.\n *  # Carry Your World #\n *  ---\n *  瓜子兑换 / 充值面板.\n */\n\nvar lazyInit = require('../../../common/functions/func-avalon-lazy-init/lazy-init');\nvar seedExchange = require('./exchange');\nvar charge = require('./charge');\n\nmodule.exports = function () {\n    \"use strict\";\n\n    avalon.ready(function () {\n\n        var seedExchangeCtrl = avalon.define({\n            $id: \"seedExchangeCtrl\",\n\n            // 节点信息对象.\n            doms: {\n\n                // Bp 兑换瓜子节点.\n                exchange: {\n                    out:false,\n                    show: false,\n                    outTimeout: null,\n\n                    open: function () {\n                        seedExchangeCtrl.$fire(\"showExchange\", \"exchange\");\n                        seedExchangeCtrl.doms.noSeed.close();\n                    },\n                    close: function () {\n                        panelClose(\"exchange\");\n                    },\n\n                    panelNow: \"gold\",\n                    panelSwitch: function (panel) {\n                        seedExchangeCtrl.doms.exchange.panelNow = panel;\n                    }\n\n                },\n\n                // 瓜子充值节点.\n                charge: {\n                    out: false,\n                    show: false,\n                    outTimeout: null,\n\n                    open: function () {\n                        seedExchangeCtrl.$fire(\"showExchange\", \"charge\");\n                        seedExchangeCtrl.doms.noSeed.close();\n                    },\n                    close: function () {\n                        panelClose(\"charge\");\n                    },\n\n                    btnText: \"立刻购买\"\n                },\n\n                // 瓜子不足提醒面板.\n                noSeed: {\n                    out: false,\n                    show: false,\n                    outTimeout: null,\n                    close: function () {\n                        panelClose(\"noSeed\");\n                    }\n                }\n            },\n\n            // 数据信息.\n            data: {\n                // 账户信息.\n                account: {\n                    gold: 0,\n                    silver: 0,\n                    biliCoin: 0\n                },\n\n                // 兑换数据.\n                exchange: {\n                    count: {\n                        gold: \"\",\n                        coin: \"\"\n                    }\n                },\n\n                // 充值数据.\n                charge: {\n                    myBp: 0,\n                    buyCount: \"\"\n                }\n            },\n\n            // 事件定义.\n            events: {\n                exchange: {\n                    viaGold: function (event) {\n                        seedExchange.exchangeViaGold(event, seedExchangeCtrl);\n                    },\n                    viaCoin: function (event) {\n                        seedExchange.exchangeViaCoin(event, seedExchangeCtrl);\n                    }\n                },\n                buyGold: buyGold\n            }\n        });\n\n        // Definition: 面板显示通用事件.\n        seedExchangeCtrl.$watch(\"showExchange\", function (panel) {\n            seedExchangeCtrl.doms[panel].show = true;\n            seedExchangeCtrl.$fire(\"all!updateCurrency\");\n            panel === \"charge\" && seedExchangeCtrl.$fire(\"getBp\");\n        });\n\n        // Definition: 瓜子不足提示事件.\n        seedExchangeCtrl.$watch(\"noSeed\", function () {\n            seedExchangeCtrl.$fire(\"showExchange\", \"noSeed\");\n        });\n\n        // Definition: 获取 BP 数量.\n        seedExchangeCtrl.$watch(\"getBp\", function () {\n            $.ajax({\n                url: \"/payCenter/getBp\",\n                type: \"GET\",\n                cache: false,\n                dataType: \"JSON\",\n                timeout: 5 * 1000,\n                success: function (result) {\n                    if (result.code != 0) {\n                        return;\n                    }\n                    seedExchangeCtrl.data.charge.myBp = result.data.bp.bp;\n                },\n                error: function (result) {\n\n                }\n            });\n        });\n\n        // Definition: 瓜子更新事件.\n        seedExchangeCtrl.$watch(\"fillCurrency\", function (value) {\n            seedExchangeCtrl.data.account.gold = value.gold;\n            seedExchangeCtrl.data.account.silver = value.silver;\n            seedExchangeCtrl.data.account.biliCoin = value.biliCoin;\n        });\n\n        // Lazy Init.\n        lazyInit($(\"#seed-exchange\")[0], seedExchangeCtrl);\n\n\n        /* Definition goes below. */\n\n        // Definition: 面板关闭方法.\n        function panelClose (panel) {\n            seedExchangeCtrl.doms[panel].out = true;\n            setTimeout(function () {\n                seedExchangeCtrl.doms[panel].show = false;\n                seedExchangeCtrl.doms[panel].out = false;\n            }, 380);\n        }\n\n        // Definition: Bp 购买金瓜子事件.\n        function buyGold (event) {\n            charge(event, seedExchangeCtrl)\n        }\n\n    });\n\n};\n", "/*\n *  Bilibili Live Room Sign Up at 15:22, 2016.01.05.\n *  ---\n *\n *  描述：\n *  ---\n *  本文件为直播房间页面签到模块 JS 入口文件.\n *  本文件不编写任何逻辑, 仅做引用.\n */\n\nmodule.exports = function () {\n    require(\"./javascripts/sign-up.js\")();  // 签到\n};", "/*\n *  Bilibili Live Room Sign Up at 12:11, 2015.12.23.\n *  ---\n *\n *  描述：\n *  ---\n *  签到面板相关逻辑\n *\n */\n\n//var liveQuickLogin = require(\"liveQuickLogin\");\nvar liveQuickLogin =  require(\"../../../../common/functions/func-live-quick-login/live-quick-login\");\n\nmodule.exports = function () {\n    // 房间签到 VM\n    var signUpVM = avalon.define({\n        $id: \"signUpCtrl\",\n        signInShow: false,\n        signInData: {\n            status: 0\n        },\n        loggedIn: false,\n        // 签到\n        doSign: function (event) {\n            event.stopPropagation();\n            liveQuickLogin();\n            if (signUpVM.signInData.status) {\n                signUpVM.signInShow = !signUpVM.signInShow;\n            } else {\n                $.ajax({\n                    url: \"/sign/doSign\",\n                    type: \"get\",\n                    dataType: \"json\",\n                    success: function(result) {\n                        if (result.code == 0) {\n                            signUpVM.signInData = result.data;\n                            signUpVM.signInShow = true;\n                            signUpVM.signInData.status = 1;\n\n                            $(\"#room-left-sidebar .small-wrap .sign\").attr(\"data-label\", \"已签到\");\n\n                            // 签到成功后 3 秒关闭签到面板\n                            setTimeout(function () {\n                                signUpVM.signInShow = false;\n                            }, 3000)\n                        }\n                    }\n                });\n            }\n\n        },\n\n        // 我的任务\n        myTask: function () {\n            liveQuickLogin();\n            window.open('/i/myTask', '_blank');\n        }\n    });\n\n    // Watch 已签到天数，更新进度条\n    signUpVM.$watch(\"signInData.hadSignDays\", function (value) {\n        var widthValue = (value < 20) ? (value / 20 * 100) : 100;\n        $(\".sign-in-panel .progress-bar-wrap .progress-data\").width(widthValue + \"%\")\n    });\n\n    // 获取签到信息\n    function getSignInfo () {\n        // 用户如果未登陆，则不发送获取签到信息的请求\n        if (document.cookie.indexOf(\"DedeUserID\") < 0) {\n            return false;\n        }\n        signUpVM.loggedIn = true;\n        $.ajax({\n            url: \"/sign/GetSignInfo\",\n            type: 'get',\n            dataType: \"json\",\n            success: function(result) {\n                if (result.code == 0) {\n                    signUpVM.signInData = result.data;\n                    if (result.data.status) {\n                        $(\"#room-left-sidebar .small-wrap .sign\").attr(\"data-label\", \"已签到\");\n                    }\n                }\n            }\n        });\n    }\n\n    // 执行获取签到信息函数\n    getSignInfo();\n\n    $(function () {\n        // 签过到后点击 document 可以隐藏签到面板\n        $(document).on(\"click\", function () {\n            signUpVM.signInShow = false;\n        });\n    });\n};\n\n\n\n", "/*\n *  Treasure Box Transferred by LancerComet at 19:16, 2016/1/7.\n *  # Carry Your World #\n *  ---\n *  作死宝箱.\n */\n\nvar liveRoomFuncs = require('../../room-javascripts/live-room-funcs');\nvar liveToast = require('../../../common/components/live-widget/live-toast/live-toast');\nvar randomEmoji = require('../../../common/functions/func-random-emoji/random-emoji');\nvar liveQuickLogin = require('../../../common/functions/func-live-quick-login/live-quick-login');\n\n// window.treasureRestore 为恢复宝箱逻辑的方法.\n// 当传入的值 restore = true 时, 进行恢复.\nmodule.exports = window.treasureRestore = function (window, restore) {\n\n    // 原封不动复制进来.\n    // 真鸡巴作死.\n\n    if (restore === true) {\n        $(\".treasure-box-panel\").remove();\n    }\n\n    // Definition: 宝箱控制器定义. 目前用于事件广播.\n    var treasureCtrl = avalon.define({\n        $id: \"treasureCtrl\"\n    });\n\n    var CountDown = liveRoomFuncs.CountDown;\n\n    // Definition: 旧版组件定义.\n    (function () {\n        window.Popup = function(options) {\n            // 备份整个传入参数.\n            this.options = options;\n\n            // 构造面板 Dom 结构. 传入参数中若 arrow = true, 则额外加入箭头样式.\n            this.el = options.arrow ? $('<div class=\"treasure-box-panel live-popup-panel\"><div class=\"tip-arrow\"><div class=\"tip-arrow-outer\"></div><div class=\"tip-arrow-inner\"></div></div><div class=\"tip-content\">' + options.content + '</div></div>').appendTo(\".room-panels\") : $('<div class=\"treasure-box-panel live-popup-panel\"><div class=\"tip-content\">' + options.content + '</div></div>').appendTo(\".room-panels\");\n            this.el.css({\n                height: options.height,\n                width: options.width\n            });\n            // 定义面板内容 Dom 引用.\n            var content = $('.tip-content, .center-tip-content', this.el);\n            content.width(options.width || 100);  // 设置面板宽度.\n            if (options.closable) {  // 关闭按钮设置.\n                var closeTip = $('<div class=\"close-btn right-top\"></div>');\n                var self = this;\n                content.prepend(closeTip);\n                closeTip.on('click', function() {\n                    self.hide();\n                });\n            }\n        };\n        window.Popup.prototype.show = function(el) {\n            this.el.removeClass(\"out\");\n            var offset = el.offset();\n            var top = (this.options.arrow || this.options.direction == 'down') ? offset.top + el.height() : offset.top - this.options.height - 10;\n            var left = (this.options.arrow || this.options.direction == 'down') ? offset.left : offset.left + 50;\n            this.el.stop(false, true).css({\n                top: top,\n                left: left\n            }).fadeIn().end();\n        };\n        window.Popup.prototype.hide = function() {\n            //this.el.stop(false, true).fadeOut().end();\n            var popup = this.el;\n            popup.addClass(\"out\");\n            setTimeout(function () {\n                popup.removeClass(\"out\");\n                popup.hide();\n            }, 380);\n        };\n\n\n    })();\n\n\n    // 宝箱\n    window.coutdownBox = null;\n    window.createTreasure = function () {\n        var $treasure = $('.treasure');\n        var $closeTreasure = $('.close-treasure-box');\n        var $treasureBox = $('.treasure-box').removeClass('animate7').addClass('animate1');\n        var $treasureCountdown = $('.treasure-count-down');\n        var getCookie = $.cookie(\"F_S_T_\" + window.UID);\n        if (getCookie == 0) {\n            $treasure.hover(function() {\n                $closeTreasure.show();\n            }, function() {\n                $closeTreasure.hide();\n            });\n            $closeTreasure.off('click').click(function() {\n                $treasureBox.hide();\n                $treasureBox.prev().hide();\n                $closeTreasure.hide();\n                $treasure.off('mouseenter').off('mouseleave');\n                $treasureCountdown.css({\n                    'cursor': 'pointer',\n                    'left': 0\n                }).click(function() {\n                    $treasureBox.show();\n                    $treasureBox.prev().show();\n                    $closeTreasure.show();\n                    $treasure.hover(function() {\n                        $closeTreasure.show();\n                    }, function() {\n                        $closeTreasure.hide();\n                    });\n                    $treasureCountdown.css({\n                        'cursor': 'default',\n                        'left': ''\n                    }).off('click');\n                });\n            });\n            if(!coutdownBox){\n                coutdownBox = new Popup({\n                    'content': '<i class=\"treasure-img close\"></i><div style=\"display: inline-block;width: 190px;padding-left: 10px;\"><h3 class=\"panel-title\">宝箱倒计时 ' + randomEmoji.happy() + '</h3><p>距离本次领取剩余 <span id=\"pop-count-down\"></span> 本次宝箱收益 <span id=\"gz-num\"></span> 银瓜子.</p><button class=\"acknowledge-btn live-btn default\">我知道了</button></div>',\n                    'width': 290,\n                    'height': 120,  // Origin: 135\n                    'closable': true,\n                    'arrow': false\n                });\n            }\n            $treasureBox.off('click').click(function() {\n                LOGINED ? coutdownBox.show($treasureBox) : liveQuickLogin();\n            });\n            $('button', coutdownBox.el).off('click').off('click').on('click', function() {\n                coutdownBox.hide();\n            });\n        } else {\n            $treasure.addClass(\"out\");\n            setTimeout(function () {\n                $treasure.hide().removeClass(\"out\");\n            }, 450);\n        }\n    };\n\n    window.LAST_COUNT_DOWN = null;\n    window.LOGINED = false;\n\n    window.countdown = function () {\n        if (LAST_COUNT_DOWN != null) { LAST_COUNT_DOWN.clearCountdown(); }\n        $.ajax({\n            url: \"/FreeSilver/getCurrentTask?r=\" + Math.random(),\n            type: 'get',\n            dataType: \"json\",\n            success: function (result) {\n                if (result.code == 0) {\n                    LOGINED = true;\n                    var silver = result.data.silver;\n                    $('#gz-num').text(silver);\n\n                    var endTime = new Date();\n                    endTime.setMinutes(endTime.getMinutes() + result.data.minute);\n                    LAST_COUNT_DOWN = new CountDown({\n                        endTime: endTime,\n                        element: $('.treasure-count-down, #pop-count-down'),\n                        callback: function () {\n                            $.ajax({\n                                url: \"/freeSilver/getSurplus?r=\"+Math.random(),\n                                type: 'get',\n                                dataType: \"json\",\n                                success: function (result) {\n                                    if(result.code !== 0){\n                                        return false;\n                                    }\n                                    var surplus = result.data.surplus;\n                                    if (surplus < 1) {\n                                        playTreasureAnimate(result.data.silver);\n                                    } else {\n                                        resetCountDown(surplus);\n                                    }\n                                }\n                            });\n                        }\n                    });\n                }\n            }\n        });\n    };\n\n    window.resetCountDown = function (surplus) {\n        if (LAST_COUNT_DOWN != null) {\n            LAST_COUNT_DOWN.clearCountdown();\n        }\n        var endTime = new Date();\n        endTime.setMinutes(endTime.getMinutes() + surplus);\n        LAST_COUNT_DOWN = new CountDown({\n            endTime: endTime,\n            element: $('.treasure-count-down, #pop-count-down'),\n            callback: function () {\n                $.ajax({\n                    url: \"/freeSilver/getSurplus?r=\"+Math.random(),\n                    type: 'get',\n                    dataType: \"json\",\n                    success: function (result) {\n                        if(result.code !== 0){\n                            return false;\n                        }\n                        var surplus = result.data.surplus;\n                        if (surplus < 1) {\n                            playTreasureAnimate(result.data.silver);\n                        } else {\n                            resetCountDown(surplus);\n                        }\n                    }\n                });\n            }\n        });\n    };\n\n\n    window.verifyBox = null;\n    window.CLICK_FLAG = 0;\n\n    window.playTreasureAnimate = function (silver) {\n        var step = 1;\n        var guazNum = silver;\n        var $treasureBox = $('.treasure-box').show();\n        $treasureBox.prev().show();\n        $('.treasure-count-down').css({\n            'cursor': 'default',\n            'left': ''\n        });\n        $('.treasure').off('mouseenter').off('mouseleave');\n        var interval = setInterval(_play, 100);\n\n        function _play() {\n            var next = step + 1;\n            $treasureBox.addClass('animate' + next).removeClass('animate' + step);\n            step = next;\n            if (step === 7) {\n                clearInterval(interval);\n            }\n        }\n        if(!window.verifyBox) {\n            window.verifyBox = new Popup({\n                'content': '<i class=\"treasure-img open\"></i><div style=\"display: inline-block;width: 180px;padding-left: 10px;\"><div id=\"silver-notice-div\"></div><input id=\"freeSilverCaptchaInput\"type=\"text\" length=\"4\" class=\"live-input material\" style=\"width: 65px;\" placeholder=\"小学算数\"><img id=\"captchaImg\" src=\"\" alt=\"算算术~\" style=\"width: 60px; height: 30px;vertical-align: top\"><a id=\"changeCaptcha\" class=\"bili-link\" href=\"javascript: void(0);\">刷新</a><button class=\"live-btn default\" id=\"getFreeSilverAward\">领取</button></div>',\n                'width': 290,\n                'height': 135,\n                'closable': true,\n                'arrow': false\n            });\n        }\n        $('#silver-notice-div').html('请输入计算结果领取 ' + guazNum + ' 银瓜子' + randomEmoji.helpless());\n        if(CLICK_FLAG == 0){\n            CLICK_FLAG = 1;\n            $(\"#freeSilverCaptchaInput\").off(\"keyup\").on(\"keyup\", function (event) {\n                event.keyCode === 13 && getFreeSilver(event);\n            });\n\n            $('button', verifyBox.el).on('click', getFreeSilver);\n        }\n\n        $treasureBox.off('click').click(function() {\n            verifyBox.show($treasureBox);\n            refreshCaptcha();\n        });\n\n        //$('input', verifyBox.el).on('focus',refreshCaptcha);\n        $(\"#captchaImg, #changeCaptcha\").on('click', refreshCaptcha);\n    };\n\n\n    // Definition: 发送请求获取瓜子.\n    window.getFreeSilver = function (e) {\n        $(\"#getFreeSilverAward\").text(\"领取中...\");\n        $.ajax({\n            url: \"/freeSilver/getAward?r=\" + Math.random(),\n            type: 'get',\n            data: {\n                captcha: $('input', verifyBox.el).val()\n            },\n            dataType: \"json\",\n            success: function(result) {\n                $(\"#getFreeSilverAward\").text(\"领取\");\n                if (result.code == 0) {\n                    liveToast($(e.currentTarget)[0], '成功领取 ' + result.data.awardSilver + ' 银瓜子！' + randomEmoji.happy(), \"success\");\n                    var silverNumb = parseInt(result.data.silver, 10);\n                    console.log(silverNumb);\n                    treasureCtrl.$fire(\"all!updateCurrency\", { silver: silverNumb });\n                    createTreasure();\n                    $('#freeSilverCaptchaInput').val('');\n                    verifyBox.hide();\n                    setTimeout(function () {\n                        countdown();\n                    }, 3000);\n                } else {\n                    liveToast($(e.currentTarget)[0], result.msg);\n                    $(\"#captchaImg\").click();\n                }\n\n            },\n            error: function() {\n                liveToast($(e.currentTarget)[0], \"系统错误，请稍后再试 \" + randomEmoji.sad() , \"error\");\n                refreshCaptcha();\n                $(\"#getFreeSilverAward\").text(\"领取\");\n            },\n            complete: function () {\n                if (LAST_COUNT_DOWN != null) {\n                    LAST_COUNT_DOWN.clearCountdown();\n                    LAST_COUNT_DOWN = null;\n                }\n            }\n        });\n    };\n\n    window.FREE_SILVER_HEART = 0;\n    window.freeSilverHeart = function () {\n        if ($.cookie('F_S_T_'+window.UID) == 1) {\n            return false;\n        }\n\n        setTimeout(function () {\n            countdown();\n        }, 3000);\n\n        FREE_SILVER_HEART = setInterval(function () {\n            $.ajax({\n                url: \"/freeSilver/heart?r=\"+Math.random(),\n                type: 'get',\n                dataType: \"json\",\n                success: function (result) {\n                    //result.data.minute = 1;  // TESTING.\n                    if ($.cookie('F_S_T_'+window.UID) == 1) {\n                        clearInterval(FREE_SILVER_HEART);\n                        return true;\n                    }\n                }\n            })\n        }, 60000);  // TESTING: 原版为 60000\n\n    };\n\n    window.refreshCaptcha = function () {\n        $(\"#captchaImg\").attr(\"src\", \"/FreeSilver/getCaptcha?t=\" + Math.random());\n    };\n\n    // 闪耀之星活动脚本载入 By [彗星.LancerComet] at 14:27, 2015.10.16.\n    // 活动结束后移除.\n    restore !== true && (function (window, undefined) {\n        console.log(\"Shining Star Treasurebox.\");\n        console.log(\"IS_STAR: \" + window.IS_STAR);\n\n        if (window.IS_STAR) {\n            $.getScript(\"http://static.hdslb.com/live-static/live-room/activity/shining-star.min.js\");\n            parseInt(window.FREE_SILVER_TIMES, 10) <= 3 && replaceFunc();\n        }\n\n        // Definition: 下次等待领取的瓜子与投票数数量.\n        var weAreGoingtoGet = {\n            vote: null,\n            seed: null\n        };\n\n        // Definition: 函数替换.\n        // 替换 live.room 中存在的函数为活动使用的函数内容.\n        function replaceFunc () {\n\n            // 闪耀之星宝箱创建方法.\n            createTreasure = function () {\n                // Definition: Necessary nodes requirement. | 节点引用定义.\n                var $treasureContainer = $(\".treasure\").addClass(\"shining-star-treasure\"),\n                    $treasureCloseBtn = $(\".close-treasure-box\"),\n                    $treasureBox = $(\".treasure-box\").removeClass('animate7').addClass('animate1'),  // 初始化样式并返回 jQuery 对象.\n                    $treasureBoxFooter = $(\".treasure-box-footer\"),\n                    $treasureCountdown = $(\".treasure-count-down\"),\n                    cookieFST = $.cookie(\"F_S_T_\" + window.UID);\n\n                // Action: Treasure events go out when cookieFst exists. | 当存在 \"F_S_T_\" 的 Cookie 时，关闭宝箱领取.\n                cookieFST ? treasureExit() : mainLogic();\n\n                /* ---- Definition go below. ---- */\n\n                // Definition: 宝箱滚粗.\n                function treasureExit () {\n                    $treasureContainer.addClass(\"out\");\n                    setTimeout(function () {\n                        $treasureContainer.hide().removeClass(\"out\");\n                    }, 450);\n                }\n\n                // Definition: 宝箱主体逻辑.\n                function mainLogic () {\n\n                    // Definition: Hover Event of $treasureContainer. | Hover 事件绑定 @ $treasureContainer.\n                    var $treasureHover = {\n                        on: function () {\n                            $treasureContainer.hover(function () { $treasureCloseBtn.show(); }, function () { $treasureCloseBtn.hide(); });\n                        },\n\n                        off: function () {\n                            $treasureContainer.off(\"mouseenter\").off(\"mouseleave\");\n                        }\n                    };\n\n                    // Definition: Countdown node style changer. | 倒计时节点样式控制.\n                    // 在最大 / 小化宝箱之后设置样式.\n                    var $countdownStyle = {\n                        toClickable: function () {\n                            $treasureCountdown.css({ \"cursor\": \"pointer\", \"left\": \"0\" });\n                        },\n                        toUnclickable: function () {\n                            $treasureCountdown.css({ \"cursor\": \"default\", \"left\": \"\" });\n                        }\n                    };\n\n                    // Definition: Countdown on-click Handler. | 计时器节点点击事件处理机.\n                    var $countdownOnClick = {\n                        on: function () {\n                            $treasureCountdown.on(\"click\", $treasureBoxCtrl.maximize);\n                        },\n                        off: function () {\n                            $treasureCountdown.off(\"click\");\n                        }\n                    };\n\n                    // Definition: Minimize & Maximize TreasureBox. | 最小 / 大化宝箱方法.\n                    // @ 当用户点击宝箱上的关闭（其实是最小化）按钮后执行最小化方法.\n                    // @ 还有相反的还原方法.\n                    var $treasureBoxCtrl = {\n                        minimize: function minimize() {\n                            $treasureBox.hide();  // 隐藏节点.\n                            $treasureBoxFooter.hide();  // 隐藏节点.\n                            $treasureCloseBtn.hide();  // 隐藏节点.\n                            $treasureHover.off();  // 解除 Hover 绑定.\n                            $countdownStyle.toClickable();  // 设置计时器节点样式: toClickable.\n                            $countdownOnClick.on();  // 开启计时器节点点击监听.\n                        },\n                        maximize: function maximize() {\n                            $treasureBox.show();  // 隐藏节点.\n                            $treasureBoxFooter.show();  // 隐藏节点.\n                            $treasureCloseBtn.show();  // 隐藏节点.\n                            $treasureHover.on();  // 开启 Hover 绑定.\n                            $countdownStyle.toUnclickable();  // 设置计时器节点样式: toUnclickable.\n                            $countdownOnClick.off();  // 解除计时器节点点击监听.\n                        }\n                    };\n\n                    // Action: 设置宝箱节点 Hover 事件.\n                    $treasureHover.on();\n\n                    // Action: 宝箱关闭（最小化）按钮设置事件监听.\n                    $treasureCloseBtn.off(\"click\").on(\"click\", $treasureBoxCtrl.minimize);\n\n                    // 来自前人的代码逻辑.\n                    // 各种污染简直看不下去.\n                    (function dirtyCode () {\n\n                        // 当没有 window.coutdownBox (泥马晕语写错了啊) 时创建这个全局变量.\n                        if (!coutdownBox) {\n                            coutdownBox = new Popup({\n                                content:\n                                '<i class=\"treasure-img close\"></i>' +\n                                '<div style=\"display: inline-block;width: 180px; padding-left: 10px;\">' +\n                                '<h3 class=\"panel-title\">宝箱倒计时 ' + randomEmoji.happy() + '</h3>' +\n                                '<p style=\"margin-top: .5em\">距离本次领取剩余时间为 <span id=\"pop-count-down\" style=\"color: #359CCB\">--:--</span>，</p>' +\n                                '<p style=\"margin-bottom: 1em\">本次宝箱可获取 <span id=\"gz-num\" style=\"color: #359CCB\"></span> 银瓜子和 <span id=\"vote-coupons\" style=\"color: #359CCB\"></span> 张投票券.</p>' +\n                                '<button class=\"acknowledge-btn live-btn default\">我知道了' +\n                                '</div>',\n                                width: 290,\n                                height: 135,\n                                closable: true,\n                                arrow: false\n                            });\n                        }\n\n                        // Action: TreasureBox on-click Event Handler. | 宝箱设置点击监听.\n                        $treasureBox.off(\"click\").on(\"click\", function () {\n                            window.LOGINED ? coutdownBox.show($treasureBox) : liveQuickLogin();\n                        });\n\n                        // Action: Set close event of close button in pop-up panel. | 设置宝箱弹出面板的关闭按钮事件.\n                        // 为何要再构造之外设置 ...\n                        $(\"button\", coutdownBox.el).off(\"click\").off(\"click\").on(\"click\", function () {\n                            coutdownBox.hide();\n                        });\n\n                    })();\n\n\n                }\n\n            };\n\n            // 闪耀之星动画变换方法.\n            // 此方法耦合度甚高, 包含了奖励领取逻辑.\n            // 架锅烧水.\n            playTreasureAnimate = function (silver) {\n                var step = 1;\n                var guazNum = silver;\n                var $treasureBox = $('.treasure-box').show();\n                $treasureBox.prev().show();\n                $('.treasure-count-down').css({\n                    'cursor': 'default',\n                    'left': ''\n                });\n                $('.treasure').off('mouseenter').off('mouseleave');\n                var interval = setInterval(_play, 100);\n\n                function _play() {\n                    var next = step + 1;\n                    $treasureBox.addClass('animate' + next).removeClass('animate' + step);\n                    step = next;\n                    if (step === 7) {\n                        clearInterval(interval);\n                    }\n                }\n                if(!verifyBox) {\n                    window.verifyBox = new Popup({\n                        'content': '<i class=\"treasure-img open\" style=\"background-image: url(http://static.hdslb.com/live-static/images/shining-star/treasure-box-large.png); background-size: contain\"></i>' +\n                        '<div style=\"display:none;\" id=\"shining-star-verify\"></div>'+\n                        '<div style=\"display: inline-block; width: 180px;padding-left: 10px;\">' +\n                        '<div id=\"silver-notice-div\"></div>' +\n                        '<input id=\"freeSilverCaptchaInput\" type=\"text\" length=\"4\" class=\"live-input material\" style=\"width: 65px;\" placeholder=\"小学算数\">' +\n                        '<img id=\"captchaImg\" src=\"\" alt=\"算算术~\" style=\"width: 60px; height: 30px;vertical-align: top\">' +\n                        '<a id=\"changeCaptcha\" href=\"javascript: void(0);\" class=\"bili-link\">刷新</a>' +\n                        '<button class=\"live-btn default\" id=\"getFreeSilverAward\">领取</button>' +\n                        '</div>',\n                        'width': 280,\n                        'height': 135,\n                        'closable': true,\n                        'arrow': false\n                    });\n                }\n                $('#silver-notice-div').html('请输入计算结果领取 <span style=\"color: #4fc1e9\">' + weAreGoingtoGet.seed + '</span> 银瓜子和 <span style=\"color: #4fc1e9\">' + weAreGoingtoGet.vote + \"</span> 投票券.\").css({\"padding-right\": \"10px\", \"margin-bottom\": \"10px\"});\n                if(CLICK_FLAG == 0){\n                    CLICK_FLAG = 1;\n                    $(\"#freeSilverCaptchaInput\").off(\"keyup\").on(\"keyup\", function (event) {\n                        if (event.keyCode !== 13) { return }\n                        getFreeSilverVote(event);\n                    });\n                    $('button', verifyBox.el).on('click', getFreeSilverVote);\n\n                    function getFreeSilverVote (e) {\n                        $(\"#getFreeSilverAward\").text(\"领取中...\");\n                        $.ajax({\n                            url: \"/freeSilver/getAward?r=\" + Math.random() + \"&roomid=\" + window.ROOMID,\n                            type: 'get',\n                            data: {\n                                captcha: $('input', verifyBox.el).val()\n                            },\n                            dataType: \"json\",\n                            success: function(result) {\n                                $(\"#getFreeSilverAward\").text(\"领取\");\n                                if (result.code == 0) {\n                                    liveToast($(e.currentTarget)[0], '成功领取 ' + result.data.awardSilver + ' 银瓜子和 ' + result.data.getVote + ' 投票券！' + randomEmoji.happy(), \"success\");\n                                    var silverNumb = parseInt(result.data.silver, 10);\n                                    window.starVote = {\n                                        voteCount: result.data.vote,\n                                        voteChance: result.data.svote\n                                    };\n                                    treasureCtrl.$fire(\"all!updateCurrency\", { silver: silverNumb });\n                                    createTreasure();\n                                    $('#freeSilverCaptchaInput').val('');\n                                    verifyBox.hide();\n                                    $(\".gift-item[data-gift-id=11] .num-hinter\").css({\"background-position\": result.data.vote * (-16) + \"px 0\"});\n                                    $(\".star-vote-vote-count\").text(result.data.vote);\n                                    $(\".star-vote-voted-num\").text(18 - parseInt(result.data.svote, 10));\n                                    $(\".star-vote-chance\").text(result.data.svote);\n                                    setTimeout(function () {\n                                        countdown();\n                                    }, 3000);\n                                    // 如果有 Cookie 隐藏宝箱并提示.\n                                    if ($.cookie(\"F_S_T_\" + window.UID)) {\n                                        $(\".treasure\").fadeOut();\n\n                                        var tips = livePopup({\n                                            title: \"真不容易！\",\n                                            html: \"<p class='text-center'>今天的投票券已经领完了！<br/>请明天再接再厉哦！(●'◡'●)ﾉ♥</p>\",\n                                            type: \"info\",\n                                            width: 300,\n                                            onConfirm: function () {\n                                                tips.remove();\n                                                tips = null;\n                                            }\n                                        });\n                                    }\n                                } else {\n                                    liveToast($(e.currentTarget)[0], result.msg);\n                                    $(\"#captchaImg\").click();\n                                    $(\"#getFreeSilverAward\").text(\"领取\");\n                                }\n\n                            },\n                            error: function() {\n                                liveToast($(e.currentTarget)[0], \"系统错误，请稍后再试 \" + randomEmoji.sad(), \"error\");\n                                $(\"#getFreeSilverAward\").text(\"领取\");\n                                refreshCaptcha();\n                            },\n                            complete: function () {\n                                if (LAST_COUNT_DOWN != null) {\n                                    LAST_COUNT_DOWN.clearCountdown();\n                                    LAST_COUNT_DOWN = null;\n                                }\n                            }\n                        });\n                    }\n                }\n\n                $treasureBox.off('click').click(function() {\n                    verifyBox.show($treasureBox);\n                    refreshCaptcha();\n                });\n\n                //$('input', verifyBox.el).on('focus',refreshCaptcha);\n                $(\"#captchaImg, #changeCaptcha\").on('click', refreshCaptcha);\n            };\n\n            // 闪耀之星倒计时方法.\n            // 架锅烧水.\n            countdown = function () {\n                if (LAST_COUNT_DOWN != null) {\n                    LAST_COUNT_DOWN.clearCountdown();\n                }\n                $.ajax({\n                    url: \"/FreeSilver/getCurrentTask?roomid=\" + window.ROOMID + \"&r=\" + Math.random(),\n                    type: 'get',\n                    dataType: \"json\",\n                    success: function (result) {\n                        if (result.code == 0) {\n                            LOGINED = true;\n                            var silver = result.data.silver;\n                            $('#gz-num').text(silver);\n                            $(\"#vote-coupons\").text(result.data.vote);\n                            weAreGoingtoGet.seed = result.data.silver;\n                            weAreGoingtoGet.vote = result.data.vote;\n\n                            //result.data.minute = 1;  // TESTING.\n\n                            //  如果大于 3 次但宝箱还未消失，启动还原方法.\n                            if (result.data.times > 3 && !$.cookie(\"F_S_T_\" + window.UID)) {\n                                window.restoreOriginalFunc();\n                                var tips = livePopup({\n                                    title: \"真不容易！\",\n                                    html: \"<p class='text-center'>今天的投票券已经领完了！<br/>请明天再接再厉哦！(●'◡'●)ﾉ♥</p>\",\n                                    type: \"info\",\n                                    width: 300,\n                                    onConfirm: function () {\n                                        tips.remove();\n                                        tips = null;\n                                    }\n                                });\n                            }\n\n                            var endTime = new Date();\n                            endTime.setMinutes(endTime.getMinutes() + result.data.minute);\n                            LAST_COUNT_DOWN = new CountDown({\n                                endTime: endTime,\n                                element: $('.treasure-count-down, #pop-count-down'),\n                                callback: function () {\n                                    $.ajax({\n                                        url: \"/freeSilver/getSurplus?r=\"+Math.random(),\n                                        type: 'get',\n                                        dataType: \"json\",\n                                        success: function (result) {\n                                            if(result.code !== 0){\n                                                return false;\n                                            }\n                                            var surplus = result.data.surplus;\n                                            if (surplus < 1) {\n                                                playTreasureAnimate(result.data.silver);\n                                            } else {\n                                                resetCountDown(surplus);\n                                            }\n                                        }\n                                    });\n                                }\n                            });\n                        }\n                    }\n                });\n            };\n\n        }\n\n    })(window);\n\n    // Initizalition.\n    $(function () {\n        freeSilverHeart();\n        createTreasure();\n    });\n\n};\n", "module.exports = function () {\n    return require(\"./javascripts/wish.js\")();  // 我的关注\n};", "/**\n * Created by user on 2016/1/13.\n */\n\nvar liveQuickLogin = require(\"./../../../../common/functions/func-live-quick-login/live-quick-login.js\");\nvar liveToast = require(\"./../../../../common/components/live-widget/live-toast/live-toast.js\");\nvar setNum = require('./../../../../common/functions/func-setnum/set-num.js');\nmodule.exports = function() {\n    /**\n     * 弹出层类\n     * */\n    function Dialog() {\n        this.$el = {};\n        this.doms = {};\n        this.datas = {};\n        this.init();\n    }\n    Dialog.prototype = {\n        template: function() {\n            return '' +\n                '<div class=\"wish-dialog\" id=\"wis-dialog\">' +\n                '<div class=\"dialog-main\">' +\n                '<div class=\"wish-top\">' +\n                '<div class=\"wish-top-icon\"></div>' +\n                '<span class=\"wish-ok-text\"><a href=\"/lottery/lotteryResult\" target=\"_blank\" class=\"ok-target\">愿望达成</a></span>' +\n                '</div>' +\n                '<div class=\"wish-main\">' +\n                '<p class=\"wish-des\"> 在绘马上画上自己的心愿（人家才不知道什么痛绘马呢），说不定就能梦想成真。每晚21点会从许愿的用户中抽取中奖用户，购买越多则中奖概率和最终奖励也会相应增加！</p>' +\n                '<div class=\"wish-prize\">' +\n                '<dl class=\"wish-prize-list\">' +\n                '<dt>中奖奖励</dt>' +\n                '<dd>' +\n                '一等奖 1份 <em class=\"prize-content\"><span class=\"first-prize\">' + this.formatNum(this.datas.first) + '</span>银瓜子</em>' +\n                '</dd>' +\n                '<dd>' +\n                '二等奖 10份 <em class=\"prize-content\">每份<span class=\"second-prize\">'  + this.formatNum(this.datas.second) +  '</span>银瓜子</em>' +\n                '</dd>' +\n                '<dd>' +\n                '三等奖 <em class=\"third-prize-num\">' + this.datas.third + '</em>份 <em class=\"prize-content\">每份B坷垃1个</em>' +\n                '</dd>' +\n                '</dl>' +\n                '</div>' +\n                '<div class=\"wish-set\">' +\n                '<div class=\"wish-num-box\">' +\n                '<p>绘马总数：<em class=\"wish-num\" id=\"total-wish-num\">' + this.datas.totalnum + '</em></p>' +\n                '<p>我挂上的绘马：<em class=\"wish-num\" id=\"my-wish-num\">' + this.datas.num + '</em></p>' +\n                '</div>' +\n                '<div class=\"wish-buy\">' +\n                '<div class=\"wish-buy-content\">' +\n                '购买数量：<input type=\"text\" class=\"ipt-num\" value=\"1\">' +\n                '<span class=\"wish-buy-type\">' +\n                '<ul>' +\n                '<li class=\"wish-buy-item\"><input checked=\"checked\" type=\"radio\" name=\"buy-type\" data-type=\"silver\" id=\"type-silver\"><label for=\"type-silver\">银瓜子</label></li>' +\n                '<li class=\"wish-buy-item\"><input type=\"radio\" name=\"buy-type\" data-type=\"gold\" id=\"type-gold\"><label for=\"type-gold\">金瓜子</label></li>' +\n                '</ul>' +\n                '</span>' +\n                '</div>' +\n                '<div class=\"wish-buy-tip\"><span class=\"buy-tip-icon\"></span>每个绘马需要2000银/金瓜子</div>' +\n                '</div>' +\n                '<div class=\"wish-set-btn\">' +\n                '挂绘马' +\n                '</div>' +\n                '</div>' +\n                '</div>' +\n                '</div>' +\n                '<div class=\"close\"></div>' +\n                '</div>' +\n                '' +\n                ''\n        },\n        $dialog: \"\",\n        $mask: \"\",\n        csses: {\n            \"iptNum\": \".ipt-num\",\n            \"btnBuy\": \".wish-set-btn\",\n            \"totalNum\": \"#total-wish-num\",\n            \"myNum\": \"#my-wish-num\",\n            \"firstNum\": \".first-prize\",\n            \"secondNum\": \".second-prize\",\n            \"thirdPrizeNum\": \".third-prize-num\"\n        },\n        init: function() {\n            this.$el = $(\"<div style='opacity:0'></div>\").appendTo(\".wish-panel\");\n            this.bindEvent();\n        },\n        render: function() {\n            this.$el.html();\n            this.$dialog = $(this.template());\n            this.$mask = $(\"<div class='mask'></div>\");\n            this.$el.append(this.$dialog).append(this.$mask);\n\n            this.setDoms();\n        },\n        setDoms: function() {\n            var $el = this.$el,\n                csses = this.csses;\n\n            this.doms = {\n                $iptNum: $(csses.iptNum, $el),\n                $btnBuy: $(csses.btnBuy, $el),\n                $totalNum: $(csses.totalNum, $el),\n                $myNum: $(csses.myNum, $el),\n                $firstNum: $(csses.firstNum, $el),\n                $secondNum: $(csses.secondNum, $el),\n                $thirdPrizeNum: $(csses.thirdPrizeNum, $el)\n            };\n        },\n        show: function(data) {\n            this.datas = data;\n            this.render();\n            this.setStyle();\n            this.setPosition();\n            this.$el.animate({\n                opacity: 1\n            }, 200);\n        },\n        hide: function() {\n            var self = this;\n\n            this.$el.animate({\n                opacity: 0\n            }, 200, function() {\n                self.$el.html(\"\").css(\"opacity\", 1);\n            });\n        },\n        setPosition: function() {\n            var allWidth = document.documentElement.clientWidth,\n                allHeight = document.documentElement.clientHeight,\n                dialogWidth = this.$dialog.width(),\n                dialogHeight = this.$dialog.height(),\n                top,\n                left,\n                cssData;\n\n\n            top = allHeight / 2 -  dialogHeight / 2;\n            left = allWidth / 2 - dialogWidth / 2;\n\n            if (top < 0) {\n                top = top * 2\n\n            }\n\n            cssData = {\n                width: 750,\n                position: \"fixed\",\n                zIndex: 1100,\n                left: left,\n                top: top\n            }\n\n            this.$dialog.css(cssData)\n        },\n\n        /**\n         * 切换大小屏的版本\n         * */\n        setStyle: function() {\n            var clientHeight = document.documentElement.clientHeight;\n\n            if (clientHeight < 750) {\n                this.$dialog.addClass(\"min-dialog\");\n            } else {\n                this.$dialog.removeClass(\"min-dialog\");\n            }\n        },\n        buy: function() {\n            var self = this,\n                $coin = $(\"[name=buy-type]\", this.$el).filter(\"[checked]\"),\n                coinType = $coin.data(\"type\"),\n                $num = this.doms.$iptNum,\n                num = $num.val();\n\n            if (!this.checkNum()) {\n                $num.focus().addClass(\"error\");\n                liveToast(self.doms.$btnBuy, \"请输入正确的数字哦~ (●'◡'●)ﾉ♥\", \"error\");\n            } else {\n                this.ajaxBuy({\n                    coinType: coinType,\n                    num: num\n                });\n            }\n\n        },\n        ajaxBuy: function(param) {\n            var self = this;\n\n            $.ajax({\n                type: \"post\",\n                url: \"/lottery/buy\",\n                data: {\n                    coinType: param.coinType,\n                    num: param.num,\n                    token: $.cookie(\"LIVE_LOGIN_DATA\") || \"\"\n                },\n                success: function(data) {\n                    var dataJSON = $.parseJSON(data);\n\n                    if (dataJSON.code === 0) {\n                        self.buySuccess(dataJSON.data);\n                    } else {\n                        self.buyError(dataJSON.msg);\n                    }\n                }\n            });\n        },\n        buySuccess: function(data) {\n            var self = this;\n\n            liveToast(this.doms.$btnBuy[0], \"购买成功\", \"success\", false);\n            refreshAccount(data);                           // 刷新余额\n\n            // 重新获取绘马数量\n            ajaxGetWishNum(function(data) {\n                var doms = self.doms;\n\n                doms.$totalNum.text(data.totalnum);\n                doms.$myNum.text(data.num);\n                doms.$firstNum.text(self.formatNum(data.first));\n                doms.$secondNum.text(self.formatNum(data.second));\n                doms.$thirdPrizeNum.text(data.third);\n            })\n        },\n        buyError: function(msg) {\n            liveToast(this.doms.$btnBuy[0], msg, \"error\", false);\n        },\n        checkNum: function() {\n\n            var $num = this.doms.$iptNum,\n                num = $num.val(),\n                flag = true;\n\n            if (!num || /[^0-9]/.test(num) ) {\n                flag = false;\n            }\n\n\n            if (flag) {\n                $num.removeClass(\"error\");\n            } else {\n                $num.addClass(\"error\");\n            }\n\n            return flag;\n        },\n        formatNum: function(num) {\n            var str = \"\",\n                dotNum;\n\n            if (num >= 10000) {\n                dotNum = num / 10000;\n                str = dotNum.toString().replace(/(\\d+)(\\.)?(\\d+)/, function (a, b, c, d) {\n                    var dot;\n\n                    if (c) {\n                        dot = d.toString().substring(0, 1);\n                        return b + (dot == 0 ? \"\" : (\".\" + dot))\n                    } else {\n                        return a\n                    }\n                });\n\n                str += \"万\";\n            } else {\n                str = num;\n            }\n\n            return str;\n        },\n        bindEvent: function() {\n            var self = this,\n                doms = this.doms,\n                $el = this.$el,\n                resizeTid = 0;\n\n            $el.on(\"keyup\", \".ipt-num\", function() {\n                self.checkNum();\n            });\n\n            $el.on(\"click\", \".wish-set-btn\", function() {\n                self.buy();\n            });\n\n            $el.on(\"click\", \".close\", function() {\n                self.hide();\n            });\n\n            $el.on(\"click\", \".mask\", function() {\n                self.hide();\n            });\n\n            $(window).resize(function() {\n                if (resizeTid) {\n                    clearTimeout(resizeTid);\n                }\n\n                resizeTid = setTimeout(function() {\n                    if (self.$el.html()) {\n\n                        self.setStyle();\n                        self.setPosition();\n                    }\n                }, 50);\n            });\n        }\n    };\n\n\n    /**\n     * 更新余额\n     * */\n    function refreshAccount(data) {\n        avalon.vmodels[\"giftCtrl\"].$fire(\"all!updateCurrency\", {\n            gold: data.gold,\n            silver: data.silver\n        });\n    }\n\n\n    /**\n     * 获取绘马数量\n     * */\n    function ajaxGetWishNum(cb) {\n        var cb = cb || function() {};\n\n        $.ajax({\n            url: \"/lottery/index\",\n            cache: false,\n            success: function(data) {\n                var dataJSON = $.parseJSON(data);\n\n                if (dataJSON.code === 0) {\n                    cb(dataJSON.data);\n                }\n            }\n        });\n    }\n\n\n\n    var dialog = new Dialog();\n    return {\n        show: function() {\n            liveQuickLogin();\n\n            if (!dialog.$el.html()) {\n                ajaxGetWishNum(function(data) {\n                    dialog.show(data)\n                });\n            }\n        }\n    }\n};\n\n", "/*\n *  Live Room Main Script File By LancerComet at 10:57, 2015/12/15.\n *  # Carry Your World #\n *  ---\n *\n *  描述:\n *  ---\n *  这是 Live Room 主入口文件. (Browserify)\n *  请在此处引用编写好的模块文件, **切勿**在此文件中直接编写业务逻辑.\n *  使用 Browserify 对此文件进行打包将生成首页完整的 JavaScript 文件.\n *  Browserify 遵循 Common.JS 编写规范.\n *\n *  Common.JS 的快速使用方法:\n *  ---\n *   - JS 的逻辑使用单独的 .js 文件进行编写并存放.\n *   - 在单独的模块文件中, 使用 \"module.exports = ...\" 将逻辑进行导出, 可以导出任何东西, 数字、字符串、对象、函数都可以.\n *     (例: \"bilibili.js\" 文件, 内容为 module.exports = \"Bilibili\")\n *   - 模块使用 \"var 啥啥 = require('模块文件')\" 进行引入, \"啥啥\" 就会成为这个模块导出的那个东西.\n *     (例: var a = require(\"bilibili\"), 那么 a 就等于 \"Bilibili\")\n *\n *  所以本文件看起来应该像:\n *  ---\n *   var 一些设置 = require(\"./设置文件.js\");        // 将 \"设置文件.js\" 中的内容赋值给 \"一些设置\".\n *   require(\"./全局方法.js\")();                    // 直接执行了 \"全局方法.js\" 所导出的函数.\n *   require(\"./首页播放器逻辑.js\")();               // 同上... (´･_･`)\n *   require(\"./推荐位逻辑.js\")();\n *   require(\"./公告组件逻辑.js\")();\n *   require(\"./签到逻辑.js\")();\n *\n */\n\n// 通用配置引用.\n// =================\nrequire(\"./../common/app-config/app-config\").avalonConfig();  // 配置 Avalon.\nrequire(\"./../common/app-config/avalon-filters\")();  // 配置 Avalon 过滤器.\nrequire(\"./../common/app-config/app-config\").globalConfig(window);  // 程序全局配置.\nrequire('../common/functions/func-number-tofixed/number-tofixed')();  // 设置 toFixed1 原型方法.\n\n// 通用方法引用.\n// =================\nrequire(\"../common/functions/func-number-tofixed/number-tofixed\")();  // Number 原型方法扩充.\nrequire(\"./../common/live-service/live-service-ctrl\")();  // 公共广播控制器引用.\n\n\n// 通用模块引用.\n// =================\nrequire(\"../common/components/live-top-navigator/intro-scripts\")();  // 站点顶栏模块入口文件引用.\n\n\n// 房间页模块引用.\n// =================\nrequire(\"./room-javascripts/live-room-init\")(window);  // 房间页初始化文件.\nrequire(\"./components/gift-section/intro-javascripts.js\")();  // 房间送礼节点模块.\nrequire(\"./components/live-room-sidebar-left/intro.js\")();  // 房间页侧边栏.\nrequire(\"./components/my-attention/intro.js\")();  // 我的关注模块.\nrequire(\"./components/sign-up/intro.js\")();  // 签到模块.\nrequire(\"./room-javascripts/live-room-funcs\").topNavOnScroll(window);  // 顶栏滚动监视模块.\nrequire(\"./components/seed-exchange/seed-exchange\")();  // 瓜子兑换 & 购买面板.\nrequire(\"./../common/components/live-feedback/live-feedback\")();  // 反馈表格初始化函数.\nrequire(\"./room-javascripts/live-room-funcs\").greeting();  // 欢迎信息.", "/*\n *  Live Room Flash External Call Functions By LancerComet at 16:11, 2015/12/23.\n *  # Carry Your World #\n *  ---\n *  Flash 全局方法定义.\n */\n\nvar explorerDetective = require('../../common/functions/func-explorer-detective/explorer-detective')();\n\nmodule.exports = function (window) {\n\n    // Definition: Flash 用 Avalon 控制器.\n    var ctrlByFlash = avalon.define({\n        $id: \"ctrlByFlash\"\n    });\n\n\n    // Definition: Flash 全屏模式获取弹幕颜色 By LancerComet at 13:59, 2015.11.16.\n    // 此方法供 Flash 主动调用，无需前端手动触发.\n    window.getDanmuColor = function () {\n        return window.colorfulDanMu.currentColor;\n    };\n\n    // Definition: Flash 设置房间观看人数.\n    // 此方法供 Flash 主动调用，无需前端手动触发.\n    window.PlayerSetOnline = function (data) {\n        data = parseInt(data, 10) < 0 ? 1 : data;\n        avalon.ready(function () {\n            ctrlByFlash.$fire(\"all!setViewerCount\", data);  // Fire to headInfoCtrl.\n        });\n    };\n\n    // Definition: Protocol 调用函数.\n    // 此方法供 Flash 主动调用，无需前端手动触发.\n    // 在支持 Worker 的非 IE 浏览器中（IE 使用 Blob 的内嵌 Worker 拥有安全策略限制且 IE 不需要做此项优化）将使用 Worker.\n    // Worker 使用 String -> Blob -> DataURL 的方式进行嵌入引用来避免跨域问题.\n    (function serverCallback () {\n        var msgArr = null, danmuWorker = null;\n\n        // 非 IE 的现代浏览器中使用 Worker.\n        // Firefox 在处理这段 WebWorker 时会造成内存泄漏, 在修复之间暂时不使用.\n        var useWorker = (typeof Worker === \"function\" && explorerDetective.indexOf(\"IE\") < 0 && explorerDetective.indexOf(\"Firefox\") < 0) ;\n        if (useWorker) {\n\n            // workerJS 来自文件 live-room-danmu-worker.js.\n            var workerJS = ['var msgArr={now:[],temp:[],aveSpeed:80};setInterval(function(){msgArr.now=msgArr.now.concat(msgArr.temp.splice(0)),msgArr.aveSpeed=Math.ceil(1e3/msgArr.now.length)},1e3),onmessage=function(e){msgArr.temp.push(e.data)},function e(){postMessage(msgArr.now.shift()),setTimeout(e,msgArr.aveSpeed)}();'];\n            var workerJSBlob = new Blob(workerJS, {type: \"text/javascript\"});\n\n            danmuWorker = new Worker(window.URL.createObjectURL(workerJSBlob));\n\n            danmuWorker.onmessage = function (event) {\n                var msgData = event.data;\n                //if (msgData) {\n                //    consoleText.log(\"Danmu Worker onMessage:\");\n                //    consoleText.log(msgData);\n                //}\n                msgData && msgData.cmd && protocol[msgData.cmd] && protocol[msgData.cmd](msgData);\n            };\n\n            workerJS = workerJSBlob = null;\n\n        } else {\n            // IE 与不支持 Worker 的浏览器使用计时器.\n            msgArr = { now: [], temp: [], aveSpeed: 80 };\n\n            setInterval(function() {\n                msgArr.now = msgArr.now.concat(msgArr.temp.splice(0));\n                msgArr.aveSpeed = Math.ceil(1000 / msgArr.now.length);\n            }, 1000);\n\n            function showMsg () {\n                var msgData = msgArr.now.shift();\n                msgData && msgData.cmd && protocol[msgData.cmd] && protocol[msgData.cmd](msgData);\n                setTimeout(showMsg, msgArr.aveSpeed);\n            }\n\n            showMsg();\n        }\n\n        window.server_callback = function server_callback (json) {\n            console.log(\"server_callback\");\n            try {\n                if (useWorker) {\n                    danmuWorker.postMessage($.parseJSON(json));\n                } else {\n                    msgArr.temp.push($.parseJSON(json));\n                }\n            } catch (tryErr) {\n                // Do nothing.\n            }\n        };\n\n        // The old fashion:\n        // ==========================\n        //$(window).on(\"blur\", function () {\n        //    $(window).on(\"focus\", danmuWindowFocus);\n        //});\n        //\n        //function danmuWindowFocus () {\n        //    if (msgArr.now.length > 100) {\n        //        msgArr.now = msgArr.now.splice(0, 100);\n        //    }\n        //    $(window).off(\"focus\", danmuWindowFocus);\n        //}\n    })();\n\n\n    // Definition: 添加本地聊天记录.\n    // 此方法提供至全局供 Flash 调取.\n    window.addMessage = function (json) {\n        console.log(\"addMessage\");\n        ctrlByFlash.$fire(\"all!addDanmu\", json);\n    };\n\n\n    // Definition: 弹出 B 坷垃投喂窗口.\n    // 此方法提供至全局供 Flash 调取. 真 JB 蛋碎.\n    window.showBkela = function () {\n        $(\".gift-item.gift-3\").click();\n    };\n\n\n    // Definition: Flash 关注房间事件.\n    // 此方法提供至全局供 Flash 调取.\n    window.flashAttendRoom = function () {\n        $(\".attention-btn-ctrl\").find(\".btn-transition\").click();\n    };\n\n    // Definition: Flash 网页全屏.\n    window.player_fullwin = function (status) {\n        console.log(\"Player Fullscreen: \" + status);\n        status ? $(\"body\").addClass(\"player-full-win\") : $(\"body\").removeClass(\"player-full-win\");\n    };\n\n};\n", "/*\n *  Live Room Functions By LancerComet at 16:58, 2016/1/5.\n *  # Carry Your World #\n *  ---\n *  房间页独立功能定义模块.\n *\n */\n\nvar appConfig = require('../../common/app-config/app-config');\nvar typeAdjust = require('../../common/functions/func-type-adjust/type-adjust');\nvar explorerDetective = require('../../common/functions/func-explorer-detective/explorer-detective');\n\n\n// Definition: 房间禁言倒计时方法.\n// 将设置一个计时器, 在节点中设置时间显示.\n// Usage: new CountDown(...) || CountDown(...)\n/*\n *  Param: {\n *    endTime: Date (TimeStamp),  // 倒计时结束时间.\n *    element: HTML Dom || jQuery Element,  // 倒计时显示节点.\n *    callback: Function  // 完成时回调.\n *  }\n */\n// ================================\nfunction CountDown (param) {\n\n    // 强制返回 \"实例\".\n    if (!(this instanceof CountDown)) {\n        return new CountDown(param);\n    }\n\n    var dateNow = new Date();\n    var endTime = param.endTime;\n\n    if (!endTime || !(endTime instanceof Date) || endTime.getTime() <= dateNow.getTime()) {\n        consoleText.log(appConfig.consoleText.error + \"禁言时间设置错误.\");\n    }\n\n    // Definition: 倒计时定义.\n    var interval = setInterval(function () {\n        var ms = endTime.getTime() - dateNow.getTime();  // 倒计时剩余总时间: 毫秒.\n        var mm = Math.floor(ms / 60 / 1000); // 倒计时剩余总时间: 分钟.\n        var s = ms - (mm * 60 * 1000); // 倒计时秒数零头毫秒数: 总毫秒时间 - 总分钟取整时间\n        var ss = Math.floor(s / 1000); // 倒计时秒数零头秒数.\n        mm = mm < 10 ? \"0\" + mm : mm;\n        ss = ss < 10 ? \"0\" + ss : ss;\n\n        // Action: 在 HTML 中写入时间.\n        var outputTime = mm + \":\" + ss;\n        if (typeAdjust(param.element) === \"jQuery Object\") {\n            param.element.html(outputTime);\n        } else {\n            param.element.innerHTML = outputTime;\n        }\n\n        // Action: 倒计时结束.\n        if (mm == \"00\" && ss == \"00\") {\n            clearInterval(interval);\n            param.callback && param.callback();\n            return;\n        }\n\n        endTime.setSeconds(endTime.getSeconds() - 1);\n\n    }, 1000);\n\n    this.countDown = interval;\n}\nCountDown.prototype.clearCountdown = function () {\n    clearInterval(this.countDown);\n};\n// ================================\n\n\n\n\n// Definition: 房间禁言节点处理函数.\n// ================================\nvar roomSilentTimer = null;  // Definition: 房间禁言计时器.\nvar $silentMerge = $(\".room-silent-merge\");\nvar roomSilent = {\n    on: function (hintMsg, endTime) {\n        roomSilentTimer && roomSilentTimer.clearCountdown();\n        roomSilentTimer = CountDown({\n            endTime: endTime,\n            element: $silentMerge.find(\".count-down\"),\n            callback: function () {\n                $silentMerge.fadeOut(200);\n            }\n        });\n        $silentMerge.show().find(\".hint-text\").text(hintMsg);\n    },\n    off: function () {\n        roomSilentTimer.clearCountdown();\n        $silentMerge.fadeOut(200);\n    }\n};\n// ================================\n\n\n\n\n// Definition: 获取历史弹幕消息.\n// ================================\nvar getHistoryDanmu = function (vmodel) {\n    $.ajax({\n        url: \"/ajax/msg\",\n        type: \"POST\",\n        data: {\n            roomid: window.ROOMID\n        },\n        dataType: \"JSON\",\n        timeout: 5000,\n        success: function (result) {\n            if (result.code == 0) {\n\n                // Action: 遍历房间消息.\n                for (var i = 0, j = result.data.room.length; i < j; i++) {\n\n                    // Definition: 单条消息.\n                    var item = result.data.room[i];\n\n                    // Definition: 消息数据对象定义. 结构将转换为 Protocol 中的 JSON 结构然后发送至弹幕.\n                    var json = { info:[] };\n                    json.info[0] = [];\n                    json.info[0][5] = null;  // RND, 设置为 null.\n                    json.info[1] = item.text;  // 聊天内容.\n                    json.info[2] = [];\n                    json.info[2][0] = item.uid;  // UID\n                    json.info[2][1] = item.nickname;  // Username.\n                    json.info[2][2] = item.isadmin;  // IS Admin.\n                    json.info[2][3] = item.vip;  // IS VIP.\n                    json.info[3] = item.medal;  // 粉丝勋章.\n                    json.info[4] = item.user_level;  // 用户等级.\n                    json.info[5] = item.title;  // 用户头衔.\n\n                    vmodel.$fire(\"all!addDanmu\", json);\n\n                    item = json = null;\n                }\n\n                // 显示老爷 Greeting 消息（自己可见）.\n                (VIP == 1 && VIP_TIPS == 1) && vmodel.$fire(\"all!addSelfWelcomeMsg\");\n            }\n        },\n        error: function (result) {\n\n        }\n    });\n};\n// ================================\n\n\n\n\n// Definition: 欢迎信息.\n// ================================\nfunction greetingInfo () {\n    if (!explorerDetective() === \"IE 8\") {\n        return;\n    }\n    consoleText.log(appConfig.appInfo.name + \" \" + appConfig.appInfo.version + ' Lovingly By © ' + new Date().getFullYear() + ' - ' + (new Date().getFullYear() + 1) + ' Bilibili Live Department  ...(●\\'◡\\'●)ﾉ♥   # Renascence #\\n');\n    consoleText.log(\"Version: \" + appConfig.appInfo.version + \", CodeName: \" + appConfig.appInfo.codeName + \".\\n\\n\\n\");\n}\n// ================================\n\n\n\n\n// Definition: 更换房间背景.\n// ================================\nvar changeRoomBKTimeout = null;\nfunction changeRoomBK (link) {\n    $(\".bk-img\").addClass(\"fade-out\").removeClass(\"fade-in\");\n    clearTimeout(changeRoomBKTimeout);\n    changeRoomBKTimeout = setTimeout(function () { $(\".bk-img\").addClass(\"fade-in\").removeClass(\"fade-out\").css({\"background-image\": \"url(\" + link + \")\"}) }, 380)\n}\n// ================================\n\n\n\n\n// Definition: 获取房间切断审核状态.\n// ================================\nfunction loadingCutOffMsg () {\n    if (window.ISANCHOR != 1) { return; }\n    $.ajax({\n        url: \"/liveact/cutoffmsg\",\n        type: \"POST\",\n        data: { roomid: window.ROOMID },\n        dataType: \"JSON\",\n        success: function (result) {\n            if (result.code != 0 || !result.msg) { return; }\n\n            var hintPopup = window.livePopup({\n                title: \"友情提示 > <\",\n                html: '<p>您的直播间因<span style=\"color: red\">\"' + result.msg + '\"</span>，已经被管理员 <span style=\"color: red\">切断</span>，请更改直播内容。</p><p>如有疑问请通过客服邮箱 <span style=\"color: #61c7eb\">livehelp@bilibili.com</span> 或 <span style=\"color: #61c7eb\">客服 QQ </span>进行反馈。</p>' +\n                '<div><input type=\"checkbox\" id=\"cut-off-acknowledge\"><label for=\"cut-off-acknowledge\" class=\"v-top dp-inline-block\" style=\"margin-top: 7px\">我知道了</label></div>',\n                type: \"info\",\n                onConfirm: function () {\n                    $(\"#cut-off-acknowledge\").is(\":checked\") && $.post(\"/liveact/del_cutoff_msg\", { roomid: window.ROOMID }, null, \"JSON\");\n                    hintPopup.remove();\n                    hintPopup = null;\n                }\n            });\n        }\n    });\n}\n// ================================\n\n\n\n\n// Definition: 顶栏滚动监听事件.\nfunction topNavOnScroll (window) {\n    $(function () {\n        var scrollBefore = null;\n        $(window).scroll(function (event) {\n            var scrollY = event.currentTarget.scrollY || event.currentTarget.pageYOffset;\n            var delta = scrollY - scrollBefore > 0 ? \"scrollDown\" : \"scrollUp\";\n            var $topNav = $(\".live-top-nav-ctnr\");\n\n            switch (delta) {\n                case \"scrollDown\":\n                    $topNav.addClass(\"fixed-hide\");\n                    scrollBefore = scrollY - 1;  // 这么做是为了傻叉 IE, IE 在滚动到顶部或底部时最后两次 pageYOffset 会一致, 需要制造差异.\n                    break;\n                case \"scrollUp\":\n                    $topNav.removeClass(\"fixed-hide\");\n                    scrollBefore = scrollY + 1;\n                    break;\n            }\n        });\n    });\n}\n\n\n\nmodule.exports = {\n\n    // Definition: 更变房间背景.\n    changeRoomBK: changeRoomBK,\n\n    // Definition: 房间禁言倒计时方法.\n    // Usage: new CountDown(...) || CountDown(...)\n    CountDown: CountDown,\n\n    // Definition: 房间禁言节点处理函数. 当房间开启了禁言, 执行此函数.\n    roomSilent: roomSilent,\n\n    // Definition: 获取历史弹幕.\n    getHistoryDanmu: getHistoryDanmu,\n\n    // Definition: 欢迎信息.\n    greeting: greetingInfo,\n\n    // Definition: 获取房间切断审核状态.\n    loadingCutOffMsg: loadingCutOffMsg,\n\n    // Definition: 顶栏滚动监听事件.\n    topNavOnScroll: topNavOnScroll\n\n};", "/*\n *  Live Room Initialization By LancerComet at 14:08, 2015/12/15.\n *  # Carry Your World #\n *  ---\n *  直播房间页初始化 JavaScript.\n *\n */\n\nvar appConfig = require('../../common/app-config/app-config');\n\nmodule.exports = function (window, undefined) {\n    \"use strict\";\n\n    // Action: 设置预设全局方法.\n    globalFunc(window);\n    require(\"./live-room-flash-func\")(window);\n\n    // Action: 获取房间信息 - getInfo.\n    $.ajax({\n        url: \"/live/getInfo\",\n        type: \"GET\",\n        data: {\n            roomid: window.ROOMID\n        },\n        dataType: \"JSON\",\n        success: successCallback,\n        error: errorCallback\n    });\n\n\n};\n\n// Definition: 房间初始化回调函数.\nfunction successCallback (result) {\n    // Error Handler.\n    if (result.code != 0) {\n        throw new Error(appConfig.consoleText.error + \"getInfo 接口请求错误: \" + result.msg);\n    }\n\n    // Action: 设置全局变量.\n    require(\"./room-init-funcs/func-set-global-variables\")(window, result);\n\n    // Action: 房间广播方法定义.\n    require(\"./live-room-protocol\")(window);\n\n    // Action: 填充房间初始化数据. 房间基础数据, 聊天部分数据（包括排行榜）, 房间关注数, 粉丝送礼数量.\n    require(\"./room-init-funcs/func-set-data\")(result);\n\n    // Action: 直播间在线等级增长.\n    require(\"./room-init-funcs/func-user-online-heart\")();\n\n    // Action: 宝箱模块初始化.\n    require(\"../components/treasure-box/treasure-box\")(window);\n\n    // Action: 竞猜模块初始化.\n    require(\"../components/quiz-system/intro-scripts\")();\n\n    // Action: 推荐视频模块初始化.\n    require(\"../components/recommend-videos/recommend-videos\")(window);\n\n    // Action: 管理员功能模块载入.\n    if (parseInt(ISANCHOR, 10) === 1) {\n        require(\"../components/admin-functions/intro-scripts\")();  // 管理员方法模块.\n    }\n\n    // Action 房间管理模块\n    require('../components/admin-room-edit-panel/room-edit-panel')(result.data);\n\n\n    // Action: 更新房间数据.\n    // 此方法将提到最后执以确保控制器已 100% 加载完毕从而确保更新成功.\n    require(\"./room-init-funcs/func-room-data-deferred\")(result);\n\n}\n\n// Definition: 请求数据失败回调.\nfunction errorCallback (result) {\n    throw new Error(appConfig.consoleText.error + \"getInfo 接口访问失败, 房间无法初始化.\");\n}\n\n// Definition: 全局方法定义.\n// 将定义一些与外部交互的方法.\nfunction globalFunc (window) {\n\n    // Definition: 控制台事件追踪调试函数 By LancerComet at 14:33, 2015.11.05.\n    /*\n     *  用法:\n     *  ---\n     *  var trackEvent = liveLookEvent($(\"#targetDom\")[0]);\n     *  trackEvent 即为 #targetDom 的事件列表对象, 所有事件将以属性名的形式挂载到 trackEvent 中.\n     *\n     *  eg: trackEvent.click[0] 即为 #targetDom 的第一个点击事件的信息对象.\n     *      trackEvent.click[0].handler 即为点击事件的处理事件.\n     *      此时点击控制台右边定位链接即可直接查看函数所在位置.\n     *\n     */\n    window.liveTrackEvents = function (element) {\n        return $.data ? $.data(element, \"events\", undefined, true) : $._data(element, \"events\");\n    };\n\n}", "/*\n *  Live Room Protocol by LancerComet at 11:14, 2015/12/17.\n *  # Carry Your World #\n *  ---\n *  房间页 Protocol 广播方法对象定义.\n *\n *  说明:\n *  ---\n *  Protocol 对象将被 Flash 调用, 所以将被放在全局作用域下.\n *\n */\nvar appConfig = require('../../common/app-config/app-config');\nvar livePopup = require('../../common/components/live-widget/live-popup/live-popup');\nvar randomEmoji = require('../../common/functions/func-random-emoji/random-emoji');\nvar liveRoomFuncs = require('./live-room-funcs');\n\nmodule.exports = function (window, undefined) {\n    \"use strict\";\n\n    // Definition: 聊天记录容器.\n    var $msgPool = $(\"#chat-msg-list\");\n\n    // Definition: Protocol 对象.\n    // 本对象将被 Flash 随时调取.\n    if (window.protocol) {\n        throw new Error(appConfig.consoleText.error + \"window.protocol 在初始化之前已被污染, 请检查代码结构.\");\n    }\n\n    // Definition: Protocol.\n    window.protocol = {};\n\n    // Definition: 广播 Avalon 控制器定义.\n    // 这是一个没有额外功能的控制器, 仅仅是为了控制事件而定义.\n    var flashProtoCtrl = avalon.define({\n        $id: \"flashProtoCtrl\"\n    });\n\n\n    /*\n     *  全局类广播方法.\n     *  ==============================================\n     */\n\n    // 接收弹幕.\n    window.protocol.DANMU_MSG = function (json) {\n        console.log(\"protocol: DANMU_MSG\");\n        console.log(json);\n\n        // 添加弹幕事件. Fire to \"addDanmu\" in chatListCtrl.\n        // 仅当 UID 或 DANMU_RND 不为自己时添加.\n        //json.info[2][0] == UID || json.info[0][5] == DANMU_RND && flashProtoCtrl.$fire(\"all!addDanmu\", json);\n        flashProtoCtrl.$fire(\"all!addDanmu\", json);\n    };\n\n    // 接收送礼.\n    window.protocol.SEND_GIFT = function (json) {\n        /*\n         *  TODO:\n         *   - 更新房间累计送礼数量.\n         *   - 更新七日投喂排行榜.\n         *   - 判断连击礼物.\n         *   - 执行其他活动函数.\n         */\n        console.log(\"protocol: SEND_GIFT\");\n        console.log(json);\n\n        // 添加礼物.\n        flashProtoCtrl.$fire(\"all!addGift\", json);\n        activitySendGift(json);  // 其他活动需求.\n    };\n\n    // 更新七日投喂排行榜.\n    window.protocol.SEND_TOP = function (json) {\n        // TODO: loadTop10(json)\n        console.log(\"protocol: SEND_TOP\");\n        flashProtoCtrl.$fire(\"all!updateGiftTop\", json.data.top_list);\n    };\n\n    // 房间信息被修改通知.（当前仅有背景修改通知）\n    window.protocol.CHANGE_ROOM_INFO = function (json) {\n        console.log(\"protocol: CHANGE_ROOM_INFO\");\n        console.log(json);\n        require(\"./live-room-funcs\").changeRoomBK(json.background);\n    };\n\n    // 进入房间欢迎语.\n    window.protocol.WELCOME = function (json) {\n        console.log(\"protocol: WELCOME\");\n        console.log(json);\n\n        /*\n         *  @ json: {\n         *    data: {\n         *      isadmin: 0 || 1,\n         *      uid: Number,\n         *      uname: String\n         *    }\n         *  }\n         */\n\n        flashProtoCtrl.$fire(\"all!addWelcomeMsg\", json);\n    };\n\n    // 抽奖活动中奖通知.\n    window.protocol.WIN_ACTIVITY = function (json) {\n        activityDraw.win(json);\n    };\n\n    // 系统广播事件.\n    window.protocol.SYS_MSG = function (json) {\n        // TODO: addMessage\n        console.log(\"protocol: SYS_MSG\");\n        console.log(json)\n\n        flashProtoCtrl.$fire(\"all!addSysMsg\", json);\n\n    };\n\n\n\n\n    /*\n     *  直播状态更变广播方法.\n     *  ==============================================\n     */\n\n    // 房间开始直播通知.\n    window.protocol.LIVE = function (json) {\n        // TODO: liveStatusControl(\"on\");\n        console.log(\"protocol: LIVE\");\n        flashProtoCtrl.$fire(\"all!liveStatusButton\", \"on\");\n    };\n\n    // 房间直播关闭.\n    window.protocol.PREPARING = function (json) {\n        // TODO: liveStatusControl(\"off\");\n        console.log(\"protocol: PREPARING\");\n        flashProtoCtrl.$fire(\"all!liveStatusButton\", \"off\");\n    };\n\n    // 停止直播流（暂时无用）.\n    window.protocol.END = function (json) {\n        console.log(\"protocol: END\");\n    };\n\n    // 关闭房间（暂时无用）.\n    window.protocol.CLOSE = function (json) {\n        console.log(\"protocol: CLOSE\");\n    };\n\n    // 直播间被封禁（暂时无用）.\n    window.protocol.BLOCK = function (json) {\n        console.log(\"protocol: BLOCK\");\n    };\n\n\n\n    /*\n     *  房间管理类广播方法.\n     *  ==============================================\n     */\n\n    // 播主设置全局禁言.\n    window.protocol.ROOM_SILENT_ON = function (json) {\n        console.log(\"ROOM_SILENT_ON\");\n        console.log(json);\n\n        // json.is_newbie = 1 时表示播主仅屏蔽注册会员, 不等于 1 的时候屏蔽所有用户.\n        var hintMsg = json.is_newbie == 1 ? \"播主对注册用户开启了注册用户禁言\" : \"播主对所有用户开启了全局禁言\";\n        $msgPool.append('<p class=\"system-msg\" style=\"color: #f25d8e\">[系统]：' + hintMsg + '</p>');\n\n        if (ISADMIN != 1 && (json.is_newbie != 1 || (json.is_newbie == 1 && IS_NEWBIE == 1 && VIP != 1))) {\n            // Definition: 设置新的倒计时.\n            var endTime = new Date();\n            endTime.setSeconds(endTime.getSeconds() + json.countdown);\n\n            // 开启禁言.\n            liveRoomFuncs.roomSilent.on(hintMsg, endTime);\n        }\n    };\n\n    // 播主取消全局禁言.\n    window.protocol.ROOM_SILENT_OFF = function (json) {\n        $msgPool.append('<div class=\"system-msg\" style=\"color: #4fc1e9\">[系统]：播主取消了房间全局禁言</div>');\n        liveRoomFuncs.roomSilent.off();\n    };\n\n    // 屏蔽房间消息.\n    window.protocol.ROOM_BLOCK_MSG = function (json) {\n        // json.uid, json.uname\n        console.log(\"protocol: ROOM_BLOCK_MSG\");\n        console.log(json);\n        $msgPool.append('<div class=\"system-msg\">用户 <em style=\"color: #aaa\">' + json.uname + '</em> 已被管理员禁言</div>');\n    };\n\n    // 房间锁定.\n    window.protocol.ROOM_LOCK = function (json) {\n        console.log(\"protocol: ROOM_LOCK\");\n        console.log(json);\n        if (UID == MASTERID) {\n            livePopup({\n                title: \"系统通知\",\n                content: '您的房间已被<span style=\"color: #FF0000\">锁定</span>。如有疑问请通过客服邮箱或客服 QQ 进行反馈。',\n                type: \"info\",\n                width: 350,\n                onConfirm: function () {\n                    location.href = \"/\";\n                }\n            });\n        } else {\n            livePopup({\n                title: \"系统通知\",\n                content: \"当前直播间被直播管理员关闭。\",\n                type: \"info\",\n                width: 300,\n                onConfirm: function () {\n                    location.href = \"/\";\n                }\n            });\n        }\n    };\n\n    // 踢出用户.\n    window.protocol.ROOM_KICKOUT = function (json) {\n        flashProtoCtrl.$fire(\"all!addKickoutMsg\", json);\n    };\n\n    // 将用户踢出房间.\n    window.protocol.ROOM_BLOCK_INTO = function (json) {\n        // json.uid, json.uname\n        if (parseInt(json.uid, 10) === UID) {\n            livePopup({\n                title: \"你被踢出房间 \" + randomEmoji.sad(),\n                content: \"很不幸的是您被管理员踢出了房间…… 是不是做了什么不礼貌的事情呢？摸摸~ \" + randomEmoji.helpless(),\n                type: \"alert\",\n                button: {\n                    confirm: \"呜~~~~\"\n                },\n                onConfirm: function () {\n                    location.href = \"/\";\n                }\n            });\n        }\n\n        flashProtoCtrl.$fire(\"all!addKickoutMsg\", json);\n\n    };\n\n    // 房间后台审核.\n    window.protocol.ROOM_AUDIT = function (json) {\n        // TODO: window.UID == window.MASTERID && loadAudit();\n    };\n\n    // 强行切断直播.\n    window.protocol.CUT_OFF = function (json) {\n\n        if (UID == MASTERID) {\n            flashProtoCtrl.$fire(\"all!liveCutOff\");\n            require(\"./live-room-funcs\").loadingCutOffMsg();\n        } else {\n            var popup = livePopup({\n                title: \"系统通知\",\n                content: \"当前直播间被直播管理员切断直播。\",\n                type: \"info\",\n                width: 300,\n                onConfirm: function () {\n                    popup.remove();\n                    popup = null;\n                }\n            });\n        }\n\n    };\n\n    // 管理员更新（暂时无用）.\n    window.protocol.ROOM_ADMINS = function (json) {\n\n    };\n\n    // 房间屏蔽信息更新（暂时无用）.\n    window.protocol.ROOM_SHIELD = function (json) {\n\n    };\n\n    // 春节年糕活动广播 （高达开奖）\n    window.protocol.GAODA = function (json) {\n        console.log(\"大奖出炉:\",json);\n\n        (function(){\n\n            //抽奖面板\n            var gaodaPanel =  $('<div class=\"ka-draw-box\"><div class=\"ka-close\"></div><div class=\"ka-title\"></div><div class=\"ka-content\"><p></p></div><div class=\"ka-btn\">确认</div></div>');\n\n            var $kaDrawBox =  $(\".ka-draw-box\");\n\n            if ( $kaDrawBox.length >= 1 ) {\n\n                $kaDrawBox.removeAttr(\"style\");\n                $(\".ka-content\").html(\"<p></p>\");\n                $(\".ka-draw-box\").remove();\n\n            }\n\n            //关闭面板\n            $(\"body\").on(\"click\", \".ka-close, .ka-btn\", function(){\n                gaodaPanel.remove();\n            });\n\n            var _rcode = json.data.rcode;\n\n            $.ajax({\n                url: \"gaoda/getReward\",\n                type: \"GET\",\n                data: {\n                    room_id: json.roomid,\n                    rcode: _rcode\n                },\n                dataType: \"JSON\",\n                success: function (result) {\n\n                    if( result.code == 0 ) {\n                        //参加抽奖成功 弹出面板\n                        $(\"body\").append(gaodaPanel);\n\n                        var arr_t = {2:\"B坷垃1个\",3:\"辣条66个\",4:\"2016银瓜子\",5:\"200银瓜子\",0:\"这次没有中奖，记得下次要中奖哟~\"};\n                        var giftText = null;\n                        if ( result.data.status == 1){\n                            if( result.data.rank == 1){\n\n                                //添加收货地址弹窗~\n                                $(\".ka-btn\").removeClass(\"close-popup\").addClass(\"ka-draw-complete\");\n\n                                if (_rcode == 75) {\n                                    giftText = \"高达MG模型1个\";\n                                    $(\".data-status span\").addClass(\"gaoda-top2\")\n                                }else if (_rcode == 100) {\n                                    giftText = \"高达PG模型1个\";\n                                    result.data.rank = 7;\n                                    $(\".data-status span\").addClass(\"gaoda-top1\")\n                                }\n                            } else {\n                                giftText = arr_t[result.data.rank];\n                                $(\".ka-btn\").addClass(\"close-popup\");\n\n                            }\n                        }else {\n                            giftText = \"这次没有中奖，记得下次要中奖哟~\";\n                        }\n\n                        $(\".ka-content\").html(\"<p>本次大奖得主: <b style='font-size: 16px'>\"+ json.data.uname +\"</b></p><p class='mar-top24'>本次抽奖你共获得：</p><div class='gao-da-gift'><span class='gift-\"+ result.data.rank +\"'></span><span>\"+ giftText +\"</span></div>\")\n\n                    }\n\n                }\n            });\n\n\n        })(window);\n    };\n\n    // 春节年糕活动广播 （获奖弹窗）\n    window.protocol.GAODA_START = function (json) {\n\n        console.log(\"开奖啦:\",json);\n        var cpData = json.data.rcode+\"%\";\n        console.log(cpData);\n\n        (function(){\n            // 高达抽奖图提示面板\n            var picPanel = $('<div class=\"gao-da-tips\"><div class=\"ka-close-pic\"></div><div class=\"ka-tips-1\"></div><div class=\"data-times\">剩余时间：<span></span>秒</div><div class=\"ka-tips-2\"></div></div>');\n\n            var initPic;\n\n            $(\"body\").on(\"click\", \".gao-da-tips .ka-close-pic\", function(){\n                clearInterval(initPic);\n                picPanel.remove();\n            });\n\n            picTimes(json.roomid);  //初始化请求\n\n            function picTimes (roomid) {\n\n                $.ajax({\n                    url: \"gaoda/index\",\n                    type: \"GET\",\n                    data: {\n                        room_id: roomid,\n                        complete:cpData,\n                        timestamp: Date.now()\n                    },\n                    dataType: \"JSON\",\n                    success: function (result) {\n\n                        if (result.code == 7) {\n\n                            $(\"#chat-ctrl-panel\").append(picPanel);\n                            $(\".data-times span\").text(result.data.deadline);\n\n                            initPic = setInterval(function(){\n                                var picTimes = $(\".data-times span\").text();\n\n                                if( picTimes > 0){\n                                    picTimes--;\n                                    $(\".data-times span\").text(picTimes);\n                                }else{\n                                    picPanel.remove();\n                                }\n                            }, 1000);\n\n                        }\n                    }\n                });\n            }\n\n        })(window);\n    };\n\n\n};\n\n\n// Definition: 特定活动广播方法扩展.\n// 某些活动需要在广播事件中处理, 请在这里编写.\n\n\n// 这里放置 SEND_GIFT 的活动广播逻辑.\nfunction activitySendGift (json) {\n    // 例: require(\"shining-star\").updateTicket(json);\n    //flashProtoCtrl.$fire(\"all!updateRiceCake\", json.data.top_cake);\n}\n\n\n// 这里放至 DANMU_MSG 的活动广播逻辑.\nfunction activityDanmuMsg (json) {\n    // 例: require(\"shining-star\").announcement(json);\n}", "/*\n *  Live Room Data Deferred Update By LancerComet at 10:12, 2015/01/20.\n *  # Carry Your World #\n *  ---\n *  房间页初始化部分: 设置房间数据.\n *  此方法将在房间初始化完毕后执行以确保 100% 更新成功.（确保所有控制器已初始化.）\n *\n */\n\nvar lazyInit = require('../../../common/functions/func-avalon-lazy-init/lazy-init');\nvar liveRoomFuncs = require('../live-room-funcs');\n\nmodule.exports = function (result) {\n\n    // 此控制器是最后一个加载的控制器, 在此进行数据的填充.\n    avalon.ready(function () {\n\n        var emptyCtrl = avalon.define({\n            $id: \"emptyNode\"\n        });\n\n        lazyInit($(\"#empty-node\")[0], emptyCtrl, function () {\n\n            /* Action goes below. */\n\n            // Action: 广播瓜子更新.\n            setTimeout(function () {\n                emptyCtrl.$fire(\"all!updateCurrency\", {\n                    gold: parseInt(result.data.GOLD, 10),\n                    silver: parseInt(result.data.SILVER, 10)\n                });\n            }, 1);\n\n            // Action: 获取历史弹幕消息.\n            liveRoomFuncs.getHistoryDanmu(emptyCtrl);\n\n            // Action: 填充活动初始化数据.\n            require(\"./func-set-data-activity\")(result, emptyCtrl);\n\n            // Action: 载入直播间审核状态.（是否被切断）\n            require(\"../live-room-funcs\").loadingCutOffMsg();\n        });\n    });\n\n\n};", "/*\n *  Live Room Initialization By LancerComet at 11:11, 2015/12/21.\n *  # Carry Your World #\n *  ---\n *  直播房间页初始化部分.\n *  本文件在 func-room-data-deferred 中引用.\n *\n *  当前拥有：\n *   - 设置闪耀之星投票券数量.\n */\n\n\nmodule.exports = function (result, avalonCtrl) {\n\n    // Action: 更新闪耀之星.\n    // result.data.starRank\n    avalonCtrl.$fire(\"all!shiningStarCount\", result.data.starRank);\n\n};", "/*\n *  Live Room Data Setting By LancerComet at 11:55, 2015/12/21.\n *  # Carry Your World #\n *  ---\n *  房间页初始化部分: 填充房间信息数据部分.\n */\n\nmodule.exports = function (result) {\n\n    // Action: 设置房间基础数据.\n    require(\"../../components/header-section/header-section.js\")(result, window);\n\n    // Action: 聊天区域模块初始化.\n    require(\"../../components/chat-area/intro-javascripts\")(result);\n\n    // Action: 房间是否处于禁言状态.\n    (function setRoomSilent () {\n        (ISADMIN != 1 && BLOCK_TYPE != -1) && window.protocol.ROOM_SILENT_ON({\n            countdown: result.data.BLOCK_TIME,\n            is_newbie: window.IS_NEWBIE\n        });\n    })();\n\n};\n", "/*\n *  Live Room Initialization By LancerComet at 15:50, 2015/12/21.\n *  # Carry Your World #\n *  ---\n *  直播房间页初始化部分: 设置全局变量.\n */\n\nvar livePopup = require('../../../common/components/live-widget/live-popup/live-popup');\nvar liveToast = require('../../../common/components/live-widget/live-toast/live-toast');\nvar liveQuickLogin = require('../../../common/functions/func-live-quick-login/live-quick-login');\n\nmodule.exports = function (window, result) {\n    \"use strict\";\n\n    for (var i in result.data) {\n        if (result.data.hasOwnProperty(i)) {\n            window[i] = result.data[i];\n        }\n    }\n\n    // Definition: 送礼记录保存数组, 用于检查礼物是否为本人送出.\n    window.giftTsHistory = [];\n\n    // Definition: Common.JS 模块全局挂载, 以方便前端模板调用.\n    window.livePopup = livePopup;\n    window.liveToast = liveToast;\n    window.liveQuickLogin = liveQuickLogin;\n\n};", "/*\n *  Live Room User Online Heart at 16:19, 2016/01/21.\n *  ---\n *  直播间在线等级增长\n */\n\nmodule.exports = function () {\n    // 登陆用户每五分钟，涨次经验\n    if($.cookie(\"DedeUserID\")){\n        setInterval(function () {\n            $.ajax({\n                url: \"/User/userOnlineHeart\",\n                type: \"post\",\n                dataType: \"json\",\n                success: function (result) {\n                    // ...\n                }\n            });\n        }, 300000);\n    }\n};\n\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nmodule.exports = require('./src/js/adaptor/jquery');\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar ps = require('../main')\n  , psInstances = require('../plugin/instances');\n\nfunction mountJQuery(jQuery) {\n  jQuery.fn.perfectScrollbar = function (settingOrCommand) {\n    return this.each(function () {\n      if (typeof settingOrCommand === 'object' ||\n          typeof settingOrCommand === 'undefined') {\n        // If it's an object or none, initialize.\n        var settings = settingOrCommand;\n\n        if (!psInstances.get(this)) {\n          ps.initialize(this, settings);\n        }\n      } else {\n        // Unless, it may be a command.\n        var command = settingOrCommand;\n\n        if (command === 'update') {\n          ps.update(this);\n        } else if (command === 'destroy') {\n          ps.destroy(this);\n        }\n      }\n\n      return jQuery(this);\n    });\n  };\n}\n\nif (typeof define === 'function' && define.amd) {\n  // AMD. Register as an anonymous module.\n  define(['jquery'], mountJQuery);\n} else {\n  var jq = window.jQuery ? window.jQuery : window.$;\n  if (typeof jq !== 'undefined') {\n    mountJQuery(jq);\n  }\n}\n\nmodule.exports = mountJQuery;\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nfunction oldAdd(element, className) {\n  var classes = element.className.split(' ');\n  if (classes.indexOf(className) < 0) {\n    classes.push(className);\n  }\n  element.className = classes.join(' ');\n}\n\nfunction oldRemove(element, className) {\n  var classes = element.className.split(' ');\n  var idx = classes.indexOf(className);\n  if (idx >= 0) {\n    classes.splice(idx, 1);\n  }\n  element.className = classes.join(' ');\n}\n\nexports.add = function (element, className) {\n  if (element.classList) {\n    element.classList.add(className);\n  } else {\n    oldAdd(element, className);\n  }\n};\n\nexports.remove = function (element, className) {\n  if (element.classList) {\n    element.classList.remove(className);\n  } else {\n    oldRemove(element, className);\n  }\n};\n\nexports.list = function (element) {\n  if (element.classList) {\n    return Array.prototype.slice.apply(element.classList);\n  } else {\n    return element.className.split(' ');\n  }\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar DOM = {};\n\nDOM.e = function (tagName, className) {\n  var element = document.createElement(tagName);\n  element.className = className;\n  return element;\n};\n\nDOM.appendTo = function (child, parent) {\n  parent.appendChild(child);\n  return child;\n};\n\nfunction cssGet(element, styleName) {\n  return window.getComputedStyle(element)[styleName];\n}\n\nfunction cssSet(element, styleName, styleValue) {\n  if (typeof styleValue === 'number') {\n    styleValue = styleValue.toString() + 'px';\n  }\n  element.style[styleName] = styleValue;\n  return element;\n}\n\nfunction cssMultiSet(element, obj) {\n  for (var key in obj) {\n    var val = obj[key];\n    if (typeof val === 'number') {\n      val = val.toString() + 'px';\n    }\n    element.style[key] = val;\n  }\n  return element;\n}\n\nDOM.css = function (element, styleNameOrObject, styleValue) {\n  if (typeof styleNameOrObject === 'object') {\n    // multiple set with object\n    return cssMultiSet(element, styleNameOrObject);\n  } else {\n    if (typeof styleValue === 'undefined') {\n      return cssGet(element, styleNameOrObject);\n    } else {\n      return cssSet(element, styleNameOrObject, styleValue);\n    }\n  }\n};\n\nDOM.matches = function (element, query) {\n  if (typeof element.matches !== 'undefined') {\n    return element.matches(query);\n  } else {\n    if (typeof element.matchesSelector !== 'undefined') {\n      return element.matchesSelector(query);\n    } else if (typeof element.webkitMatchesSelector !== 'undefined') {\n      return element.webkitMatchesSelector(query);\n    } else if (typeof element.mozMatchesSelector !== 'undefined') {\n      return element.mozMatchesSelector(query);\n    } else if (typeof element.msMatchesSelector !== 'undefined') {\n      return element.msMatchesSelector(query);\n    }\n  }\n};\n\nDOM.remove = function (element) {\n  if (typeof element.remove !== 'undefined') {\n    element.remove();\n  } else {\n    if (element.parentNode) {\n      element.parentNode.removeChild(element);\n    }\n  }\n};\n\nDOM.queryChildren = function (element, selector) {\n  return Array.prototype.filter.call(element.childNodes, function (child) {\n    return DOM.matches(child, selector);\n  });\n};\n\nmodule.exports = DOM;\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar EventElement = function (element) {\n  this.element = element;\n  this.events = {};\n};\n\nEventElement.prototype.bind = function (eventName, handler) {\n  if (typeof this.events[eventName] === 'undefined') {\n    this.events[eventName] = [];\n  }\n  this.events[eventName].push(handler);\n  this.element.addEventListener(eventName, handler, false);\n};\n\nEventElement.prototype.unbind = function (eventName, handler) {\n  var isHandlerProvided = (typeof handler !== 'undefined');\n  this.events[eventName] = this.events[eventName].filter(function (hdlr) {\n    if (isHandlerProvided && hdlr !== handler) {\n      return true;\n    }\n    this.element.removeEventListener(eventName, hdlr, false);\n    return false;\n  }, this);\n};\n\nEventElement.prototype.unbindAll = function () {\n  for (var name in this.events) {\n    this.unbind(name);\n  }\n};\n\nvar EventManager = function () {\n  this.eventElements = [];\n};\n\nEventManager.prototype.eventElement = function (element) {\n  var ee = this.eventElements.filter(function (eventElement) {\n    return eventElement.element === element;\n  })[0];\n  if (typeof ee === 'undefined') {\n    ee = new EventElement(element);\n    this.eventElements.push(ee);\n  }\n  return ee;\n};\n\nEventManager.prototype.bind = function (element, eventName, handler) {\n  this.eventElement(element).bind(eventName, handler);\n};\n\nEventManager.prototype.unbind = function (element, eventName, handler) {\n  this.eventElement(element).unbind(eventName, handler);\n};\n\nEventManager.prototype.unbindAll = function () {\n  for (var i = 0; i < this.eventElements.length; i++) {\n    this.eventElements[i].unbindAll();\n  }\n};\n\nEventManager.prototype.once = function (element, eventName, handler) {\n  var ee = this.eventElement(element);\n  var onceHandler = function (e) {\n    ee.unbind(eventName, onceHandler);\n    handler(e);\n  };\n  ee.bind(eventName, onceHandler);\n};\n\nmodule.exports = EventManager;\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nmodule.exports = (function () {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n               .toString(16)\n               .substring(1);\n  }\n  return function () {\n    return s4() + s4() + '-' + s4() + '-' + s4() + '-' +\n           s4() + '-' + s4() + s4() + s4();\n  };\n})();\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar cls = require('./class')\n  , d = require('./dom');\n\nexports.toInt = function (x) {\n  return parseInt(x, 10) || 0;\n};\n\nexports.clone = function (obj) {\n  if (obj === null) {\n    return null;\n  } else if (typeof obj === 'object') {\n    var result = {};\n    for (var key in obj) {\n      result[key] = this.clone(obj[key]);\n    }\n    return result;\n  } else {\n    return obj;\n  }\n};\n\nexports.extend = function (original, source) {\n  var result = this.clone(original);\n  for (var key in source) {\n    result[key] = this.clone(source[key]);\n  }\n  return result;\n};\n\nexports.isEditable = function (el) {\n  return d.matches(el, \"input,[contenteditable]\") ||\n         d.matches(el, \"select,[contenteditable]\") ||\n         d.matches(el, \"textarea,[contenteditable]\") ||\n         d.matches(el, \"button,[contenteditable]\");\n};\n\nexports.removePsClasses = function (element) {\n  var clsList = cls.list(element);\n  for (var i = 0; i < clsList.length; i++) {\n    var className = clsList[i];\n    if (className.indexOf('ps-') === 0) {\n      cls.remove(element, className);\n    }\n  }\n};\n\nexports.outerWidth = function (element) {\n  return this.toInt(d.css(element, 'width')) +\n         this.toInt(d.css(element, 'paddingLeft')) +\n         this.toInt(d.css(element, 'paddingRight')) +\n         this.toInt(d.css(element, 'borderLeftWidth')) +\n         this.toInt(d.css(element, 'borderRightWidth'));\n};\n\nexports.startScrolling = function (element, axis) {\n  cls.add(element, 'ps-in-scrolling');\n  if (typeof axis !== 'undefined') {\n    cls.add(element, 'ps-' + axis);\n  } else {\n    cls.add(element, 'ps-x');\n    cls.add(element, 'ps-y');\n  }\n};\n\nexports.stopScrolling = function (element, axis) {\n  cls.remove(element, 'ps-in-scrolling');\n  if (typeof axis !== 'undefined') {\n    cls.remove(element, 'ps-' + axis);\n  } else {\n    cls.remove(element, 'ps-x');\n    cls.remove(element, 'ps-y');\n  }\n};\n\nexports.env = {\n  isWebKit: 'WebkitAppearance' in document.documentElement.style,\n  supportsTouch: (('ontouchstart' in window) || window.DocumentTouch && document instanceof window.DocumentTouch),\n  supportsIePointer: window.navigator.msMaxTouchPoints !== null\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar destroy = require('./plugin/destroy')\n  , initialize = require('./plugin/initialize')\n  , update = require('./plugin/update');\n\nmodule.exports = {\n  initialize: initialize,\n  update: update,\n  destroy: destroy\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nmodule.exports = {\n  maxScrollbarLength: null,\n  minScrollbarLength: null,\n  scrollXMarginOffset: 0,\n  scrollYMarginOffset: 0,\n  stopPropagationOnClick: true,\n  suppressScrollX: false,\n  suppressScrollY: false,\n  swipePropagation: true,\n  useBothWheelAxes: false,\n  useKeyboard: true,\n  useSelectionScroll: false,\n  wheelPropagation: false,\n  wheelSpeed: 1\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar d = require('../lib/dom')\n  , h = require('../lib/helper')\n  , instances = require('./instances');\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n\n  if (!i) {\n    return;\n  }\n\n  i.event.unbindAll();\n  d.remove(i.scrollbarX);\n  d.remove(i.scrollbarY);\n  d.remove(i.scrollbarXRail);\n  d.remove(i.scrollbarYRail);\n  h.removePsClasses(element);\n\n  instances.remove(element);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar h = require('../../lib/helper')\n  , instances = require('../instances')\n  , updateGeometry = require('../update-geometry')\n  , updateScroll = require('../update-scroll');\n\nfunction bindClickRailHandler(element, i) {\n  function pageOffset(el) {\n    return el.getBoundingClientRect();\n  }\n  var stopPropagation = window.Event.prototype.stopPropagation.bind;\n\n  if (i.settings.stopPropagationOnClick) {\n    i.event.bind(i.scrollbarY, 'click', stopPropagation);\n  }\n  i.event.bind(i.scrollbarYRail, 'click', function (e) {\n    var halfOfScrollbarLength = h.toInt(i.scrollbarYHeight / 2);\n    var positionTop = i.railYRatio * (e.pageY - window.pageYOffset - pageOffset(i.scrollbarYRail).top - halfOfScrollbarLength);\n    var maxPositionTop = i.railYRatio * (i.railYHeight - i.scrollbarYHeight);\n    var positionRatio = positionTop / maxPositionTop;\n\n    if (positionRatio < 0) {\n      positionRatio = 0;\n    } else if (positionRatio > 1) {\n      positionRatio = 1;\n    }\n\n    updateScroll(element, 'top', (i.contentHeight - i.containerHeight) * positionRatio);\n    updateGeometry(element);\n\n    e.stopPropagation();\n  });\n\n  if (i.settings.stopPropagationOnClick) {\n    i.event.bind(i.scrollbarX, 'click', stopPropagation);\n  }\n  i.event.bind(i.scrollbarXRail, 'click', function (e) {\n    var halfOfScrollbarLength = h.toInt(i.scrollbarXWidth / 2);\n    var positionLeft = i.railXRatio * (e.pageX - window.pageXOffset - pageOffset(i.scrollbarXRail).left - halfOfScrollbarLength);\n    var maxPositionLeft = i.railXRatio * (i.railXWidth - i.scrollbarXWidth);\n    var positionRatio = positionLeft / maxPositionLeft;\n\n    if (positionRatio < 0) {\n      positionRatio = 0;\n    } else if (positionRatio > 1) {\n      positionRatio = 1;\n    }\n\n    updateScroll(element, 'left', ((i.contentWidth - i.containerWidth) * positionRatio) - i.negativeScrollAdjustment);\n    updateGeometry(element);\n\n    e.stopPropagation();\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindClickRailHandler(element, i);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar d = require('../../lib/dom')\n  , h = require('../../lib/helper')\n  , instances = require('../instances')\n  , updateGeometry = require('../update-geometry')\n  , updateScroll = require('../update-scroll');\n\nfunction bindMouseScrollXHandler(element, i) {\n  var currentLeft = null;\n  var currentPageX = null;\n\n  function updateScrollLeft(deltaX) {\n    var newLeft = currentLeft + (deltaX * i.railXRatio);\n    var maxLeft = Math.max(0, i.scrollbarXRail.getBoundingClientRect().left) + (i.railXRatio * (i.railXWidth - i.scrollbarXWidth));\n\n    if (newLeft < 0) {\n      i.scrollbarXLeft = 0;\n    } else if (newLeft > maxLeft) {\n      i.scrollbarXLeft = maxLeft;\n    } else {\n      i.scrollbarXLeft = newLeft;\n    }\n\n    var scrollLeft = h.toInt(i.scrollbarXLeft * (i.contentWidth - i.containerWidth) / (i.containerWidth - (i.railXRatio * i.scrollbarXWidth))) - i.negativeScrollAdjustment;\n    updateScroll(element, 'left', scrollLeft);\n  }\n\n  var mouseMoveHandler = function (e) {\n    updateScrollLeft(e.pageX - currentPageX);\n    updateGeometry(element);\n    e.stopPropagation();\n    e.preventDefault();\n  };\n\n  var mouseUpHandler = function () {\n    h.stopScrolling(element, 'x');\n    i.event.unbind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n  };\n\n  i.event.bind(i.scrollbarX, 'mousedown', function (e) {\n    currentPageX = e.pageX;\n    currentLeft = h.toInt(d.css(i.scrollbarX, 'left')) * i.railXRatio;\n    h.startScrolling(element, 'x');\n\n    i.event.bind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n    i.event.once(i.ownerDocument, 'mouseup', mouseUpHandler);\n\n    e.stopPropagation();\n    e.preventDefault();\n  });\n}\n\nfunction bindMouseScrollYHandler(element, i) {\n  var currentTop = null;\n  var currentPageY = null;\n\n  function updateScrollTop(deltaY) {\n    var newTop = currentTop + (deltaY * i.railYRatio);\n    var maxTop = Math.max(0, i.scrollbarYRail.getBoundingClientRect().top) + (i.railYRatio * (i.railYHeight - i.scrollbarYHeight));\n\n    if (newTop < 0) {\n      i.scrollbarYTop = 0;\n    } else if (newTop > maxTop) {\n      i.scrollbarYTop = maxTop;\n    } else {\n      i.scrollbarYTop = newTop;\n    }\n\n    var scrollTop = h.toInt(i.scrollbarYTop * (i.contentHeight - i.containerHeight) / (i.containerHeight - (i.railYRatio * i.scrollbarYHeight)));\n    updateScroll(element, 'top', scrollTop);\n  }\n\n  var mouseMoveHandler = function (e) {\n    updateScrollTop(e.pageY - currentPageY);\n    updateGeometry(element);\n    e.stopPropagation();\n    e.preventDefault();\n  };\n\n  var mouseUpHandler = function () {\n    h.stopScrolling(element, 'y');\n    i.event.unbind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n  };\n\n  i.event.bind(i.scrollbarY, 'mousedown', function (e) {\n    currentPageY = e.pageY;\n    currentTop = h.toInt(d.css(i.scrollbarY, 'top')) * i.railYRatio;\n    h.startScrolling(element, 'y');\n\n    i.event.bind(i.ownerDocument, 'mousemove', mouseMoveHandler);\n    i.event.once(i.ownerDocument, 'mouseup', mouseUpHandler);\n\n    e.stopPropagation();\n    e.preventDefault();\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindMouseScrollXHandler(element, i);\n  bindMouseScrollYHandler(element, i);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar h = require('../../lib/helper')\n  , instances = require('../instances')\n  , updateGeometry = require('../update-geometry')\n  , updateScroll = require('../update-scroll');\n\nfunction bindKeyboardHandler(element, i) {\n  var hovered = false;\n  i.event.bind(element, 'mouseenter', function () {\n    hovered = true;\n  });\n  i.event.bind(element, 'mouseleave', function () {\n    hovered = false;\n  });\n\n  var shouldPrevent = false;\n  function shouldPreventDefault(deltaX, deltaY) {\n    var scrollTop = element.scrollTop;\n    if (deltaX === 0) {\n      if (!i.scrollbarYActive) {\n        return false;\n      }\n      if ((scrollTop === 0 && deltaY > 0) || (scrollTop >= i.contentHeight - i.containerHeight && deltaY < 0)) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n\n    var scrollLeft = element.scrollLeft;\n    if (deltaY === 0) {\n      if (!i.scrollbarXActive) {\n        return false;\n      }\n      if ((scrollLeft === 0 && deltaX < 0) || (scrollLeft >= i.contentWidth - i.containerWidth && deltaX > 0)) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n    return true;\n  }\n\n  i.event.bind(i.ownerDocument, 'keydown', function (e) {\n    if (e.isDefaultPrevented && e.isDefaultPrevented()) {\n      return;\n    }\n\n    if (!hovered) {\n      return;\n    }\n\n    var activeElement = document.activeElement ? document.activeElement : i.ownerDocument.activeElement;\n    if (activeElement) {\n      // go deeper if element is a webcomponent\n      while (activeElement.shadowRoot) {\n        activeElement = activeElement.shadowRoot.activeElement;\n      }\n      if (h.isEditable(activeElement)) {\n        return;\n      }\n    }\n\n    var deltaX = 0;\n    var deltaY = 0;\n\n    switch (e.which) {\n    case 37: // left\n      deltaX = -30;\n      break;\n    case 38: // up\n      deltaY = 30;\n      break;\n    case 39: // right\n      deltaX = 30;\n      break;\n    case 40: // down\n      deltaY = -30;\n      break;\n    case 33: // page up\n      deltaY = 90;\n      break;\n    case 32: // space bar\n      if (e.shiftKey) {\n        deltaY = 90;\n      } else {\n        deltaY = -90;\n      }\n      break;\n    case 34: // page down\n      deltaY = -90;\n      break;\n    case 35: // end\n      if (e.ctrlKey) {\n        deltaY = -i.contentHeight;\n      } else {\n        deltaY = -i.containerHeight;\n      }\n      break;\n    case 36: // home\n      if (e.ctrlKey) {\n        deltaY = element.scrollTop;\n      } else {\n        deltaY = i.containerHeight;\n      }\n      break;\n    default:\n      return;\n    }\n\n    updateScroll(element, 'top', element.scrollTop - deltaY);\n    updateScroll(element, 'left', element.scrollLeft + deltaX);\n    updateGeometry(element);\n\n    shouldPrevent = shouldPreventDefault(deltaX, deltaY);\n    if (shouldPrevent) {\n      e.preventDefault();\n    }\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindKeyboardHandler(element, i);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar instances = require('../instances')\n  , updateGeometry = require('../update-geometry')\n  , updateScroll = require('../update-scroll');\n\nfunction bindMouseWheelHandler(element, i) {\n  var shouldPrevent = false;\n\n  function shouldPreventDefault(deltaX, deltaY) {\n    var scrollTop = element.scrollTop;\n    if (deltaX === 0) {\n      if (!i.scrollbarYActive) {\n        return false;\n      }\n      if ((scrollTop === 0 && deltaY > 0) || (scrollTop >= i.contentHeight - i.containerHeight && deltaY < 0)) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n\n    var scrollLeft = element.scrollLeft;\n    if (deltaY === 0) {\n      if (!i.scrollbarXActive) {\n        return false;\n      }\n      if ((scrollLeft === 0 && deltaX < 0) || (scrollLeft >= i.contentWidth - i.containerWidth && deltaX > 0)) {\n        return !i.settings.wheelPropagation;\n      }\n    }\n    return true;\n  }\n\n  function getDeltaFromEvent(e) {\n    var deltaX = e.deltaX;\n    var deltaY = -1 * e.deltaY;\n\n    if (typeof deltaX === \"undefined\" || typeof deltaY === \"undefined\") {\n      // OS X Safari\n      deltaX = -1 * e.wheelDeltaX / 6;\n      deltaY = e.wheelDeltaY / 6;\n    }\n\n    if (e.deltaMode && e.deltaMode === 1) {\n      // Firefox in deltaMode 1: Line scrolling\n      deltaX *= 10;\n      deltaY *= 10;\n    }\n\n    if (deltaX !== deltaX && deltaY !== deltaY/* NaN checks */) {\n      // IE in some mouse drivers\n      deltaX = 0;\n      deltaY = e.wheelDelta;\n    }\n\n    return [deltaX, deltaY];\n  }\n\n  function shouldBeConsumedByTextarea(deltaX, deltaY) {\n    var hoveredTextarea = element.querySelector('textarea:hover');\n    if (hoveredTextarea) {\n      var maxScrollTop = hoveredTextarea.scrollHeight - hoveredTextarea.clientHeight;\n      if (maxScrollTop > 0) {\n        if (!(hoveredTextarea.scrollTop === 0 && deltaY > 0) &&\n            !(hoveredTextarea.scrollTop === maxScrollTop && deltaY < 0)) {\n          return true;\n        }\n      }\n      var maxScrollLeft = hoveredTextarea.scrollLeft - hoveredTextarea.clientWidth;\n      if (maxScrollLeft > 0) {\n        if (!(hoveredTextarea.scrollLeft === 0 && deltaX < 0) &&\n            !(hoveredTextarea.scrollLeft === maxScrollLeft && deltaX > 0)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  function mousewheelHandler(e) {\n    var delta = getDeltaFromEvent(e);\n\n    var deltaX = delta[0];\n    var deltaY = delta[1];\n\n    if (shouldBeConsumedByTextarea(deltaX, deltaY)) {\n      return;\n    }\n\n    shouldPrevent = false;\n    if (!i.settings.useBothWheelAxes) {\n      // deltaX will only be used for horizontal scrolling and deltaY will\n      // only be used for vertical scrolling - this is the default\n      updateScroll(element, 'top', element.scrollTop - (deltaY * i.settings.wheelSpeed));\n      updateScroll(element, 'left', element.scrollLeft + (deltaX * i.settings.wheelSpeed));\n    } else if (i.scrollbarYActive && !i.scrollbarXActive) {\n      // only vertical scrollbar is active and useBothWheelAxes option is\n      // active, so let's scroll vertical bar using both mouse wheel axes\n      if (deltaY) {\n        updateScroll(element, 'top', element.scrollTop - (deltaY * i.settings.wheelSpeed));\n      } else {\n        updateScroll(element, 'top', element.scrollTop + (deltaX * i.settings.wheelSpeed));\n      }\n      shouldPrevent = true;\n    } else if (i.scrollbarXActive && !i.scrollbarYActive) {\n      // useBothWheelAxes and only horizontal bar is active, so use both\n      // wheel axes for horizontal bar\n      if (deltaX) {\n        updateScroll(element, 'left', element.scrollLeft + (deltaX * i.settings.wheelSpeed));\n      } else {\n        updateScroll(element, 'left', element.scrollLeft - (deltaY * i.settings.wheelSpeed));\n      }\n      shouldPrevent = true;\n    }\n\n    updateGeometry(element);\n\n    shouldPrevent = (shouldPrevent || shouldPreventDefault(deltaX, deltaY));\n    if (shouldPrevent) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  if (typeof window.onwheel !== \"undefined\") {\n    i.event.bind(element, 'wheel', mousewheelHandler);\n  } else if (typeof window.onmousewheel !== \"undefined\") {\n    i.event.bind(element, 'mousewheel', mousewheelHandler);\n  }\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindMouseWheelHandler(element, i);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar instances = require('../instances')\n  , updateGeometry = require('../update-geometry');\n\nfunction bindNativeScrollHandler(element, i) {\n  i.event.bind(element, 'scroll', function () {\n    updateGeometry(element);\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindNativeScrollHandler(element, i);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar h = require('../../lib/helper')\n  , instances = require('../instances')\n  , updateGeometry = require('../update-geometry')\n  , updateScroll = require('../update-scroll');\n\nfunction bindSelectionHandler(element, i) {\n  function getRangeNode() {\n    var selection = window.getSelection ? window.getSelection() :\n                    document.getSelection ? document.getSelection() : '';\n    if (selection.toString().length === 0) {\n      return null;\n    } else {\n      return selection.getRangeAt(0).commonAncestorContainer;\n    }\n  }\n\n  var scrollingLoop = null;\n  var scrollDiff = {top: 0, left: 0};\n  function startScrolling() {\n    if (!scrollingLoop) {\n      scrollingLoop = setInterval(function () {\n        if (!instances.get(element)) {\n          clearInterval(scrollingLoop);\n          return;\n        }\n\n        updateScroll(element, 'top', element.scrollTop + scrollDiff.top);\n        updateScroll(element, 'left', element.scrollLeft + scrollDiff.left);\n        updateGeometry(element);\n      }, 50); // every .1 sec\n    }\n  }\n  function stopScrolling() {\n    if (scrollingLoop) {\n      clearInterval(scrollingLoop);\n      scrollingLoop = null;\n    }\n    h.stopScrolling(element);\n  }\n\n  var isSelected = false;\n  i.event.bind(i.ownerDocument, 'selectionchange', function () {\n    if (element.contains(getRangeNode())) {\n      isSelected = true;\n    } else {\n      isSelected = false;\n      stopScrolling();\n    }\n  });\n  i.event.bind(window, 'mouseup', function () {\n    if (isSelected) {\n      isSelected = false;\n      stopScrolling();\n    }\n  });\n\n  i.event.bind(window, 'mousemove', function (e) {\n    if (isSelected) {\n      var mousePosition = {x: e.pageX, y: e.pageY};\n      var containerGeometry = {\n        left: element.offsetLeft,\n        right: element.offsetLeft + element.offsetWidth,\n        top: element.offsetTop,\n        bottom: element.offsetTop + element.offsetHeight\n      };\n\n      if (mousePosition.x < containerGeometry.left + 3) {\n        scrollDiff.left = -5;\n        h.startScrolling(element, 'x');\n      } else if (mousePosition.x > containerGeometry.right - 3) {\n        scrollDiff.left = 5;\n        h.startScrolling(element, 'x');\n      } else {\n        scrollDiff.left = 0;\n      }\n\n      if (mousePosition.y < containerGeometry.top + 3) {\n        if (containerGeometry.top + 3 - mousePosition.y < 5) {\n          scrollDiff.top = -5;\n        } else {\n          scrollDiff.top = -20;\n        }\n        h.startScrolling(element, 'y');\n      } else if (mousePosition.y > containerGeometry.bottom - 3) {\n        if (mousePosition.y - containerGeometry.bottom + 3 < 5) {\n          scrollDiff.top = 5;\n        } else {\n          scrollDiff.top = 20;\n        }\n        h.startScrolling(element, 'y');\n      } else {\n        scrollDiff.top = 0;\n      }\n\n      if (scrollDiff.top === 0 && scrollDiff.left === 0) {\n        stopScrolling();\n      } else {\n        startScrolling();\n      }\n    }\n  });\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n  bindSelectionHandler(element, i);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar instances = require('../instances')\n  , updateGeometry = require('../update-geometry')\n  , updateScroll = require('../update-scroll');\n\nfunction bindTouchHandler(element, i, supportsTouch, supportsIePointer) {\n  function shouldPreventDefault(deltaX, deltaY) {\n    var scrollTop = element.scrollTop;\n    var scrollLeft = element.scrollLeft;\n    var magnitudeX = Math.abs(deltaX);\n    var magnitudeY = Math.abs(deltaY);\n\n    if (magnitudeY > magnitudeX) {\n      // user is perhaps trying to swipe up/down the page\n\n      if (((deltaY < 0) && (scrollTop === i.contentHeight - i.containerHeight)) ||\n          ((deltaY > 0) && (scrollTop === 0))) {\n        return !i.settings.swipePropagation;\n      }\n    } else if (magnitudeX > magnitudeY) {\n      // user is perhaps trying to swipe left/right across the page\n\n      if (((deltaX < 0) && (scrollLeft === i.contentWidth - i.containerWidth)) ||\n          ((deltaX > 0) && (scrollLeft === 0))) {\n        return !i.settings.swipePropagation;\n      }\n    }\n\n    return true;\n  }\n\n  function applyTouchMove(differenceX, differenceY) {\n    updateScroll(element, 'top', element.scrollTop - differenceY);\n    updateScroll(element, 'left', element.scrollLeft - differenceX);\n\n    updateGeometry(element);\n  }\n\n  var startOffset = {};\n  var startTime = 0;\n  var speed = {};\n  var easingLoop = null;\n  var inGlobalTouch = false;\n  var inLocalTouch = false;\n\n  function globalTouchStart() {\n    inGlobalTouch = true;\n  }\n  function globalTouchEnd() {\n    inGlobalTouch = false;\n  }\n\n  function getTouch(e) {\n    if (e.targetTouches) {\n      return e.targetTouches[0];\n    } else {\n      // Maybe IE pointer\n      return e;\n    }\n  }\n  function shouldHandle(e) {\n    if (e.targetTouches && e.targetTouches.length === 1) {\n      return true;\n    }\n    if (e.pointerType && e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n      return true;\n    }\n    return false;\n  }\n  function touchStart(e) {\n    if (shouldHandle(e)) {\n      inLocalTouch = true;\n\n      var touch = getTouch(e);\n\n      startOffset.pageX = touch.pageX;\n      startOffset.pageY = touch.pageY;\n\n      startTime = (new Date()).getTime();\n\n      if (easingLoop !== null) {\n        clearInterval(easingLoop);\n      }\n\n      e.stopPropagation();\n    }\n  }\n  function touchMove(e) {\n    if (!inGlobalTouch && inLocalTouch && shouldHandle(e)) {\n      var touch = getTouch(e);\n\n      var currentOffset = {pageX: touch.pageX, pageY: touch.pageY};\n\n      var differenceX = currentOffset.pageX - startOffset.pageX;\n      var differenceY = currentOffset.pageY - startOffset.pageY;\n\n      applyTouchMove(differenceX, differenceY);\n      startOffset = currentOffset;\n\n      var currentTime = (new Date()).getTime();\n\n      var timeGap = currentTime - startTime;\n      if (timeGap > 0) {\n        speed.x = differenceX / timeGap;\n        speed.y = differenceY / timeGap;\n        startTime = currentTime;\n      }\n\n      if (shouldPreventDefault(differenceX, differenceY)) {\n        e.stopPropagation();\n        e.preventDefault();\n      }\n    }\n  }\n  function touchEnd() {\n    if (!inGlobalTouch && inLocalTouch) {\n      inLocalTouch = false;\n\n      clearInterval(easingLoop);\n      easingLoop = setInterval(function () {\n        if (!instances.get(element)) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        if (Math.abs(speed.x) < 0.01 && Math.abs(speed.y) < 0.01) {\n          clearInterval(easingLoop);\n          return;\n        }\n\n        applyTouchMove(speed.x * 30, speed.y * 30);\n\n        speed.x *= 0.8;\n        speed.y *= 0.8;\n      }, 10);\n    }\n  }\n\n  if (supportsTouch) {\n    i.event.bind(window, 'touchstart', globalTouchStart);\n    i.event.bind(window, 'touchend', globalTouchEnd);\n    i.event.bind(element, 'touchstart', touchStart);\n    i.event.bind(element, 'touchmove', touchMove);\n    i.event.bind(element, 'touchend', touchEnd);\n  }\n\n  if (supportsIePointer) {\n    if (window.PointerEvent) {\n      i.event.bind(window, 'pointerdown', globalTouchStart);\n      i.event.bind(window, 'pointerup', globalTouchEnd);\n      i.event.bind(element, 'pointerdown', touchStart);\n      i.event.bind(element, 'pointermove', touchMove);\n      i.event.bind(element, 'pointerup', touchEnd);\n    } else if (window.MSPointerEvent) {\n      i.event.bind(window, 'MSPointerDown', globalTouchStart);\n      i.event.bind(window, 'MSPointerUp', globalTouchEnd);\n      i.event.bind(element, 'MSPointerDown', touchStart);\n      i.event.bind(element, 'MSPointerMove', touchMove);\n      i.event.bind(element, 'MSPointerUp', touchEnd);\n    }\n  }\n}\n\nmodule.exports = function (element, supportsTouch, supportsIePointer) {\n  var i = instances.get(element);\n  bindTouchHandler(element, i, supportsTouch, supportsIePointer);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar cls = require('../lib/class')\n  , h = require('../lib/helper')\n  , instances = require('./instances')\n  , updateGeometry = require('./update-geometry');\n\n// Handlers\nvar clickRailHandler = require('./handler/click-rail')\n  , dragScrollbarHandler = require('./handler/drag-scrollbar')\n  , keyboardHandler = require('./handler/keyboard')\n  , mouseWheelHandler = require('./handler/mouse-wheel')\n  , nativeScrollHandler = require('./handler/native-scroll')\n  , selectionHandler = require('./handler/selection')\n  , touchHandler = require('./handler/touch');\n\nmodule.exports = function (element, userSettings) {\n  userSettings = typeof userSettings === 'object' ? userSettings : {};\n\n  cls.add(element, 'ps-container');\n\n  // Create a plugin instance.\n  var i = instances.add(element);\n\n  i.settings = h.extend(i.settings, userSettings);\n\n  clickRailHandler(element);\n  dragScrollbarHandler(element);\n  mouseWheelHandler(element);\n  nativeScrollHandler(element);\n\n  if (i.settings.useSelectionScroll) {\n    selectionHandler(element);\n  }\n\n  if (h.env.supportsTouch || h.env.supportsIePointer) {\n    touchHandler(element, h.env.supportsTouch, h.env.supportsIePointer);\n  }\n  if (i.settings.useKeyboard) {\n    keyboardHandler(element);\n  }\n\n  updateGeometry(element);\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar d = require('../lib/dom')\n  , defaultSettings = require('./default-setting')\n  , EventManager = require('../lib/event-manager')\n  , guid = require('../lib/guid')\n  , h = require('../lib/helper');\n\nvar instances = {};\n\nfunction Instance(element) {\n  var i = this;\n\n  i.settings = h.clone(defaultSettings);\n  i.containerWidth = null;\n  i.containerHeight = null;\n  i.contentWidth = null;\n  i.contentHeight = null;\n\n  i.isRtl = d.css(element, 'direction') === \"rtl\";\n  i.isNegativeScroll = (function () {\n    var originalScrollLeft = element.scrollLeft;\n    var result = null;\n    element.scrollLeft = -1;\n    result = element.scrollLeft < 0;\n    element.scrollLeft = originalScrollLeft;\n    return result;\n  })();\n  i.negativeScrollAdjustment = i.isNegativeScroll ? element.scrollWidth - element.clientWidth : 0;\n  i.event = new EventManager();\n  i.ownerDocument = element.ownerDocument || document;\n\n  i.scrollbarXRail = d.appendTo(d.e('div', 'ps-scrollbar-x-rail'), element);\n  i.scrollbarX = d.appendTo(d.e('div', 'ps-scrollbar-x'), i.scrollbarXRail);\n  i.scrollbarX.setAttribute('tabindex', 0);\n  i.scrollbarXActive = null;\n  i.scrollbarXWidth = null;\n  i.scrollbarXLeft = null;\n  i.scrollbarXBottom = h.toInt(d.css(i.scrollbarXRail, 'bottom'));\n  i.isScrollbarXUsingBottom = i.scrollbarXBottom === i.scrollbarXBottom; // !isNaN\n  i.scrollbarXTop = i.isScrollbarXUsingBottom ? null : h.toInt(d.css(i.scrollbarXRail, 'top'));\n  i.railBorderXWidth = h.toInt(d.css(i.scrollbarXRail, 'borderLeftWidth')) + h.toInt(d.css(i.scrollbarXRail, 'borderRightWidth'));\n  // Set rail to display:block to calculate margins\n  d.css(i.scrollbarXRail, 'display', 'block');\n  i.railXMarginWidth = h.toInt(d.css(i.scrollbarXRail, 'marginLeft')) + h.toInt(d.css(i.scrollbarXRail, 'marginRight'));\n  d.css(i.scrollbarXRail, 'display', '');\n  i.railXWidth = null;\n  i.railXRatio = null;\n\n  i.scrollbarYRail = d.appendTo(d.e('div', 'ps-scrollbar-y-rail'), element);\n  i.scrollbarY = d.appendTo(d.e('div', 'ps-scrollbar-y'), i.scrollbarYRail);\n  i.scrollbarY.setAttribute('tabindex', 0);\n  i.scrollbarYActive = null;\n  i.scrollbarYHeight = null;\n  i.scrollbarYTop = null;\n  i.scrollbarYRight = h.toInt(d.css(i.scrollbarYRail, 'right'));\n  i.isScrollbarYUsingRight = i.scrollbarYRight === i.scrollbarYRight; // !isNaN\n  i.scrollbarYLeft = i.isScrollbarYUsingRight ? null : h.toInt(d.css(i.scrollbarYRail, 'left'));\n  i.scrollbarYOuterWidth = i.isRtl ? h.outerWidth(i.scrollbarY) : null;\n  i.railBorderYWidth = h.toInt(d.css(i.scrollbarYRail, 'borderTopWidth')) + h.toInt(d.css(i.scrollbarYRail, 'borderBottomWidth'));\n  d.css(i.scrollbarYRail, 'display', 'block');\n  i.railYMarginHeight = h.toInt(d.css(i.scrollbarYRail, 'marginTop')) + h.toInt(d.css(i.scrollbarYRail, 'marginBottom'));\n  d.css(i.scrollbarYRail, 'display', '');\n  i.railYHeight = null;\n  i.railYRatio = null;\n}\n\nfunction getId(element) {\n  if (typeof element.dataset === 'undefined') {\n    return element.getAttribute('data-ps-id');\n  } else {\n    return element.dataset.psId;\n  }\n}\n\nfunction setId(element, id) {\n  if (typeof element.dataset === 'undefined') {\n    element.setAttribute('data-ps-id', id);\n  } else {\n    element.dataset.psId = id;\n  }\n}\n\nfunction removeId(element) {\n  if (typeof element.dataset === 'undefined') {\n    element.removeAttribute('data-ps-id');\n  } else {\n    delete element.dataset.psId;\n  }\n}\n\nexports.add = function (element) {\n  var newId = guid();\n  setId(element, newId);\n  instances[newId] = new Instance(element);\n  return instances[newId];\n};\n\nexports.remove = function (element) {\n  delete instances[getId(element)];\n  removeId(element);\n};\n\nexports.get = function (element) {\n  return instances[getId(element)];\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar cls = require('../lib/class')\n  , d = require('../lib/dom')\n  , h = require('../lib/helper')\n  , instances = require('./instances')\n  , updateScroll = require('./update-scroll');\n\nfunction getThumbSize(i, thumbSize) {\n  if (i.settings.minScrollbarLength) {\n    thumbSize = Math.max(thumbSize, i.settings.minScrollbarLength);\n  }\n  if (i.settings.maxScrollbarLength) {\n    thumbSize = Math.min(thumbSize, i.settings.maxScrollbarLength);\n  }\n  return thumbSize;\n}\n\nfunction updateCss(element, i) {\n  var xRailOffset = {width: i.railXWidth};\n  if (i.isRtl) {\n    xRailOffset.left = i.negativeScrollAdjustment + element.scrollLeft + i.containerWidth - i.contentWidth;\n  } else {\n    xRailOffset.left = element.scrollLeft;\n  }\n  if (i.isScrollbarXUsingBottom) {\n    xRailOffset.bottom = i.scrollbarXBottom - element.scrollTop;\n  } else {\n    xRailOffset.top = i.scrollbarXTop + element.scrollTop;\n  }\n  d.css(i.scrollbarXRail, xRailOffset);\n\n  var yRailOffset = {top: element.scrollTop, height: i.railYHeight};\n  if (i.isScrollbarYUsingRight) {\n    if (i.isRtl) {\n      yRailOffset.right = i.contentWidth - (i.negativeScrollAdjustment + element.scrollLeft) - i.scrollbarYRight - i.scrollbarYOuterWidth;\n    } else {\n      yRailOffset.right = i.scrollbarYRight - element.scrollLeft;\n    }\n  } else {\n    if (i.isRtl) {\n      yRailOffset.left = i.negativeScrollAdjustment + element.scrollLeft + i.containerWidth * 2 - i.contentWidth - i.scrollbarYLeft - i.scrollbarYOuterWidth;\n    } else {\n      yRailOffset.left = i.scrollbarYLeft + element.scrollLeft;\n    }\n  }\n  d.css(i.scrollbarYRail, yRailOffset);\n\n  d.css(i.scrollbarX, {left: i.scrollbarXLeft, width: i.scrollbarXWidth - i.railBorderXWidth});\n  d.css(i.scrollbarY, {top: i.scrollbarYTop, height: i.scrollbarYHeight - i.railBorderYWidth});\n}\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n\n  i.containerWidth = element.clientWidth;\n  i.containerHeight = element.clientHeight;\n  i.contentWidth = element.scrollWidth;\n  i.contentHeight = element.scrollHeight;\n\n  var existingRails;\n  if (!element.contains(i.scrollbarXRail)) {\n    existingRails = d.queryChildren(element, '.ps-scrollbar-x-rail');\n    if (existingRails.length > 0) {\n      existingRails.forEach(function (rail) {\n        d.remove(rail);\n      });\n    }\n    d.appendTo(i.scrollbarXRail, element);\n  }\n  if (!element.contains(i.scrollbarYRail)) {\n    existingRails = d.queryChildren(element, '.ps-scrollbar-y-rail');\n    if (existingRails.length > 0) {\n      existingRails.forEach(function (rail) {\n        d.remove(rail);\n      });\n    }\n    d.appendTo(i.scrollbarYRail, element);\n  }\n\n  if (!i.settings.suppressScrollX && i.containerWidth + i.settings.scrollXMarginOffset < i.contentWidth) {\n    i.scrollbarXActive = true;\n    i.railXWidth = i.containerWidth - i.railXMarginWidth;\n    i.railXRatio = i.containerWidth / i.railXWidth;\n    i.scrollbarXWidth = getThumbSize(i, h.toInt(i.railXWidth * i.containerWidth / i.contentWidth));\n    i.scrollbarXLeft = h.toInt((i.negativeScrollAdjustment + element.scrollLeft) * (i.railXWidth - i.scrollbarXWidth) / (i.contentWidth - i.containerWidth));\n  } else {\n    i.scrollbarXActive = false;\n  }\n\n  if (!i.settings.suppressScrollY && i.containerHeight + i.settings.scrollYMarginOffset < i.contentHeight) {\n    i.scrollbarYActive = true;\n    i.railYHeight = i.containerHeight - i.railYMarginHeight;\n    i.railYRatio = i.containerHeight / i.railYHeight;\n    i.scrollbarYHeight = getThumbSize(i, h.toInt(i.railYHeight * i.containerHeight / i.contentHeight));\n    i.scrollbarYTop = h.toInt(element.scrollTop * (i.railYHeight - i.scrollbarYHeight) / (i.contentHeight - i.containerHeight));\n  } else {\n    i.scrollbarYActive = false;\n  }\n\n  if (i.scrollbarXLeft >= i.railXWidth - i.scrollbarXWidth) {\n    i.scrollbarXLeft = i.railXWidth - i.scrollbarXWidth;\n  }\n  if (i.scrollbarYTop >= i.railYHeight - i.scrollbarYHeight) {\n    i.scrollbarYTop = i.railYHeight - i.scrollbarYHeight;\n  }\n\n  updateCss(element, i);\n\n  if (i.scrollbarXActive) {\n    cls.add(element, 'ps-active-x');\n  } else {\n    cls.remove(element, 'ps-active-x');\n    i.scrollbarXWidth = 0;\n    i.scrollbarXLeft = 0;\n    updateScroll(element, 'left', 0);\n  }\n  if (i.scrollbarYActive) {\n    cls.add(element, 'ps-active-y');\n  } else {\n    cls.remove(element, 'ps-active-y');\n    i.scrollbarYHeight = 0;\n    i.scrollbarYTop = 0;\n    updateScroll(element, 'top', 0);\n  }\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar instances = require('./instances');\n\nvar upEvent = document.createEvent('Event')\n  , downEvent = document.createEvent('Event')\n  , leftEvent = document.createEvent('Event')\n  , rightEvent = document.createEvent('Event')\n  , yEvent = document.createEvent('Event')\n  , xEvent = document.createEvent('Event')\n  , xStartEvent = document.createEvent('Event')\n  , xEndEvent = document.createEvent('Event')\n  , yStartEvent = document.createEvent('Event')\n  , yEndEvent = document.createEvent('Event')\n  , lastTop\n  , lastLeft;\n\nupEvent.initEvent('ps-scroll-up', true, true);\ndownEvent.initEvent('ps-scroll-down', true, true);\nleftEvent.initEvent('ps-scroll-left', true, true);\nrightEvent.initEvent('ps-scroll-right', true, true);\nyEvent.initEvent('ps-scroll-y', true, true);\nxEvent.initEvent('ps-scroll-x', true, true);\nxStartEvent.initEvent('ps-x-reach-start', true, true);\nxEndEvent.initEvent('ps-x-reach-end', true, true);\nyStartEvent.initEvent('ps-y-reach-start', true, true);\nyEndEvent.initEvent('ps-y-reach-end', true, true);\n\nmodule.exports = function (element, axis, value) {\n  if (typeof element === 'undefined') {\n    throw 'You must provide an element to the update-scroll function';\n  }\n\n  if (typeof axis === 'undefined') {\n    throw 'You must provide an axis to the update-scroll function';\n  }\n\n  if (typeof value === 'undefined') {\n    throw 'You must provide a value to the update-scroll function';\n  }\n\n  if (axis === 'top' && value <= 0) {\n    element.scrollTop = 0;\n    element.dispatchEvent(yStartEvent);\n    return; // don't allow negative scroll\n  }\n\n  if (axis === 'left' && value <= 0) {\n    element.scrollLeft = 0;\n    element.dispatchEvent(xStartEvent);\n    return; // don't allow negative scroll\n  }\n\n  var i = instances.get(element);\n\n  if (axis === 'top' && value >= i.contentHeight - i.containerHeight) {\n    element.scrollTop = i.contentHeight - i.containerHeight;\n    element.dispatchEvent(yEndEvent);\n    return; // don't allow scroll past container\n  }\n\n  if (axis === 'left' && value >= i.contentWidth - i.containerWidth) {\n    element.scrollLeft = i.contentWidth - i.containerWidth;\n    element.dispatchEvent(xEndEvent);\n    return; // don't allow scroll past container\n  }\n\n  if (!lastTop) {\n    lastTop = element.scrollTop;\n  }\n\n  if (!lastLeft) {\n    lastLeft = element.scrollLeft;\n  }\n\n  if (axis === 'top' && value < lastTop) {\n    element.dispatchEvent(upEvent);\n  }\n\n  if (axis === 'top' && value > lastTop) {\n    element.dispatchEvent(downEvent);\n  }\n\n  if (axis === 'left' && value < lastLeft) {\n    element.dispatchEvent(leftEvent);\n  }\n\n  if (axis === 'left' && value > lastLeft) {\n    element.dispatchEvent(rightEvent);\n  }\n\n  if (axis === 'top') {\n    element.scrollTop = lastTop = value;\n    element.dispatchEvent(yEvent);\n  }\n\n  if (axis === 'left') {\n    element.scrollLeft = lastLeft = value;\n    element.dispatchEvent(xEvent);\n  }\n\n};\n", "/* Copyright (c) 2015 Hyunje Alex Jun and other contributors\n * Licensed under the MIT License\n */\n'use strict';\n\nvar d = require('../lib/dom')\n  , h = require('../lib/helper')\n  , instances = require('./instances')\n  , updateGeometry = require('./update-geometry')\n  , updateScroll = require('./update-scroll');\n\nmodule.exports = function (element) {\n  var i = instances.get(element);\n\n  if (!i) {\n    return;\n  }\n\n  // Recalcuate negative scrollLeft adjustment\n  i.negativeScrollAdjustment = i.isNegativeScroll ? element.scrollWidth - element.clientWidth : 0;\n\n  // Recalculate rail margins\n  d.css(i.scrollbarXRail, 'display', 'block');\n  d.css(i.scrollbarYRail, 'display', 'block');\n  i.railXMarginWidth = h.toInt(d.css(i.scrollbarXRail, 'marginLeft')) + h.toInt(d.css(i.scrollbarXRail, 'marginRight'));\n  i.railYMarginHeight = h.toInt(d.css(i.scrollbarYRail, 'marginTop')) + h.toInt(d.css(i.scrollbarYRail, 'marginBottom'));\n\n  // Hide scrollbars not to affect scrollWidth and scrollHeight\n  d.css(i.scrollbarXRail, 'display', 'none');\n  d.css(i.scrollbarYRail, 'display', 'none');\n\n  updateGeometry(element);\n\n  // Update top/left scroll to trigger events\n  updateScroll(element, 'top', element.scrollTop);\n  updateScroll(element, 'left', element.scrollLeft);\n\n  d.css(i.scrollbarXRail, 'display', '');\n  d.css(i.scrollbarYRail, 'display', '');\n};\n"]
}